{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Terraform","url":"/terraform"},{"title":"Configuration Language","url":"/terraform/language","isCurrentPage":false},{"title":"Modules","url":"/terraform/language/modules"},{"title":"Module Development","url":"/terraform/language/modules/develop"},{"title":"Refactoring Modules","url":"/terraform/language/modules/develop/refactoring","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Terraform Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Terraform","fullPath":"/terraform","theme":"terraform"},{"title":"Install","fullPath":"/terraform/install"},{"title":"Tutorials","fullPath":"/terraform/tutorials"},{"title":"Documentation","isOpen":true,"routes":[{"title":"About the Docs","fullPath":"/terraform/docs"},{"title":"Configuration Language","fullPath":"/terraform/language"},{"title":"Terraform CLI","fullPath":"/terraform/cli"},{"title":"Terraform Cloud","fullPath":"/terraform/cloud-docs"},{"title":"Terraform Enterprise","fullPath":"/terraform/enterprise"},{"title":"CDK for Terraform","fullPath":"/terraform/cdktf"},{"title":"Provider Use","fullPath":"/terraform/language/providers"},{"title":"Plugin Development","fullPath":"/terraform/plugin"},{"title":"Registry Publishing","fullPath":"/terraform/registry"},{"title":"Integration Program","fullPath":"/terraform/docs/partnerships"}]}],"showFilterInput":false,"title":"Terraform","visuallyHideTitle":true},{"backToLinkProps":{"text":"Terraform Home","href":"/terraform"},"levelButtonProps":{"levelUpButtonText":"Terraform Home"},"menuItems":[{"title":"Configuration Language","fullPath":"/terraform/language","theme":"terraform"},{"title":"Files and Directories","routes":[{"title":"Overview","path":"files","filePath":"../docs/language/files/index.mdx","fullPath":"/terraform/language/files","id":"sidebar-nav-item-3"},{"title":"Override Files","path":"files/override","filePath":"../docs/language/files/override.mdx","fullPath":"/terraform/language/files/override","id":"sidebar-nav-item-4"},{"title":"Dependency Lock File","path":"files/dependency-lock","filePath":"../docs/language/files/dependency-lock.mdx","fullPath":"/terraform/language/files/dependency-lock","id":"sidebar-nav-item-5"},{"title":"Test Files","path":"files/tests","filePath":"../docs/language/files/tests.mdx","fullPath":"/terraform/language/files/tests","id":"sidebar-nav-item-6"}],"id":"sidebar-nav-item-2"},{"title":"Syntax","routes":[{"title":"Overview","path":"syntax","filePath":"../docs/language/syntax/index.mdx","fullPath":"/terraform/language/syntax","id":"sidebar-nav-item-8"},{"title":"Configuration Syntax","path":"syntax/configuration","filePath":"../docs/language/syntax/configuration.mdx","fullPath":"/terraform/language/syntax/configuration","id":"sidebar-nav-item-9"},{"title":"JSON Configuration Syntax","path":"syntax/json","filePath":"../docs/language/syntax/json.mdx","fullPath":"/terraform/language/syntax/json","id":"sidebar-nav-item-10"},{"title":"Style Conventions","path":"syntax/style","filePath":"../docs/language/syntax/style.mdx","fullPath":"/terraform/language/syntax/style","id":"sidebar-nav-item-11"}],"id":"sidebar-nav-item-7"},{"title":"Resources","routes":[{"title":"Overview","path":"resources","filePath":"../docs/language/resources/index.mdx","fullPath":"/terraform/language/resources","id":"sidebar-nav-item-13"},{"title":"Resource Blocks","path":"resources/syntax","filePath":"../docs/language/resources/syntax.mdx","fullPath":"/terraform/language/resources/syntax","id":"sidebar-nav-item-14"},{"title":"Resource Behavior","path":"resources/behavior","filePath":"../docs/language/resources/behavior.mdx","fullPath":"/terraform/language/resources/behavior","id":"sidebar-nav-item-15"},{"title":"Meta-Arguments","routes":[{"title":"<code>depends_on</code>","href":null,"fullPath":"/terraform/language/meta-arguments/depends_on","id":"sidebar-nav-item-17","path":"/language/meta-arguments/depends_on"},{"title":"<code>count</code>","href":null,"fullPath":"/terraform/language/meta-arguments/count","id":"sidebar-nav-item-18","path":"/language/meta-arguments/count"},{"title":"<code>for_each</code>","href":null,"fullPath":"/terraform/language/meta-arguments/for_each","id":"sidebar-nav-item-19","path":"/language/meta-arguments/for_each"},{"title":"<code>provider</code>","href":null,"fullPath":"/terraform/language/meta-arguments/resource-provider","id":"sidebar-nav-item-20","path":"/language/meta-arguments/resource-provider"},{"title":"<code>lifecycle</code>","href":null,"fullPath":"/terraform/language/meta-arguments/lifecycle","id":"sidebar-nav-item-21","path":"/language/meta-arguments/lifecycle"}],"id":"sidebar-nav-item-16"},{"title":"Provisioners","routes":[{"title":"Declaring Provisioners","path":"resources/provisioners/syntax","filePath":"../docs/language/resources/provisioners/syntax.mdx","fullPath":"/terraform/language/resources/provisioners/syntax","id":"sidebar-nav-item-23"},{"title":"Provisioner Connections","path":"resources/provisioners/connection","filePath":"../docs/language/resources/provisioners/connection.mdx","fullPath":"/terraform/language/resources/provisioners/connection","id":"sidebar-nav-item-24"},{"title":"Provisioners Without a Resource","path":"resources/provisioners/null_resource","filePath":"../docs/language/resources/provisioners/null_resource.mdx","fullPath":"/terraform/language/resources/provisioners/null_resource","id":"sidebar-nav-item-25"},{"title":"file","path":"resources/provisioners/file","filePath":"../docs/language/resources/provisioners/file.mdx","fullPath":"/terraform/language/resources/provisioners/file","id":"sidebar-nav-item-26"},{"title":"local-exec","path":"resources/provisioners/local-exec","filePath":"../docs/language/resources/provisioners/local-exec.mdx","fullPath":"/terraform/language/resources/provisioners/local-exec","id":"sidebar-nav-item-27"},{"title":"remote-exec","path":"resources/provisioners/remote-exec","filePath":"../docs/language/resources/provisioners/remote-exec.mdx","fullPath":"/terraform/language/resources/provisioners/remote-exec","id":"sidebar-nav-item-28"}],"id":"sidebar-nav-item-22"},{"title":"The <code>terraform_data</code> Resource Type","path":"resources/terraform-data","filePath":"../docs/language/resources/terraform-data.mdx","fullPath":"/terraform/language/resources/terraform-data","id":"sidebar-nav-item-29"}],"id":"sidebar-nav-item-12"},{"title":"Data Sources","path":"data-sources","filePath":"../docs/language/data-sources/index.mdx","fullPath":"/terraform/language/data-sources","id":"sidebar-nav-item-30"},{"title":"Providers","routes":[{"title":"Overview","path":"providers","filePath":"../docs/language/providers/index.mdx","fullPath":"/terraform/language/providers","id":"sidebar-nav-item-32"},{"title":"Provider Configuration","path":"providers/configuration","filePath":"../docs/language/providers/configuration.mdx","fullPath":"/terraform/language/providers/configuration","id":"sidebar-nav-item-33"},{"title":"Provider Requirements","path":"providers/requirements","filePath":"../docs/language/providers/requirements.mdx","fullPath":"/terraform/language/providers/requirements","id":"sidebar-nav-item-34"},{"title":"Dependency Lock File","href":null,"fullPath":"/terraform/language/files/dependency-lock","id":"sidebar-nav-item-35","path":"/language/files/dependency-lock"}],"id":"sidebar-nav-item-31"},{"title":"Variables and Outputs","routes":[{"title":"Overview","path":"values","filePath":"../docs/language/values/index.mdx","fullPath":"/terraform/language/values","id":"sidebar-nav-item-37"},{"title":"Input Variables","path":"values/variables","filePath":"../docs/language/values/variables.mdx","fullPath":"/terraform/language/values/variables","id":"sidebar-nav-item-38"},{"title":"Output Values","path":"values/outputs","filePath":"../docs/language/values/outputs.mdx","fullPath":"/terraform/language/values/outputs","id":"sidebar-nav-item-39"},{"title":"Local Values","path":"values/locals","filePath":"../docs/language/values/locals.mdx","fullPath":"/terraform/language/values/locals","id":"sidebar-nav-item-40"}],"id":"sidebar-nav-item-36"},{"title":"Modules","routes":[{"title":"Overview","path":"modules","filePath":"../docs/language/modules/index.mdx","fullPath":"/terraform/language/modules","id":"sidebar-nav-item-42"},{"title":"Module Blocks","path":"modules/syntax","filePath":"../docs/language/modules/syntax.mdx","fullPath":"/terraform/language/modules/syntax","id":"sidebar-nav-item-43"},{"title":"Module Sources","path":"modules/sources","filePath":"../docs/language/modules/sources.mdx","fullPath":"/terraform/language/modules/sources","id":"sidebar-nav-item-44"},{"title":"Meta-Arguments","routes":[{"title":"<code>providers</code>","href":null,"fullPath":"/terraform/language/meta-arguments/module-providers","id":"sidebar-nav-item-46","path":"/language/meta-arguments/module-providers"},{"title":"<code>depends_on</code>","href":null,"fullPath":"/terraform/language/meta-arguments/depends_on","id":"sidebar-nav-item-47","path":"/language/meta-arguments/depends_on"},{"title":"<code>count</code>","href":null,"fullPath":"/terraform/language/meta-arguments/count","id":"sidebar-nav-item-48","path":"/language/meta-arguments/count"},{"title":"<code>for_each</code>","href":null,"fullPath":"/terraform/language/meta-arguments/for_each","id":"sidebar-nav-item-49","path":"/language/meta-arguments/for_each"}],"id":"sidebar-nav-item-45"},{"title":"Module Development","routes":[{"title":"Overview","path":"modules/develop","filePath":"../docs/language/modules/develop/index.mdx","fullPath":"/terraform/language/modules/develop","id":"sidebar-nav-item-51"},{"title":"Standard Module Structure","path":"modules/develop/structure","filePath":"../docs/language/modules/develop/structure.mdx","fullPath":"/terraform/language/modules/develop/structure","id":"sidebar-nav-item-52"},{"title":"Providers Within Modules","path":"modules/develop/providers","filePath":"../docs/language/modules/develop/providers.mdx","fullPath":"/terraform/language/modules/develop/providers","id":"sidebar-nav-item-53"},{"title":"Best Practices: Module Composition","path":"modules/develop/composition","filePath":"../docs/language/modules/develop/composition.mdx","fullPath":"/terraform/language/modules/develop/composition","id":"sidebar-nav-item-54"},{"title":"Publishing Modules","path":"modules/develop/publish","filePath":"../docs/language/modules/develop/publish.mdx","fullPath":"/terraform/language/modules/develop/publish","id":"sidebar-nav-item-55"},{"title":"Refactoring Modules","path":"modules/develop/refactoring","filePath":"../docs/language/modules/develop/refactoring.mdx","fullPath":"/terraform/language/modules/develop/refactoring","id":"sidebar-nav-item-56"}],"id":"sidebar-nav-item-50"}],"id":"sidebar-nav-item-41"},{"title":"Checks","path":"checks","filePath":"../docs/language/checks/index.mdx","fullPath":"/terraform/language/checks","id":"sidebar-nav-item-57"},{"title":"Import","routes":[{"title":"Overview","path":"import","filePath":"../docs/language/import/index.mdx","fullPath":"/terraform/language/import","id":"sidebar-nav-item-59"},{"title":"Generating Configuration","path":"import/generating-configuration","filePath":"../docs/language/import/generating-configuration.mdx","fullPath":"/terraform/language/import/generating-configuration","id":"sidebar-nav-item-60"}],"id":"sidebar-nav-item-58"},{"title":"Expressions","routes":[{"title":"Overview","path":"expressions","filePath":"../docs/language/expressions/index.mdx","fullPath":"/terraform/language/expressions","id":"sidebar-nav-item-62"},{"title":"Types and Values","path":"expressions/types","filePath":"../docs/language/expressions/types.mdx","fullPath":"/terraform/language/expressions/types","id":"sidebar-nav-item-63"},{"title":"Strings and Templates","path":"expressions/strings","filePath":"../docs/language/expressions/strings.mdx","fullPath":"/terraform/language/expressions/strings","id":"sidebar-nav-item-64"},{"title":"References to Values","path":"expressions/references","filePath":"../docs/language/expressions/references.mdx","fullPath":"/terraform/language/expressions/references","id":"sidebar-nav-item-65"},{"title":"Operators","path":"expressions/operators","filePath":"../docs/language/expressions/operators.mdx","fullPath":"/terraform/language/expressions/operators","id":"sidebar-nav-item-66"},{"title":"Function Calls","path":"expressions/function-calls","filePath":"../docs/language/expressions/function-calls.mdx","fullPath":"/terraform/language/expressions/function-calls","id":"sidebar-nav-item-67"},{"title":"Conditional Expressions","path":"expressions/conditionals","filePath":"../docs/language/expressions/conditionals.mdx","fullPath":"/terraform/language/expressions/conditionals","id":"sidebar-nav-item-68"},{"title":"For Expressions","path":"expressions/for","filePath":"../docs/language/expressions/for.mdx","fullPath":"/terraform/language/expressions/for","id":"sidebar-nav-item-69"},{"title":"Splat Expressions","path":"expressions/splat","filePath":"../docs/language/expressions/splat.mdx","fullPath":"/terraform/language/expressions/splat","id":"sidebar-nav-item-70"},{"title":"Dynamic Blocks","path":"expressions/dynamic-blocks","filePath":"../docs/language/expressions/dynamic-blocks.mdx","fullPath":"/terraform/language/expressions/dynamic-blocks","id":"sidebar-nav-item-71"},{"title":"Custom Conditions","path":"expressions/custom-conditions","filePath":"../docs/language/expressions/custom-conditions.mdx","fullPath":"/terraform/language/expressions/custom-conditions","id":"sidebar-nav-item-72"},{"title":"Type Constraints","path":"expressions/type-constraints","filePath":"../docs/language/expressions/type-constraints.mdx","fullPath":"/terraform/language/expressions/type-constraints","id":"sidebar-nav-item-73"},{"title":"Version Constraints","path":"expressions/version-constraints","filePath":"../docs/language/expressions/version-constraints.mdx","fullPath":"/terraform/language/expressions/version-constraints","id":"sidebar-nav-item-74"}],"id":"sidebar-nav-item-61"},{"title":"Functions","routes":[{"title":"Overview","path":"functions","filePath":"../docs/language/functions/index.mdx","fullPath":"/terraform/language/functions","id":"sidebar-nav-item-76"},{"title":"Numeric Functions","routes":[{"title":"<code>abs</code>","href":null,"fullPath":"/terraform/language/functions/abs","id":"sidebar-nav-item-78","path":"/language/functions/abs"},{"title":"<code>ceil</code>","href":null,"fullPath":"/terraform/language/functions/ceil","id":"sidebar-nav-item-79","path":"/language/functions/ceil"},{"title":"<code>floor</code>","href":null,"fullPath":"/terraform/language/functions/floor","id":"sidebar-nav-item-80","path":"/language/functions/floor"},{"title":"<code>log</code>","href":null,"fullPath":"/terraform/language/functions/log","id":"sidebar-nav-item-81","path":"/language/functions/log"},{"title":"<code>max</code>","href":null,"fullPath":"/terraform/language/functions/max","id":"sidebar-nav-item-82","path":"/language/functions/max"},{"title":"<code>min</code>","href":null,"fullPath":"/terraform/language/functions/min","id":"sidebar-nav-item-83","path":"/language/functions/min"},{"title":"<code>parseint</code>","href":null,"fullPath":"/terraform/language/functions/parseint","id":"sidebar-nav-item-84","path":"/language/functions/parseint"},{"title":"<code>pow</code>","href":null,"fullPath":"/terraform/language/functions/pow","id":"sidebar-nav-item-85","path":"/language/functions/pow"},{"title":"<code>signum</code>","href":null,"fullPath":"/terraform/language/functions/signum","id":"sidebar-nav-item-86","path":"/language/functions/signum"}],"id":"sidebar-nav-item-77"},{"title":"String Functions","routes":[{"title":"<code>chomp</code>","href":null,"fullPath":"/terraform/language/functions/chomp","id":"sidebar-nav-item-88","path":"/language/functions/chomp"},{"title":"<code>endswith</code>","href":null,"fullPath":"/terraform/language/functions/endswith","id":"sidebar-nav-item-89","path":"/language/functions/endswith"},{"title":"<code>format</code>","href":null,"fullPath":"/terraform/language/functions/format","id":"sidebar-nav-item-90","path":"/language/functions/format"},{"title":"<code>formatlist</code>","href":null,"fullPath":"/terraform/language/functions/formatlist","id":"sidebar-nav-item-91","path":"/language/functions/formatlist"},{"title":"<code>indent</code>","href":null,"fullPath":"/terraform/language/functions/indent","id":"sidebar-nav-item-92","path":"/language/functions/indent"},{"title":"<code>join</code>","href":null,"fullPath":"/terraform/language/functions/join","id":"sidebar-nav-item-93","path":"/language/functions/join"},{"title":"<code>lower</code>","href":null,"fullPath":"/terraform/language/functions/lower","id":"sidebar-nav-item-94","path":"/language/functions/lower"},{"title":"<code>regex</code>","href":null,"fullPath":"/terraform/language/functions/regex","id":"sidebar-nav-item-95","path":"/language/functions/regex"},{"title":"<code>regexall</code>","href":null,"fullPath":"/terraform/language/functions/regexall","id":"sidebar-nav-item-96","path":"/language/functions/regexall"},{"title":"<code>replace</code>","href":null,"fullPath":"/terraform/language/functions/replace","id":"sidebar-nav-item-97","path":"/language/functions/replace"},{"title":"<code>split</code>","href":null,"fullPath":"/terraform/language/functions/split","id":"sidebar-nav-item-98","path":"/language/functions/split"},{"title":"<code>startswith</code>","href":null,"fullPath":"/terraform/language/functions/startswith","id":"sidebar-nav-item-99","path":"/language/functions/startswith"},{"title":"<code>strcontains</code>","href":null,"fullPath":"/terraform/language/functions/strcontains","id":"sidebar-nav-item-100","path":"/language/functions/strcontains"},{"title":"<code>strrev</code>","href":null,"fullPath":"/terraform/language/functions/strrev","id":"sidebar-nav-item-101","path":"/language/functions/strrev"},{"title":"<code>substr</code>","href":null,"fullPath":"/terraform/language/functions/substr","id":"sidebar-nav-item-102","path":"/language/functions/substr"},{"title":"<code>title</code>","href":null,"fullPath":"/terraform/language/functions/title","id":"sidebar-nav-item-103","path":"/language/functions/title"},{"title":"<code>trim</code>","href":null,"fullPath":"/terraform/language/functions/trim","id":"sidebar-nav-item-104","path":"/language/functions/trim"},{"title":"<code>trimprefix</code>","href":null,"fullPath":"/terraform/language/functions/trimprefix","id":"sidebar-nav-item-105","path":"/language/functions/trimprefix"},{"title":"<code>trimsuffix</code>","href":null,"fullPath":"/terraform/language/functions/trimsuffix","id":"sidebar-nav-item-106","path":"/language/functions/trimsuffix"},{"title":"<code>trimspace</code>","href":null,"fullPath":"/terraform/language/functions/trimspace","id":"sidebar-nav-item-107","path":"/language/functions/trimspace"},{"title":"<code>upper</code>","href":null,"fullPath":"/terraform/language/functions/upper","id":"sidebar-nav-item-108","path":"/language/functions/upper"}],"id":"sidebar-nav-item-87"},{"title":"Collection Functions","routes":[{"title":"<code>alltrue</code>","href":null,"fullPath":"/terraform/language/functions/alltrue","id":"sidebar-nav-item-110","path":"/language/functions/alltrue"},{"title":"<code>anytrue</code>","href":null,"fullPath":"/terraform/language/functions/anytrue","id":"sidebar-nav-item-111","path":"/language/functions/anytrue"},{"title":"<code>chunklist</code>","href":null,"fullPath":"/terraform/language/functions/chunklist","id":"sidebar-nav-item-112","path":"/language/functions/chunklist"},{"title":"<code>coalesce</code>","href":null,"fullPath":"/terraform/language/functions/coalesce","id":"sidebar-nav-item-113","path":"/language/functions/coalesce"},{"title":"<code>coalescelist</code>","href":null,"fullPath":"/terraform/language/functions/coalescelist","id":"sidebar-nav-item-114","path":"/language/functions/coalescelist"},{"title":"<code>compact</code>","href":null,"fullPath":"/terraform/language/functions/compact","id":"sidebar-nav-item-115","path":"/language/functions/compact"},{"title":"<code>concat</code>","href":null,"fullPath":"/terraform/language/functions/concat","id":"sidebar-nav-item-116","path":"/language/functions/concat"},{"title":"<code>contains</code>","href":null,"fullPath":"/terraform/language/functions/contains","id":"sidebar-nav-item-117","path":"/language/functions/contains"},{"title":"<code>distinct</code>","href":null,"fullPath":"/terraform/language/functions/distinct","id":"sidebar-nav-item-118","path":"/language/functions/distinct"},{"title":"<code>element</code>","href":null,"fullPath":"/terraform/language/functions/element","id":"sidebar-nav-item-119","path":"/language/functions/element"},{"title":"<code>flatten</code>","href":null,"fullPath":"/terraform/language/functions/flatten","id":"sidebar-nav-item-120","path":"/language/functions/flatten"},{"title":"<code>index</code>","href":null,"fullPath":"/terraform/language/functions/index_function","id":"sidebar-nav-item-121","path":"/language/functions/index_function"},{"title":"<code>keys</code>","href":null,"fullPath":"/terraform/language/functions/keys","id":"sidebar-nav-item-122","path":"/language/functions/keys"},{"title":"<code>length</code>","href":null,"fullPath":"/terraform/language/functions/length","id":"sidebar-nav-item-123","path":"/language/functions/length"},{"title":"<code>list</code>","href":null,"fullPath":"/terraform/language/functions/list","id":"sidebar-nav-item-124","path":"/language/functions/list"},{"title":"<code>lookup</code>","href":null,"fullPath":"/terraform/language/functions/lookup","id":"sidebar-nav-item-125","path":"/language/functions/lookup"},{"title":"<code>map</code>","href":null,"fullPath":"/terraform/language/functions/map","id":"sidebar-nav-item-126","path":"/language/functions/map"},{"title":"<code>matchkeys</code>","href":null,"fullPath":"/terraform/language/functions/matchkeys","id":"sidebar-nav-item-127","path":"/language/functions/matchkeys"},{"title":"<code>merge</code>","href":null,"fullPath":"/terraform/language/functions/merge","id":"sidebar-nav-item-128","path":"/language/functions/merge"},{"title":"<code>one</code>","href":null,"fullPath":"/terraform/language/functions/one","id":"sidebar-nav-item-129","path":"/language/functions/one"},{"title":"<code>range</code>","href":null,"fullPath":"/terraform/language/functions/range","id":"sidebar-nav-item-130","path":"/language/functions/range"},{"title":"<code>reverse</code>","href":null,"fullPath":"/terraform/language/functions/reverse","id":"sidebar-nav-item-131","path":"/language/functions/reverse"},{"title":"<code>setintersection</code>","href":null,"fullPath":"/terraform/language/functions/setintersection","id":"sidebar-nav-item-132","path":"/language/functions/setintersection"},{"title":"<code>setproduct</code>","href":null,"fullPath":"/terraform/language/functions/setproduct","id":"sidebar-nav-item-133","path":"/language/functions/setproduct"},{"title":"<code>setsubtract</code>","href":null,"fullPath":"/terraform/language/functions/setsubtract","id":"sidebar-nav-item-134","path":"/language/functions/setsubtract"},{"title":"<code>setunion</code>","href":null,"fullPath":"/terraform/language/functions/setunion","id":"sidebar-nav-item-135","path":"/language/functions/setunion"},{"title":"<code>slice</code>","href":null,"fullPath":"/terraform/language/functions/slice","id":"sidebar-nav-item-136","path":"/language/functions/slice"},{"title":"<code>sort</code>","href":null,"fullPath":"/terraform/language/functions/sort","id":"sidebar-nav-item-137","path":"/language/functions/sort"},{"title":"<code>sum</code>","href":null,"fullPath":"/terraform/language/functions/sum","id":"sidebar-nav-item-138","path":"/language/functions/sum"},{"title":"<code>transpose</code>","href":null,"fullPath":"/terraform/language/functions/transpose","id":"sidebar-nav-item-139","path":"/language/functions/transpose"},{"title":"<code>values</code>","href":null,"fullPath":"/terraform/language/functions/values","id":"sidebar-nav-item-140","path":"/language/functions/values"},{"title":"<code>zipmap</code>","href":null,"fullPath":"/terraform/language/functions/zipmap","id":"sidebar-nav-item-141","path":"/language/functions/zipmap"}],"id":"sidebar-nav-item-109"},{"title":"Encoding Functions","routes":[{"title":"<code>base64decode</code>","href":null,"fullPath":"/terraform/language/functions/base64decode","id":"sidebar-nav-item-143","path":"/language/functions/base64decode"},{"title":"<code>base64encode</code>","href":null,"fullPath":"/terraform/language/functions/base64encode","id":"sidebar-nav-item-144","path":"/language/functions/base64encode"},{"title":"<code>base64gzip</code>","href":null,"fullPath":"/terraform/language/functions/base64gzip","id":"sidebar-nav-item-145","path":"/language/functions/base64gzip"},{"title":"<code>csvdecode</code>","href":null,"fullPath":"/terraform/language/functions/csvdecode","id":"sidebar-nav-item-146","path":"/language/functions/csvdecode"},{"title":"<code>jsondecode</code>","href":null,"fullPath":"/terraform/language/functions/jsondecode","id":"sidebar-nav-item-147","path":"/language/functions/jsondecode"},{"title":"<code>jsonencode</code>","href":null,"fullPath":"/terraform/language/functions/jsonencode","id":"sidebar-nav-item-148","path":"/language/functions/jsonencode"},{"title":"<code>textdecodebase64</code>","href":null,"fullPath":"/terraform/language/functions/textdecodebase64","id":"sidebar-nav-item-149","path":"/language/functions/textdecodebase64"},{"title":"<code>textencodebase64</code>","href":null,"fullPath":"/terraform/language/functions/textencodebase64","id":"sidebar-nav-item-150","path":"/language/functions/textencodebase64"},{"title":"<code>urlencode</code>","href":null,"fullPath":"/terraform/language/functions/urlencode","id":"sidebar-nav-item-151","path":"/language/functions/urlencode"},{"title":"<code>yamldecode</code>","href":null,"fullPath":"/terraform/language/functions/yamldecode","id":"sidebar-nav-item-152","path":"/language/functions/yamldecode"},{"title":"<code>yamlencode</code>","href":null,"fullPath":"/terraform/language/functions/yamlencode","id":"sidebar-nav-item-153","path":"/language/functions/yamlencode"}],"id":"sidebar-nav-item-142"},{"title":"Filesystem Functions","routes":[{"title":"<code>abspath</code>","href":null,"fullPath":"/terraform/language/functions/abspath","id":"sidebar-nav-item-155","path":"/language/functions/abspath"},{"title":"<code>dirname</code>","href":null,"fullPath":"/terraform/language/functions/dirname","id":"sidebar-nav-item-156","path":"/language/functions/dirname"},{"title":"<code>pathexpand</code>","href":null,"fullPath":"/terraform/language/functions/pathexpand","id":"sidebar-nav-item-157","path":"/language/functions/pathexpand"},{"title":"<code>basename</code>","href":null,"fullPath":"/terraform/language/functions/basename","id":"sidebar-nav-item-158","path":"/language/functions/basename"},{"title":"<code>file</code>","href":null,"fullPath":"/terraform/language/functions/file","id":"sidebar-nav-item-159","path":"/language/functions/file"},{"title":"<code>fileexists</code>","href":null,"fullPath":"/terraform/language/functions/fileexists","id":"sidebar-nav-item-160","path":"/language/functions/fileexists"},{"title":"<code>fileset</code>","href":null,"fullPath":"/terraform/language/functions/fileset","id":"sidebar-nav-item-161","path":"/language/functions/fileset"},{"title":"<code>filebase64</code>","href":null,"fullPath":"/terraform/language/functions/filebase64","id":"sidebar-nav-item-162","path":"/language/functions/filebase64"},{"title":"<code>templatefile</code>","href":null,"fullPath":"/terraform/language/functions/templatefile","id":"sidebar-nav-item-163","path":"/language/functions/templatefile"}],"id":"sidebar-nav-item-154"},{"title":"Date and Time Functions","routes":[{"title":"<code>formatdate</code>","href":null,"fullPath":"/terraform/language/functions/formatdate","id":"sidebar-nav-item-165","path":"/language/functions/formatdate"},{"title":"<code>plantimestamp</code>","href":null,"fullPath":"/terraform/language/functions/plantimestamp","id":"sidebar-nav-item-166","path":"/language/functions/plantimestamp"},{"title":"<code>timeadd</code>","href":null,"fullPath":"/terraform/language/functions/timeadd","id":"sidebar-nav-item-167","path":"/language/functions/timeadd"},{"title":"<code>timecmp</code>","href":null,"fullPath":"/terraform/language/functions/timecmp","id":"sidebar-nav-item-168","path":"/language/functions/timecmp"},{"title":"<code>timestamp</code>","href":null,"fullPath":"/terraform/language/functions/timestamp","id":"sidebar-nav-item-169","path":"/language/functions/timestamp"}],"id":"sidebar-nav-item-164"},{"title":"Hash and Crypto Functions","routes":[{"title":"<code>base64sha256</code>","href":null,"fullPath":"/terraform/language/functions/base64sha256","id":"sidebar-nav-item-171","path":"/language/functions/base64sha256"},{"title":"<code>base64sha512</code>","href":null,"fullPath":"/terraform/language/functions/base64sha512","id":"sidebar-nav-item-172","path":"/language/functions/base64sha512"},{"title":"<code>bcrypt</code>","href":null,"fullPath":"/terraform/language/functions/bcrypt","id":"sidebar-nav-item-173","path":"/language/functions/bcrypt"},{"title":"<code>filebase64sha256</code>","href":null,"fullPath":"/terraform/language/functions/filebase64sha256","id":"sidebar-nav-item-174","path":"/language/functions/filebase64sha256"},{"title":"<code>filebase64sha512</code>","href":null,"fullPath":"/terraform/language/functions/filebase64sha512","id":"sidebar-nav-item-175","path":"/language/functions/filebase64sha512"},{"title":"<code>filemd5</code>","href":null,"fullPath":"/terraform/language/functions/filemd5","id":"sidebar-nav-item-176","path":"/language/functions/filemd5"},{"title":"<code>filesha1</code>","href":null,"fullPath":"/terraform/language/functions/filesha1","id":"sidebar-nav-item-177","path":"/language/functions/filesha1"},{"title":"<code>filesha256</code>","href":null,"fullPath":"/terraform/language/functions/filesha256","id":"sidebar-nav-item-178","path":"/language/functions/filesha256"},{"title":"<code>filesha512</code>","href":null,"fullPath":"/terraform/language/functions/filesha512","id":"sidebar-nav-item-179","path":"/language/functions/filesha512"},{"title":"<code>md5</code>","href":null,"fullPath":"/terraform/language/functions/md5","id":"sidebar-nav-item-180","path":"/language/functions/md5"},{"title":"<code>rsadecrypt</code>","href":null,"fullPath":"/terraform/language/functions/rsadecrypt","id":"sidebar-nav-item-181","path":"/language/functions/rsadecrypt"},{"title":"<code>sha1</code>","href":null,"fullPath":"/terraform/language/functions/sha1","id":"sidebar-nav-item-182","path":"/language/functions/sha1"},{"title":"<code>sha256</code>","href":null,"fullPath":"/terraform/language/functions/sha256","id":"sidebar-nav-item-183","path":"/language/functions/sha256"},{"title":"<code>sha512</code>","href":null,"fullPath":"/terraform/language/functions/sha512","id":"sidebar-nav-item-184","path":"/language/functions/sha512"},{"title":"<code>uuid</code>","href":null,"fullPath":"/terraform/language/functions/uuid","id":"sidebar-nav-item-185","path":"/language/functions/uuid"},{"title":"<code>uuidv5</code>","href":null,"fullPath":"/terraform/language/functions/uuidv5","id":"sidebar-nav-item-186","path":"/language/functions/uuidv5"}],"id":"sidebar-nav-item-170"},{"title":"IP Network Functions","routes":[{"title":"<code>cidrhost</code>","href":null,"fullPath":"/terraform/language/functions/cidrhost","id":"sidebar-nav-item-188","path":"/language/functions/cidrhost"},{"title":"<code>cidrnetmask</code>","href":null,"fullPath":"/terraform/language/functions/cidrnetmask","id":"sidebar-nav-item-189","path":"/language/functions/cidrnetmask"},{"title":"<code>cidrsubnet</code>","href":null,"fullPath":"/terraform/language/functions/cidrsubnet","id":"sidebar-nav-item-190","path":"/language/functions/cidrsubnet"},{"title":"<code>cidrsubnets</code>","href":null,"fullPath":"/terraform/language/functions/cidrsubnets","id":"sidebar-nav-item-191","path":"/language/functions/cidrsubnets"}],"id":"sidebar-nav-item-187"},{"title":"Type Conversion Functions","routes":[{"title":"<code>can</code>","href":null,"fullPath":"/terraform/language/functions/can","id":"sidebar-nav-item-193","path":"/language/functions/can"},{"title":"<code>issensitive</code>","href":null,"fullPath":"/terraform/language/functions/issensitive","id":"sidebar-nav-item-194","path":"/language/functions/issensitive"},{"title":"<code>nonsensitive</code>","href":null,"fullPath":"/terraform/language/functions/nonsensitive","id":"sidebar-nav-item-195","path":"/language/functions/nonsensitive"},{"title":"<code>sensitive</code>","href":null,"fullPath":"/terraform/language/functions/sensitive","id":"sidebar-nav-item-196","path":"/language/functions/sensitive"},{"title":"<code>tobool</code>","href":null,"fullPath":"/terraform/language/functions/tobool","id":"sidebar-nav-item-197","path":"/language/functions/tobool"},{"title":"<code>tolist</code>","href":null,"fullPath":"/terraform/language/functions/tolist","id":"sidebar-nav-item-198","path":"/language/functions/tolist"},{"title":"<code>tomap</code>","href":null,"fullPath":"/terraform/language/functions/tomap","id":"sidebar-nav-item-199","path":"/language/functions/tomap"},{"title":"<code>tonumber</code>","href":null,"fullPath":"/terraform/language/functions/tonumber","id":"sidebar-nav-item-200","path":"/language/functions/tonumber"},{"title":"<code>toset</code>","href":null,"fullPath":"/terraform/language/functions/toset","id":"sidebar-nav-item-201","path":"/language/functions/toset"},{"title":"<code>tostring</code>","href":null,"fullPath":"/terraform/language/functions/tostring","id":"sidebar-nav-item-202","path":"/language/functions/tostring"},{"title":"<code>try</code>","href":null,"fullPath":"/terraform/language/functions/try","id":"sidebar-nav-item-203","path":"/language/functions/try"},{"title":"<code>type</code>","href":null,"fullPath":"/terraform/language/functions/type","id":"sidebar-nav-item-204","path":"/language/functions/type"}],"id":"sidebar-nav-item-192"},{"title":"Terraform-specific Functions","routes":[{"title":"<code>provider::terraform::encode_tfvars</code>","href":null,"fullPath":"/terraform/language/functions/terraform-encode_tfvars","id":"sidebar-nav-item-206","path":"/language/functions/terraform-encode_tfvars"},{"title":"<code>provider::terraform::decode_tfvars</code>","href":null,"fullPath":"/terraform/language/functions/terraform-decode_tfvars","id":"sidebar-nav-item-207","path":"/language/functions/terraform-decode_tfvars"},{"title":"<code>provider::terraform::encode_expr</code>","href":null,"fullPath":"/terraform/language/functions/terraform-encode_expr","id":"sidebar-nav-item-208","path":"/language/functions/terraform-encode_expr"}],"id":"sidebar-nav-item-205"}],"id":"sidebar-nav-item-75"},{"title":"Terraform Settings","routes":[{"title":"Overview","path":"settings","filePath":"../docs/language/settings/index.mdx","fullPath":"/terraform/language/settings","id":"sidebar-nav-item-210"},{"title":"Terraform Cloud","path":"settings/terraform-cloud","filePath":"../docs/language/settings/terraform-cloud.mdx","fullPath":"/terraform/language/settings/terraform-cloud","id":"sidebar-nav-item-211"},{"title":"Backends","routes":[{"title":"Backend Configuration","path":"settings/backends/configuration","filePath":"../docs/language/settings/backends/configuration.mdx","fullPath":"/terraform/language/settings/backends/configuration","id":"sidebar-nav-item-213"},{"title":"Available Backends","routes":[{"title":"local","href":null,"fullPath":"/terraform/language/settings/backends/local","id":"sidebar-nav-item-215","path":"/language/settings/backends/local"},{"title":"remote","href":null,"fullPath":"/terraform/language/settings/backends/remote","id":"sidebar-nav-item-216","path":"/language/settings/backends/remote"},{"title":"azurerm","href":null,"fullPath":"/terraform/language/settings/backends/azurerm","id":"sidebar-nav-item-217","path":"/language/settings/backends/azurerm"},{"title":"consul","href":null,"fullPath":"/terraform/language/settings/backends/consul","id":"sidebar-nav-item-218","path":"/language/settings/backends/consul"},{"title":"cos","href":null,"fullPath":"/terraform/language/settings/backends/cos","id":"sidebar-nav-item-219","path":"/language/settings/backends/cos"},{"title":"gcs","href":null,"fullPath":"/terraform/language/settings/backends/gcs","id":"sidebar-nav-item-220","path":"/language/settings/backends/gcs"},{"title":"http","href":null,"fullPath":"/terraform/language/settings/backends/http","id":"sidebar-nav-item-221","path":"/language/settings/backends/http"},{"title":"Kubernetes","href":null,"fullPath":"/terraform/language/settings/backends/kubernetes","id":"sidebar-nav-item-222","path":"/language/settings/backends/kubernetes"},{"title":"oss","href":null,"fullPath":"/terraform/language/settings/backends/oss","id":"sidebar-nav-item-223","path":"/language/settings/backends/oss"},{"title":"pg","href":null,"fullPath":"/terraform/language/settings/backends/pg","id":"sidebar-nav-item-224","path":"/language/settings/backends/pg"},{"title":"s3","href":null,"fullPath":"/terraform/language/settings/backends/s3","id":"sidebar-nav-item-225","path":"/language/settings/backends/s3"}],"id":"sidebar-nav-item-214"}],"id":"sidebar-nav-item-212"}],"id":"sidebar-nav-item-209"},{"title":"State","routes":[{"title":"Overview","path":"state","filePath":"../docs/language/state/index.mdx","fullPath":"/terraform/language/state","id":"sidebar-nav-item-227"},{"title":"Purpose","path":"state/purpose","filePath":"../docs/language/state/purpose.mdx","fullPath":"/terraform/language/state/purpose","id":"sidebar-nav-item-228"},{"title":"The <code>terraform_remote_state</code> Data Source","path":"state/remote-state-data","filePath":"../docs/language/state/remote-state-data.mdx","fullPath":"/terraform/language/state/remote-state-data","id":"sidebar-nav-item-229"},{"title":"Backends: State Storage and Locking","path":"state/backends","filePath":"../docs/language/state/backends.mdx","fullPath":"/terraform/language/state/backends","id":"sidebar-nav-item-230"},{"title":"Import Existing Resources","path":"state/import","filePath":"../docs/language/state/import.mdx","fullPath":"/terraform/language/state/import","id":"sidebar-nav-item-231"},{"title":"Locking","path":"state/locking","filePath":"../docs/language/state/locking.mdx","fullPath":"/terraform/language/state/locking","id":"sidebar-nav-item-232"},{"title":"Workspaces","path":"state/workspaces","filePath":"../docs/language/state/workspaces.mdx","fullPath":"/terraform/language/state/workspaces","id":"sidebar-nav-item-233"},{"title":"Remote State","path":"state/remote","filePath":"../docs/language/state/remote.mdx","fullPath":"/terraform/language/state/remote","id":"sidebar-nav-item-234"},{"title":"Sensitive Data","path":"state/sensitive-data","filePath":"../docs/language/state/sensitive-data.mdx","fullPath":"/terraform/language/state/sensitive-data","id":"sidebar-nav-item-235"}],"id":"sidebar-nav-item-226"},{"title":"Tests","routes":[{"title":"Overview","path":"tests","filePath":"../docs/language/tests/index.mdx","fullPath":"/terraform/language/tests","id":"sidebar-nav-item-237"},{"title":"Mocks","path":"tests/mocking","filePath":"../docs/language/tests/mocking.mdx","fullPath":"/terraform/language/tests/mocking","id":"sidebar-nav-item-238"}],"id":"sidebar-nav-item-236"},{"title":"Upgrading to Terraform v1.7","path":"upgrade-guides","filePath":"../docs/language/upgrade-guides/index.mdx","fullPath":"/terraform/language/upgrade-guides","id":"sidebar-nav-item-239"},{"title":"v1.x Compatibility Promises","path":"v1-compatibility-promises","filePath":"../docs/language/v1-compatibility-promises.mdx","fullPath":"/terraform/language/v1-compatibility-promises","id":"sidebar-nav-item-240"},{"divider":true,"id":"sidebar-nav-item-241"},{"title":"Terraform Internals","href":null,"fullPath":"/terraform/internals","id":"sidebar-nav-item-242","path":"/internals"}],"title":"Configuration Language","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/terraform/blob/main/website/../docs/language/modules/develop/refactoring.mdx"},"metadata":{"title":"Refactoring","description":"How to make backward-compatible changes to modules already in use.","layout":null},"outlineItems":[{"title":"Refactoring","url":"#refactoring","dataHeapTrack":"toc-list-item-index-0"},{"title":"moved Block Syntax","url":"#moved-block-syntax","dataHeapTrack":"toc-list-item-index-1"},{"title":"Renaming a Resource","url":"#renaming-a-resource","dataHeapTrack":"toc-list-item-index-2"},{"title":"Enabling count or for_each For a Resource","url":"#enabling-count-or-for_each-for-a-resource","dataHeapTrack":"toc-list-item-index-3"},{"title":"Renaming a Module Call","url":"#renaming-a-module-call","dataHeapTrack":"toc-list-item-index-4"},{"title":"Enabling count or for_each For a Module Call","url":"#enabling-count-or-for_each-for-a-module-call","dataHeapTrack":"toc-list-item-index-5"},{"title":"Splitting One Module into Multiple","url":"#splitting-one-module-into-multiple","dataHeapTrack":"toc-list-item-index-6"},{"title":"Removing moved Blocks","url":"#removing-moved-blocks","dataHeapTrack":"toc-list-item-index-7"}],"pageHeading":{"id":"refactoring","title":"Refactoring"},"mdxSource":{"compiledSource":"var l=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var t=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var c=(a,n,o)=>n in a?l(a,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[n]=o,e=(a,n)=>{for(var o in n||(n={}))p.call(n,o)&&c(a,o,n[o]);if(t)for(var o of t(n))r.call(n,o)&&c(a,o,n[o]);return a},i=(a,n)=>d(a,N(n));var m=(a,n)=>{var o={};for(var s in a)p.call(a,s)&&n.indexOf(s)<0&&(o[s]=a[s]);if(a!=null&&t)for(var s of t(a))n.indexOf(s)<0&&r.call(a,s)&&(o[s]=a[s]);return o};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(o){var s=o,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,i(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"\",mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" Explicit refactoring declarations with \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" blocks is available in Terraform v1.1 and later. For earlier Terraform versions or for refactoring actions too complex to express as \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` blocks, you can\nuse the `,mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/cli/commands/state/mv\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"terraform state mv\"),\" CLI command\"),`\nas a separate step.`)),mdx(\"p\",null,`In shared modules and long-lived configurations, you may eventually outgrow\nyour initial module structure and resource names. For example, you might decide\nthat what was previously one child module makes more sense as two separate\nmodules and move a subset of the existing resources to the new one.`),mdx(\"p\",null,`Terraform compares previous state with new configuration, correlating by\neach module or resource's unique address. Therefore `,mdx(\"em\",{parentName:\"p\"},\"by default\"),` Terraform\nunderstands moving or renaming an object as an intent to destroy the object\nat the old address and to create a new object at the new address.`),mdx(\"p\",null,\"When you add \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` blocks in your configuration to record where you've\nhistorically moved or renamed an object, Terraform treats an existing object at\nthe old address as if it now belongs to the new address.`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},\"Hands On:\"),\" Try the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/tutorials/configuration-language/move-config\"}),\"Use Configuration to Move Resources\"),\" tutorial.\")),mdx(\"h2\",e({},{id:\"moved-block-syntax\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#moved-block-syntax\",\"aria-label\":\"moved block syntax permalink\"}),\"\\xBB\"),mdx(\"inlineCode\",{parentName:\"h2\"},\"moved\"),\" Block Syntax\"),mdx(\"p\",null,\"A \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" block expects no labels and contains only \",mdx(\"inlineCode\",{parentName:\"p\"},\"from\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"to\"),\" arguments:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"The example above records that the resource currently known as \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b\"),`\nwas known as `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),\" in a previous version of this module.\"),mdx(\"p\",null,\"Before creating a new plan for \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b\"),`, Terraform first checks\nwhether there is an existing object for `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),` recorded in the state.\nIf there is an existing object, Terraform renames that object to\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b\"),` and then proceeds with creating a plan. The resulting plan is\nas if the object had originally been created at `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b\"),`, avoiding any\nneed to destroy it during apply.`),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"from\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"to\"),` addresses both use a special addressing syntax that allows\nselecting modules, resources, and resources inside child modules. Below, we\ndescribe several refactoring use-cases and the appropriate addressing syntax\nfor each situation.`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#renaming-a-resource\"}),\"Renaming a Resource\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#enabling-count-or-for_each-for-a-resource\"}),\"Enabling \",mdx(\"inlineCode\",{parentName:\"a\"},\"count\"),\" or \",mdx(\"inlineCode\",{parentName:\"a\"},\"for_each\"),\" For a Resource\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#renaming-a-module-call\"}),\"Renaming a Module Call\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#enabling-count-or-for_each-for-a-module-call\"}),\"Enabling \",mdx(\"inlineCode\",{parentName:\"a\"},\"count\"),\" or \",mdx(\"inlineCode\",{parentName:\"a\"},\"for_each\"),\" For a Module Call\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#splitting-one-module-into-multiple\"}),\"Splitting One Module into Multiple\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{href:\"#removing-moved-blocks\"}),\"Removing \",mdx(\"inlineCode\",{parentName:\"a\"},\"moved\"),\" blocks\"))),mdx(\"h2\",e({},{id:\"renaming-a-resource\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#renaming-a-resource\",\"aria-label\":\"renaming a resource permalink\"}),\"\\xBB\"),\"Renaming a Resource\"),mdx(\"p\",null,\"Consider this example module with a resource configuration:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"a\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"count\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`Applying this configuration for the first time would cause Terraform to\ncreate `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a[0]\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a[1]\"),\".\"),mdx(\"p\",null,`If you later choose a different name for this resource, then you can change the\nname label in the `,mdx(\"inlineCode\",{parentName:\"p\"},\"resource\"),\" block and record the old name inside a \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" block:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"b\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"count\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`When creating the next plan for each configuration using this module, Terraform\ntreats any existing objects belonging to `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),` as if they had\nbeen created for `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b\"),\": \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a[0]\"),` will be treated as\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b[0]\"),\", and \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a[1]\"),\" as \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b[1]\"),\".\"),mdx(\"p\",null,\"New instances of the module, which \",mdx(\"em\",{parentName:\"p\"},\"never\"),` had an\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),\", will ignore the \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` block and propose to create\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b[0]\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b[1]\"),\" as normal.\"),mdx(\"p\",null,`Both of the addresses in this example referred to a resource as a whole, and\nso Terraform recognizes the move for all instances of the resource. That is,\nit covers both `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a[0]\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a[1]\"),` without the need\nto identify each one separately.`),mdx(\"p\",null,`Each resource type has a separate schema and so objects of different types\nare not compatible. Therefore, although you can use `,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` to change the name\nof a resource, you `,mdx(\"em\",{parentName:\"p\"},\"cannot\"),\" use \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` to change to a different resource type\nor to change a managed resource (a `,mdx(\"inlineCode\",{parentName:\"p\"},\"resource\"),` block) into a data resource\n(a `,mdx(\"inlineCode\",{parentName:\"p\"},\"data\"),\" block).\"),mdx(\"h2\",e({},{id:\"enabling-count-or-for_each-for-a-resource\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#enabling-count-or-for_each-for-a-resource\",\"aria-label\":\"enabling count or for_each for a resource permalink\"}),\"\\xBB\"),\"Enabling \",mdx(\"inlineCode\",{parentName:\"h2\"},\"count\"),\" or \",mdx(\"inlineCode\",{parentName:\"h2\"},\"for_each\"),\" For a Resource\"),mdx(\"p\",null,\"Consider this example module containing a single-instance resource:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"a\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`Applying this configuration would lead to Terraform creating an object\nbound to the address `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),\".\"),mdx(\"p\",null,\"Later, you use \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/meta-arguments/for_each\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"for_each\")),` with this\nresource to systematically declare multiple instances. To preserve an object\nthat was previously associated with `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),` alone, you must add a\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` block to specify which instance key the object will take in the new\nconfiguration:`),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"locals\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"instances\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" tomap(\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"big\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"instance_type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"m3.large\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"small\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"instance_type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"t2.medium\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),\")\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"a\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"for_each\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" local.instances\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"instance_type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" each.value.instance_type\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.a\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"small\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`The above will keep Terraform from planning to destroy any existing object at\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),`, treating that object instead as if it were originally\ncreated as `,mdx(\"inlineCode\",{parentName:\"p\"},'aws_instance.a[\"small\"]'),\".\"),mdx(\"p\",null,`When at least one of the two addresses includes an instance key, like\n`,mdx(\"inlineCode\",{parentName:\"p\"},'[\"small\"]'),` in the above example, Terraform understands both addresses as\nreferring to specific `,mdx(\"em\",{parentName:\"p\"},\"instances\"),` of a resource rather than the resource as a\nwhole. That means you can use `,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` to switch between keys and to add and\nremove keys as you switch between `,mdx(\"inlineCode\",{parentName:\"p\"},\"count\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"for_each\"),\", or neither.\"),mdx(\"p\",null,\"The following are some other examples of valid \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` blocks that record\nchanges to resource instance keys in a similar way:`),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# Both old and new configuration used \"for_each\", but the'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# \"small\" element was renamed to \"tiny\".'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"small\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"tiny\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# The old configuration used \"count\" and the new configuration'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# uses \"for_each\", with the following mappings from'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# index to key:\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.c\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"0\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.c\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"small\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.c\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.c\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"tiny\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# The old configuration used \"count\", and the new configuration'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# uses neither \"count\" nor \"for_each\", and you want to keep'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# only the object at index 2.\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.d\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.d\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"\",mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" When you add \",mdx(\"inlineCode\",{parentName:\"p\"},\"count\"),` to an existing resource that didn't use it,\nTerraform automatically proposes to move the original object to instance zero,\nunless you write an `,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` block explicitly mentioning that resource.\nHowever, we recommend still writing out the corresponding `,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` block\nexplicitly, to make the change clearer to future readers of the module.`)),mdx(\"h2\",e({},{id:\"renaming-a-module-call\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#renaming-a-module-call\",\"aria-label\":\"renaming a module call permalink\"}),\"\\xBB\"),\"Renaming a Module Call\"),mdx(\"p\",null,`You can rename a call to a module in a similar way as renaming a resource.\nConsider the following original module version:`),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"a\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../modules/example\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (module arguments)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`When applying this configuration, Terraform would prefix the addresses for\nany resources declared in this module with the module path `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.a\"),`.\nFor example, a resource `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.example\"),` would have the full address\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"module.a.aws_instance.example\"),\".\"),mdx(\"p\",null,`If you later choose a better name for this module call, then you can change the\nname label in the `,mdx(\"inlineCode\",{parentName:\"p\"},\"module\"),\" block and record the old name inside a \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" block:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"b\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../modules/example\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (module arguments)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.b\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`When creating the next plan for each configuration using this module, Terraform\nwill treat any existing object addresses beginning with `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.a\"),` as if\nthey had instead been created in `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.b\"),\". \",mdx(\"inlineCode\",{parentName:\"p\"},\"module.a.aws_instance.example\"),`\nwould be treated as `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.b.aws_instance.example\"),\".\"),mdx(\"p\",null,`Both of the addresses in this example referred to a module call as a whole, and\nso Terraform recognizes the move for all instances of the call. If this\nmodule call used `,mdx(\"inlineCode\",{parentName:\"p\"},\"count\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\"for_each\"),` then it would apply to all of the\ninstances, without the need to specify each one separately.`),mdx(\"h2\",e({},{id:\"enabling-count-or-for_each-for-a-module-call\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#enabling-count-or-for_each-for-a-module-call\",\"aria-label\":\"enabling count or for_each for a module call permalink\"}),\"\\xBB\"),\"Enabling \",mdx(\"inlineCode\",{parentName:\"h2\"},\"count\"),\" or \",mdx(\"inlineCode\",{parentName:\"h2\"},\"for_each\"),\" For a Module Call\"),mdx(\"p\",null,\"Consider this example of a single-instance module:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"a\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../modules/example\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (module arguments)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`Applying this configuration would cause Terraform to create objects whose\naddresses begin with `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.a\"),\".\"),mdx(\"p\",null,`In later module versions, you may need to use\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/meta-arguments/count\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"count\")),` with this resource to systematically\ndeclare multiple instances. To preserve an object that was previously associated\nwith `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),\" alone, you can add a \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` block to specify which\ninstance key that object will take in the new configuration:`),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"a\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../modules/example\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"count\"),\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"3\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (module arguments)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.a\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"The configuration above directs Terraform to treat all objects in \",mdx(\"inlineCode\",{parentName:\"p\"},\"module.a\"),` as\nif they were originally created in `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.a[2]\"),`. As a result, Terraform plans\nto create new objects only for `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.a[0]\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"module.a[1]\"),\".\"),mdx(\"p\",null,`When at least one of the two addresses includes an instance key, like\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"[2]\"),` in the above example, Terraform will understand both addresses as\nreferring to specific `,mdx(\"em\",{parentName:\"p\"},\"instances\"),` of a module call rather than the module\ncall as a whole. That means you can use `,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` to switch between keys and to\nadd and remove keys as you switch between `,mdx(\"inlineCode\",{parentName:\"p\"},\"count\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"for_each\"),\", or neither.\"),mdx(\"p\",null,`For more examples of recording moves associated with instances, refer to\nthe similar section\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"#enabling-count-or-for_each-for-a-resource\"}),\"Enabling \",mdx(\"inlineCode\",{parentName:\"a\"},\"count\"),\" and \",mdx(\"inlineCode\",{parentName:\"a\"},\"for_each\"),\" For a Resource\"),\".\"),mdx(\"h1\",e({},{id:\"splitting-one-module-into-multiple\"}),mdx(\"a\",e({parentName:\"h1\"},{className:\"__permalink-h\",href:\"#splitting-one-module-into-multiple\",\"aria-label\":\"splitting one module into multiple permalink\"}),\"\\xBB\"),\"Splitting One Module into Multiple\"),mdx(\"p\",null,`As a module grows to support new requirements, it might eventually grow big\nenough to warrant splitting into two separate modules.`),mdx(\"p\",null,\"Consider this example module:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"a\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"b\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"c\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"You can split this into two modules as follows:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_instance-a\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_instance-a\",\"aria-label\":\"aws_instance a permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"aws_instance.a\")),' now belongs to module \"x\".'),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_instance-b\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_instance-b\",\"aria-label\":\"aws_instance b permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"aws_instance.b\")),' also belongs to module \"x\".'),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",e({parentName:\"li\"},{id:\"aws_instance-c\",className:\"__target-lic\",\"aria-hidden\":\"true\"})),mdx(\"a\",e({parentName:\"li\"},{href:\"#aws_instance-c\",\"aria-label\":\"aws_instance c permalink\",className:\"__permalink-lic\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"aws_instance.c\")),' belongs module \"y\".')),mdx(\"p\",null,`To achieve this refactoring without replacing existing objects bound to the\nold resource addresses, you must:`),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},'Write module \"x\", copying over the two resources it should contain.'),mdx(\"li\",{parentName:\"ol\"},'Write module \"y\", copying over the one resource it should contain.'),mdx(\"li\",{parentName:\"ol\"},`Edit the original module to no longer include any of these resources, and\ninstead to contain only shim configuration to migrate existing users.`)),mdx(\"p\",null,'The new modules \"x\" and \"y\" should contain only ',mdx(\"inlineCode\",{parentName:\"p\"},\"resource\"),\" blocks:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# module \"x\"'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"a\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"b\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# module \"y\"'),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_instance\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"c\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# (other resource-type-specific configuration)\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`The original module, now only a shim for backward-compatibility, calls the\ntwo new modules and indicates that the resources moved into them:`),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"x\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../modules/x\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"y\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../modules/y\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.x.aws_instance.a\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.x.aws_instance.b\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.c\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.y.aws_instance.c\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`When an existing user of the original module upgrades to the new \"shim\"\nversion, Terraform notices these three `,mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` blocks and behaves\nas if the objects associated with the three old resource addresses were\noriginally created inside the two new modules.`),mdx(\"p\",null,`New users of this family of modules may use either the combined shim module\n`,mdx(\"em\",{parentName:\"p\"},\"or\"),` the two new modules separately. You may wish to communicate to your\nexisting users that the old module is now deprecated and so they should use\nthe two separate modules for any new needs.`),mdx(\"p\",null,`The multi-module refactoring situation is unusual in that it violates the\ntypical rule that a parent module sees its child module as a \"closed box\",\nunaware of exactly which resources are declared inside it. This compromise\nassumes that all three of these modules are maintained by the same people\nand distributed together in a single\n`,mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/modules/sources#modules-in-package-sub-directories\"}),\"module package\"),\".\"),mdx(\"p\",null,\"Terraform resolves module references in \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),` blocks relative to the module\ninstance they are defined in. For example, if the original module above were\nalready a child module named `,mdx(\"inlineCode\",{parentName:\"p\"},\"module.original\"),`, the reference to\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"module.x.aws_instance.a\"),` would resolve as\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"module.original.module.x.aws_instance.a\"),\". A module may only make \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),`\nstatements about its own objects and objects of its child modules.`),mdx(\"p\",null,`If you need to refer to resources within a module that was called using\n`,mdx(\"inlineCode\",{parentName:\"p\"},\"count\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\"for_each\"),` meta-arguments, you must specify a specific instance\nkey to use in order to match with the new location of the resource\nconfiguration:`),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.example\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" module.new\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),\".aws_instance.example\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h2\",e({},{id:\"removing-moved-blocks\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#removing-moved-blocks\",\"aria-label\":\"removing moved blocks permalink\"}),\"\\xBB\"),\"Removing \",mdx(\"inlineCode\",{parentName:\"h2\"},\"moved\"),\" Blocks\"),mdx(\"p\",null,\"Over time, a long-lasting module may accumulate many \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" blocks.\"),mdx(\"p\",null,\"Removing a \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" block is a generally breaking change because any configurations that refer to the old address will plan to delete that existing object instead of move it. We strongly recommend that you retain all historical \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" blocks from earlier versions of your modules to preserve the upgrade path for users of any previous version.\"),mdx(\"p\",null,\"If you do decide to remove \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" blocks, proceed with caution. It can be safe to remove \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" blocks when you are maintaining private modules within an organization and you are certain that all users have successfully run \",mdx(\"inlineCode\",{parentName:\"p\"},\"terraform apply\"),\" with your new module version.\"),mdx(\"p\",null,`If you need to rename or move the same object twice, we recommend documenting the full history\nusing `,mdx(\"em\",{parentName:\"p\"},\"chained\"),\" \",mdx(\"inlineCode\",{parentName:\"p\"},\"moved\"),\" blocks, where the new block refers to the existing block:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.a\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"moved\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"from\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.b\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"to\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_instance.c\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,`Recording a sequence of moves in this way allows for successful upgrades for\nboth configurations with objects at `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.a\"),\" \",mdx(\"em\",{parentName:\"p\"},\"and\"),` configurations with\nobjects at `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.b\"),`. In both cases, Terraform treats the existing\nobject as if it had been originally created as `,mdx(\"inlineCode\",{parentName:\"p\"},\"aws_instance.c\"),\".\"))}MDXContent.isMDXComponent=!0;\n","scope":{"version":"latest"}},"product":{"slug":"terraform","name":"Terraform","algoliaConfig":{"indexName":"product_TERRAFORM"},"basePaths":["cdktf","cli","cloud-docs","cloud-docs/agents","docs","enterprise","internals","intro","language","plugin","plugin/framework","plugin/log","plugin/mux","plugin/sdkv2","plugin/testing","registry","downloads"],"docsNavItems":["docs","language","cli","cloud-docs","enterprise","cdktf",{"icon":"provider","label":"Provider Use","fullPath":"/terraform/language/providers"},"plugin","registry",{"icon":"handshake","label":"Integration Program","fullPath":"/terraform/docs/partnerships"}],"rootDocsPaths":[{"iconName":"code","name":"CDK for Terraform","path":"cdktf","productSlugForLoader":"terraform-cdk"},{"iconName":"terminal-screen","name":"Terraform CLI","path":"cli"},{"iconName":"cloud","name":"Terraform Cloud","path":"cloud-docs","productSlugForLoader":"terraform-docs-common"},{"iconName":"cloud","name":"Cloud Docs Agents","navDataPrefix":"cloud-docs-agents","path":"cloud-docs/agents","productSlugForLoader":"terraform-docs-agents"},{"iconName":"docs","name":"About the Docs","path":"docs","productSlugForLoader":"terraform-docs-common"},{"iconName":"org","name":"Terraform Enterprise","path":"enterprise","productSlugForLoader":"ptfe-releases"},{"iconName":"docs","name":"Internals","path":"internals"},{"iconName":"docs","name":"Intro","path":"intro"},{"iconName":"file-source","name":"Configuration Language","path":"language"},{"iconName":"wrench","name":"Plugin Development","path":"plugin","productSlugForLoader":"terraform-docs-common"},{"iconName":"plug","name":"Framework","navDataPrefix":"plugin-framework","path":"plugin/framework","productSlugForLoader":"terraform-plugin-framework"},{"iconName":"plug","name":"Logging","navDataPrefix":"plugin-log","path":"plugin/log","productSlugForLoader":"terraform-plugin-log"},{"iconName":"plug","name":"Combining and Translating","navDataPrefix":"plugin-mux","path":"plugin/mux","productSlugForLoader":"terraform-plugin-mux"},{"iconName":"plug","name":"SDKv2","path":"plugin/sdkv2","productSlugForLoader":"terraform-plugin-sdk","navDataPrefix":"plugin-sdkv2"},{"iconName":"plug","name":"Testing","path":"plugin/testing","productSlugForLoader":"terraform-plugin-testing","navDataPrefix":"plugin-testing"},{"iconName":"plus-circle","name":"Registry Publishing","path":"registry","productSlugForLoader":"terraform-docs-common"}],"currentRootDocsPath":{"iconName":"file-source","name":"Configuration Language","path":"language"}},"projectName":null,"versions":null},"__N_SSG":true}