<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Tests - Configuration Language | Terraform | HashiCorp Developer</title><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta property="og:locale" content="en_US"/><meta property="og:type" content="website"/><meta property="article:publisher" content="https://www.facebook.com/HashiCorp/"/><meta name="twitter:site" content="@HashiCorp"/><meta name="twitter:card" content="summary_large_image"/><meta name="theme-color" content="#000"/><meta name="description" property="og:description" content="Write structured test code for validating your configuration."/><meta name="twitter:description" content="Write structured test code for validating your configuration."/><meta property="og:site_name" content="Tests - Configuration Language | Terraform | HashiCorp Developer"/><meta property="og:title" content="Tests - Configuration Language | Terraform | HashiCorp Developer"/><meta property="og:image" content="https://developer.hashicorp.com/og-image/terraform.jpg"/><link rel="canonical" href="https://developer.hashicorp.com/terraform/language/tests"/><link rel="icon" href="/favicon.ico" sizes="any"/><link rel="icon" href="/icon.svg" type="image/svg+xml"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="google-site-verification" content="zRQZqfAsOX-ypXfU0mzAIzb5rUvj5fA4Zw2jWJRN-JI"/><meta name="zd-site-verification" content="xnvnvv1i0wl4tf0pzaymb" data-product="hcp"/><meta name="zd-site-verification" content="36fp2i1pj67d8cjtzf4fi9" data-product="terraform"/><meta name="zd-site-verification" content="nbe87kfyp1sck7b13vj1i" data-product="packer"/><meta name="zd-site-verification" content="wvsmmqa1cfb9am9zlwfj" data-product="consul"/><meta name="zd-site-verification" content="cw22oopfwr68ujj0n5pn9i" data-product="boundary"/><meta name="zd-site-verification" content="lkslvganwfgfqfwpdeicgh" data-product="vault"/><meta name="zd-site-verification" content="jl2wp2hoej9rz6c8rmqdns" data-product="nomad"/><meta name="zd-site-verification" content="2eb0cu6xceo73t0038m0tb" data-product="waypoint"/><meta name="zd-site-verification" content="n52xisxdf3higs2q9kuogd" data-product="vagrant"/><meta name="twitter:image" content="https://developer.hashicorp.com/og-image/terraform.jpg"/><link rel="prefetch" href="https://www.datadoghq-browser-agent.com/datadog-rum-v4.js"/><script type="application/ld+json">[{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Developer","item":"https://developer.hashicorp.com/"},{"@type":"ListItem","position":2,"name":"Terraform","item":"https://developer.hashicorp.com/terraform"},{"@type":"ListItem","position":3,"name":"Configuration Language","item":"https://developer.hashicorp.com/terraform/language"},{"@type":"ListItem","position":4,"name":"Tests","item":"https://developer.hashicorp.com/terraform/language/tests"}]}]</script><meta name="next-head-count" content="31"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/hashicorp-terraform/_next/static/css/5b198a6b9814f8df.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-terraform/_next/static/css/5b198a6b9814f8df.css" crossorigin="" data-n-g=""/><link rel="preload" href="/hashicorp-terraform/_next/static/css/63deaa568623a226.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-terraform/_next/static/css/63deaa568623a226.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-terraform/_next/static/css/e6c79edad9f1145a.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-terraform/_next/static/css/e6c79edad9f1145a.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-terraform/_next/static/css/5734d1b25a4d4e7f.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-terraform/_next/static/css/5734d1b25a4d4e7f.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-terraform/_next/static/css/d84fe9967a765e18.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-terraform/_next/static/css/d84fe9967a765e18.css" crossorigin="" data-n-p=""/><link rel="preload" href="/hashicorp-terraform/_next/static/css/9670b996c3d0a580.css" as="style" crossorigin=""/><link rel="stylesheet" href="/hashicorp-terraform/_next/static/css/9670b996c3d0a580.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/hashicorp-terraform/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/hashicorp-terraform/_next/static/chunks/webpack-459e279298361c75.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/framework-314c182fa7e2bf37.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/main-678b8f0aeb231b6c.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/pages/_app-3878081540076fd5.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/6110-275faa7d5da284e3.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/568-a7abc2bd9d006008.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/1061-47d9b2916173aa81.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/8495-fcdbe08df7351184.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/9390-7c63c5f40603a618.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/2775-c6f69217b49d94ac.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/8460-ee59ea4f6b57735c.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/2102-216c8ee4e4fb533d.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/6288-512a09885894aab5.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/8857-a9d37548827db17f.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/4512-cc43431305170807.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/2502-525ef03b52e708a4.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/chunks/pages/terraform/language/%5B%5B...page%5D%5D-f6e2f62081f79c74.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/EKhU1E0BkpF0JXZAOB7ND/_buildManifest.js" defer="" crossorigin=""></script><script src="/hashicorp-terraform/_next/static/EKhU1E0BkpF0JXZAOB7ND/_ssgManifest.js" defer="" crossorigin=""></script></head><body><script>!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://artemis.hashicorp.com/script/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics._cdn="https://artemis.hashicorp.com";analytics.SNIPPET_VERSION="4.1.0";}}();</script><div id="__next"><div class="style_root__dZhZu"><a href="https://hashi.co/dev-ai-signup" class="style_linkElem__hCESK"><span class="style_textContainer__6CuI7 g-grid-container"><span class="style_tag__jbHGz g-type-body-small-x-strong">HashiCorp Developer AI<!-- --> </span><span class="style_text__rwS0u g-type-body-small">Private beta now available<span class="style_linkText__E8GJf g-type-body-small-x-strong"> <!-- -->Sign up today</span></span></span></a><button class="style_closeButton__57J9w"><div><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15 5L5 15M5 5l10 10" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></div><span style="position:absolute;border:0;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;word-wrap:normal">Dismiss alert</span></button></div><script type="text/javascript">
(function checkDismissAlertBanner() {
  try {
    if (document.cookie.includes('banner_private-beta-now-available=1')) {
      const element = document.querySelector('.style_root__dZhZu')
      element.classList.remove('style_isShown__D4mb6')
    }
  } catch (_) {
    // do nothing
  }
})()
</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="core-dev-dot-layout_root__MT1PZ"><div class="base-layout_root___qiZs" data-layout="base-new"><div class="base-layout_header__XhkxS"><header class="navigation-header_root__oE_HT"><div class="navigation-header_leftSide__V0xlc"><div class="product-page-content_productsDropdown__haUyw"><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-1" aria-expanded="false" aria-label="Main menu" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark product-page-content_productsDropdownButton__bnKKs" data-heap-track="navigation-header-dropdown-menu-activator"><span class="dropdown-menu_activatorLeadingIcon__YQQlH"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true" class="product-page-content_productsDropdownIcon__gXtly"><g fill="currentColor"><path d="M10.336 1.5L2 6.268v11.456l3.131 1.793V8.061l5.205-2.979V1.5z"></path><path d="M13.664 1.5v9.123h-3.328V7.219L7.203 9.012V20.7l3.133 1.796V13.4h3.328v3.381l3.131-1.793V3.293L13.664 1.5z"></path><path d="M22 17.732L13.664 22.5v-3.582l5.203-2.98V4.484L22 6.276v11.456z"></path></g></svg></span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN product-page-content_productsDropdownPane__bcdWz" id="navigation-header-menu-react-aria-1" style="display:none"><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.846 2.574a.25.25 0 01.308 0l5.25 4.12a.25.25 0 01.096.196v7.36a.75.75 0 001.5 0V6.89a1.75 1.75 0 00-.67-1.377L9.08 1.394a1.75 1.75 0 00-2.16 0l-5.25 4.12A1.75 1.75 0 001 6.89v7.36a.75.75 0 001.5 0V6.89a.25.25 0 01.096-.196l5.25-4.12z"></path><path d="M6.5 14.25V10.5h3v3.75a.75.75 0 001.5 0v-4C11 9.56 10.44 9 9.75 9h-3.5C5.56 9 5 9.56 5 10.25v4a.75.75 0 001.5 0z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Developer</span></div></div></a></li></ul><hr class="dropdown-menu_itemGroupDivider__X38aR"/><ul class="dropdown-menu_itemGroup__GEq4r"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/hcp"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M6.835.6L1 3.96v8.074l2.192 1.264V5.224l3.643-2.1V.6z"></path><path d="M9.165.6v6.43h-2.33v-2.4L4.642 5.894v8.237l2.193 1.266v-6.41h2.33v2.383l2.192-1.264V1.864L9.165.6z"></path><path d="M15 12.04L9.165 15.4v-2.525l3.642-2.1V2.703L15 3.966v8.073z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">HashiCorp Cloud Platform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/packer"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-packer-brand)"><path d="M5.163 0l5.762 3.247c1.138.646 2.074 2.085 2.075 3.2v4.963c0 1.123-.933 1.502-2.074.858L9.083 11.23V4.469l-3.92-2.216V0z"></path><path d="M8.3 4.953L3 1.956v11.047L8.3 16V4.953z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Packer</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/consul"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-consul-brand)"><path d="M4.737 14.193A7 7 0 008.006 15a6.98 6.98 0 004.735-1.847l-1.66-1.737a4.6 4.6 0 110-6.828l1.66-1.738a7 7 0 10-8.004 11.343zM13.32 11.402a.573.573 0 10.637-.953.573.573 0 00-.637.953z"></path><path d="M7.96 9.517a1.517 1.517 0 11-.012-3.034 1.517 1.517 0 01.013 3.034zM13.978 9.447a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 9.472a.574.574 0 110-1.148.574.574 0 010 1.148zM13.978 7.514a.574.574 0 10.637-.954.574.574 0 00-.637.954zM12.59 7.675a.574.574 0 110-1.148.574.574 0 010 1.148zM13.353 5.585a.574.574 0 10.635-.956.574.574 0 00-.635.956z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Consul</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/vault"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-vault-brand)" d="M0 0l7.971 15.516L16 0H0zm6.732 6.16h-1.27V4.89h1.27v1.27zm0-1.906h-1.27V2.985h1.27v1.269zm1.904 3.81h-1.27v-1.27h1.27v1.27zm0-1.905h-1.27V4.89h1.27v1.27zm0-1.905h-1.27V2.985h1.27v1.269zm1.894 1.905H9.26V4.89h1.27v1.27zM9.26 4.254V2.985h1.27v1.269H9.26z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vault</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/boundary"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-boundary-brand)"><path d="M4.81 15v-1.085h2.25v-.67H5.968v-1.093h5.149L8.726 8l2.392-4.154H5.84v5.76H3V1h9.775l1.631 2.832L12.006 8l2.448 4.252L12.872 15H4.81z"></path><path d="M5.248 12.152h-1.09v1.092h1.09v-1.092zM3 13.907h1.09v1.092H3v-1.092z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Boundary</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/nomad"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="var(--token-color-nomad-brand)" d="M8 0L1 4v8l7 4 7-4V4L8 0zm3.119 8.797L9.254 9.863 7.001 8.65v2.549l-2.118 1.33v-5.33l1.68-1.018 2.332 1.216V4.794l2.23-1.322-.006 5.325z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Nomad</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/waypoint"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="var(--token-color-waypoint-brand)"><path d="M4 5.312h1.334L10 13.4l3.334-5.777L10.666 3H8l2.666 4.623L10 8.778 6.667 3H0l6 10.4 1.333-2.31L4 5.311zM14.002 6.463L16 3h-3.996l1.998 3.463z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Waypoint</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/vagrant"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="#1868F2" d="M13.08.75L9.924 2.58v1.123L8 8.245 6.076 3.703V2.58L2.92.75 1 1.864v1.293l4.276 10.514L8 15.25l2.724-1.579L15 3.157V1.864L13.08.75z"></path><path fill="#0850C5" d="M15 1.865l-3.157 1.829v1.124L9.28 10.57 8 11.312v3.939l2.724-1.579L15 3.158V1.865zM6.076 3.703V2.58l-1.92 1.113v1.125l2.564 5.751L8 9.827V8.245L6.076 3.703z"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Vagrant</span></div></div></a></li></ul></div></div></div><div class="product-page-content_productLinkAndNav__YTzcr"><a aria-label="Terraform home" class="product-icon-text-link_root__bNTSz g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-product-logo-link" href="/hashicorp-terraform/terraform"><div class="product-icon-text-lockup_root__358wV"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="product-icon-text-lockup_icon__Zp_5o"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg><span class="product-icon-text-lockup_text__nHTL7 hds-typography-body-200">Terraform</span></div></a><nav class="nav-bar-list-container_nav__C_i0_"><ul class="nav-bar-list-container_ul___04HI"><li><a aria-label="Terraform Install" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-terraform/terraform/install"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Install</span></a></li><li><a aria-label="Terraform Tutorials" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" href="/hashicorp-terraform/terraform/tutorials"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Tutorials</span></a></li><li><div class="dropdown-menu_root__Hwy5S"><div class="dropdown-menu_activatorWrapper__LxPRt"><button aria-controls="navigation-header-menu-react-aria-15" aria-expanded="false" aria-label="Terraform Documentation" class="dropdown-menu_activator__xXb00 g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-dropdown-menu-activator"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium dropdown-menu_activatorText__acGRP">Documentation</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="dropdown-menu_activatorTrailingIcon__r_cCd"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></button></div><div class="dropdown-menu_dropdownContainer__AZWxN" id="navigation-header-menu-react-aria-15" style="display:none"><ul class="dropdown-menu_itemGroup__GEq4r dropdown-menu_twoColumns__Q_mWF"><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/docs"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M4.25 1A2.25 2.25 0 002 3.25v9.5A2.25 2.25 0 004.25 15h8.5c.69 0 1.25-.56 1.25-1.25V2.25C14 1.56 13.44 1 12.75 1h-8.5zM3.5 12.75c0 .414.336.75.75.75h8.25v-2H4.25a.75.75 0 00-.75.75v.5zm0-2.622c.235-.083.487-.128.75-.128h8.25V2.5H4.25a.75.75 0 00-.75.75v6.878z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">About the Docs</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/language"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M7.22 7.838a.625.625 0 01-.058.882L5.699 10l1.463 1.28a.625.625 0 01-.824.94l-2-1.75a.625.625 0 010-.94l2-1.75a.625.625 0 01.882.058zM8.838 8.72a.625.625 0 01.824-.94l2 1.75a.625.625 0 010 .94l-2 1.75a.625.625 0 01-.824-.94L10.301 10 8.838 8.72z"></path><path fill-rule="evenodd" d="M3.25 0A2.25 2.25 0 001 2.25v11.5A2.25 2.25 0 003.25 16h9.5A2.25 2.25 0 0015 13.75V5.457c0-.331-.132-.65-.366-.884L10.427.366A1.25 1.25 0 009.543 0H3.25zM2.5 2.25a.75.75 0 01.75-.75H9v3.75c0 .414.336.75.75.75h3.75v7.75a.75.75 0 01-.75.75h-9.5a.75.75 0 01-.75-.75V2.25zm9.94 2.25L10.5 2.56V4.5h1.94z" clip-rule="evenodd"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Configuration Language</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/cli"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M3.924 5.02a.75.75 0 011.056-.096l3 2.5a.75.75 0 010 1.152l-3 2.5a.75.75 0 11-.96-1.152L6.328 8 4.02 6.076a.75.75 0 01-.096-1.056zM8.25 10.5a.75.75 0 000 1.5h3a.75.75 0 000-1.5h-3z"></path><path fill-rule="evenodd" d="M0 3.25A2.25 2.25 0 012.25 1h11.5A2.25 2.25 0 0116 3.25v9.5A2.25 2.25 0 0113.75 15H2.25A2.25 2.25 0 010 12.75v-9.5zm2.25-.75a.75.75 0 00-.75.75v9.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-9.5a.75.75 0 00-.75-.75H2.25z" clip-rule="evenodd"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform CLI</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/cloud-docs"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.932 2.373a6.041 6.041 0 016.239 1.28 5.998 5.998 0 011.505 2.284h.28c1.071 0 2.1.424 2.858 1.18a4.025 4.025 0 010 5.703A4.051 4.051 0 0111.955 14H6.026a6.037 6.037 0 01-3.186-.906 6.008 6.008 0 01-2.223-2.448 5.982 5.982 0 01.644-6.32 6.02 6.02 0 012.67-1.953zm.526 1.405a4.52 4.52 0 00-2.013 1.47 4.488 4.488 0 001.186 6.572c.716.444 1.542.68 2.386.68h5.938c.676 0 1.324-.268 1.8-.742a2.524 2.524 0 000-3.578 2.551 2.551 0 00-1.8-.743h-.83a.75.75 0 01-.726-.561A4.496 4.496 0 009.14 4.74a4.541 4.541 0 00-4.681-.963z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform Cloud</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/enterprise"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M1 3.25A2.25 2.25 0 013.25 1h6.5A2.25 2.25 0 0112 3.25v2.112l2.05 1.453A2.25 2.25 0 0115 8.65v5.1c0 .69-.56 1.25-1.25 1.25h-2.5a.748.748 0 01-.75-.751v-11a.75.75 0 00-.75-.75h-6.5a.75.75 0 00-.75.75v11a.75.75 0 01-1.5 0v-11zM12 13.5V7.2l1.184.839a.75.75 0 01.316.612v4.85H12z" clip-rule="evenodd"></path><path d="M4.75 10.55a.7.7 0 00-.7.7v3a.7.7 0 101.4 0v-2.3h2.1v2.3a.7.7 0 101.4 0v-3a.7.7 0 00-.7-.7h-3.5zM4.25 4.75A.75.75 0 015 4h.25a.75.75 0 010 1.5H5a.75.75 0 01-.75-.75zM7.75 4a.75.75 0 000 1.5H8A.75.75 0 008 4h-.25zM4.25 6.75A.75.75 0 015 6h.25a.75.75 0 010 1.5H5a.75.75 0 01-.75-.75zM7.75 6a.75.75 0 000 1.5H8A.75.75 0 008 6h-.25zM4.25 8.75A.75.75 0 015 8h.25a.75.75 0 010 1.5H5a.75.75 0 01-.75-.75zM7.75 8a.75.75 0 000 1.5H8A.75.75 0 008 8h-.25z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Terraform Enterprise</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/cdktf"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9.424 2.02a.75.75 0 00-.904.556l-2.5 10.5a.75.75 0 001.46.348l2.5-10.5a.75.75 0 00-.556-.904zM11.2 4.24a.75.75 0 011.06-.04l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25a.75.75 0 11-1.02-1.1L14.148 8 11.24 5.3a.75.75 0 01-.04-1.06zM4.76 5.3a.75.75 0 00-1.02-1.1L.24 7.45a.75.75 0 000 1.1l3.5 3.25a.75.75 0 101.02-1.1L1.852 8 4.76 5.3z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">CDK for Terraform</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/language/providers"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M8 0a8 8 0 100 16A8 8 0 008 0zm-.5 1.519a6.464 6.464 0 00-2 .48V5.19l2-1.09V1.518zM1.532 7.356A6.491 6.491 0 014 2.876V6.01L1.532 7.356zm.05 1.68L4 7.719v5.406a6.495 6.495 0 01-2.418-4.087zM7.5 11.423l-2 1.143V6.9l2-1.091v5.613zm1.5-.857V4.991L11 3.9v5.522l-2 1.143zm2 .585l-2 1.143v2.13a6.456 6.456 0 002-.655V11.15zm1.5 1.54v-2.397l1.887-1.079A6.488 6.488 0 0112.5 12.69zm0-4.125V3.31a6.482 6.482 0 011.976 4.126L12.5 8.565zm-5 4.585l-1.697.97a6.47 6.47 0 001.697.361V13.15zM9 3.282V1.576a6.455 6.455 0 011.961.636L9 3.282z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Provider Use</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/plugin"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.973 1.506a18.525 18.525 0 00-.497-.006A4.024 4.024 0 006.45 5.524c0 .43.095.865.199 1.205.054.18.116.356.192.527v.002a.75.75 0 01-.15.848l-4.937 4.911a.871.871 0 000 1.229.869.869 0 001.227 0L7.896 9.31a.75.75 0 01.847-.151c.17.079.35.139.529.193.34.103.774.198 1.204.198A4.024 4.024 0 0014.5 5.524c0-.177-.002-.338-.006-.483-.208.25-.438.517-.675.774-.32.345-.677.696-1.048.964-.354.257-.82.512-1.339.512-.396 0-.776-.156-1.059-.433L9.142 5.627a1.513 1.513 0 01-.432-1.06c0-.52.256-.985.514-1.34.27-.37.623-.727.97-1.046.258-.237.529-.466.78-.675zm-2.36 9.209l-4.57 4.59a2.37 2.37 0 01-3.35-3.348l.002-.001 4.591-4.568a6.887 6.887 0 01-.072-.223 5.77 5.77 0 01-.263-1.64A5.524 5.524 0 0110.476 0 12 12 0 0112 .076c.331.044.64.115.873.264a.92.92 0 01.374.45.843.843 0 01-.013.625.922.922 0 01-.241.332c-.26.257-.547.487-.829.72-.315.26-.647.535-.957.82a5.947 5.947 0 00-.771.824c-.197.27-.227.415-.227.457 0 .003 0 .006.003.008l1.211 1.211a.013.013 0 00.008.004c.043 0 .19-.032.46-.227.253-.183.532-.45.826-.767.284-.308.56-.638.82-.95.233-.28.463-.565.72-.823a.925.925 0 01.31-.235.841.841 0 01.628-.033.911.911 0 01.467.376c.15.233.22.543.262.87.047.356.075.847.075 1.522a5.524 5.524 0 01-5.524 5.525c-.631 0-1.221-.136-1.64-.263a6.969 6.969 0 01-.222-.071z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Plugin Development</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/registry"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M8 4.25a.75.75 0 01.75.75v2.25H11a.75.75 0 010 1.5H8.75V11a.75.75 0 01-1.5 0V8.75H5a.75.75 0 010-1.5h2.25V5A.75.75 0 018 4.25z"></path><path fill-rule="evenodd" d="M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13z" clip-rule="evenodd"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Registry Publishing</span></div></div></a></li><li><a class="dropdown-menu_itemLink__92M_R g-focus-ring-from-box-shadow" data-heap-track="navigation-header-dropdown-menu-link" href="/hashicorp-terraform/terraform/docs/partnerships"><div class="dropdown-menu_itemLinkContent__PATCl"><div class="dropdown-menu_leftAlignedItemLinkContent__d9pe_"><span class="dropdown-menu_leftAlignedItemLinkContentIcon__Im2L5 primary-nav-submenu_primarySubnavDropdownItemIcon__yZ84X terraform"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M5 2.75a.75.75 0 00-.53.22l-.78.78H.75a.75.75 0 000 1.5H2v5a.75.75 0 01-.75.75h-.5a.75.75 0 000 1.5h.5a2.25 2.25 0 002.016-1.25h.557l3.063 1.531a2.25 2.25 0 002.254-.14l2.087-1.391h1.507a2.25 2.25 0 002.016 1.25h.5a.75.75 0 000-1.5h-.5a.75.75 0 01-.75-.75v-5h1.25a.75.75 0 000-1.5h-2.94l-.78-.78a.75.75 0 00-.53-.22H5zm-1 2.5h-.5v4.5H4a.75.75 0 01.335.08l3.222 1.61a.75.75 0 00.751-.047l1.652-1.101-.584-.876a.75.75 0 011.248-.832l.777 1.166H12.5v-4.5H12a.75.75 0 01-.53-.22l-.78-.78H8.81L7.065 5.997a.711.711 0 00.971 1.038l.971-.85a.75.75 0 11.988 1.13l-.971.85a2.211 2.211 0 01-3.02-3.229l.686-.686H5.311l-.78.78A.75.75 0 014 5.25z" clip-rule="evenodd"></path><path d="M1.25 9.625a.625.625 0 11-1.25 0 .625.625 0 011.25 0zM16 9.625a.625.625 0 11-1.25 0 .625.625 0 011.25 0z"></path></g></svg></span><span class="text_root__r0DFB hds-typography-body-100 hds-font-weight-regular dropdown-menu_itemText__Ba9wg">Integration Program</span></div></div></a></li></ul></div></div></li><li><a aria-label="Terraform Registry" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="undefinedopens-in-new-tab-label-react-aria-26" target="_blank" href="https://registry.terraform.io/"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Registry</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-26">(opens in new tab)</span></li><li><a aria-label="Terraform Try Cloud" class="primary-nav-link_root__RXZIC g-focus-ring-from-box-shadow-dark" data-heap-track="navigation-header-primary-nav-link" aria-describedby="undefinedopens-in-new-tab-label-react-aria-27" target="_blank" href="https://app.terraform.io/public/signup/account"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium primary-nav-link_linkText__58O0C">Try Cloud</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-27">(opens in new tab)</span></li></ul></nav></div></div><div class="navigation-header_rightSide___Vvh_"><button aria-label="Search" class="command-bar-activator_root__qgVMy g-focus-ring-from-box-shadow-dark"><span class="command-bar-activator_left__ATQTg"><span class="command-bar-activator_leadingIcon__jECP5"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M7.25 2a5.25 5.25 0 103.144 9.455l2.326 2.325a.75.75 0 101.06-1.06l-2.325-2.326A5.25 5.25 0 007.25 2zM3.5 7.25a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0z" clip-rule="evenodd"></path></svg></span><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular command-bar-activator_text__pTZN_">Search</span></span><span class="command-bar-activator_right__XejfJ"><span class="g-screen-reader-only">Command or control key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="cmd-ctrl-icon_root___TToz"><svg width="41" height="11" viewBox="0 0 41 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.125 2.063V3h2.25v-.938a2.062 2.062 0 112.063 2.063H7.5v2.25h.938a2.062 2.062 0 11-2.063 2.063V7.5h-2.25v.938a2.062 2.062 0 11-2.063-2.063H3v-2.25h-.938a2.062 2.062 0 112.063-2.063zm-2.063-.938a.937.937 0 100 1.875H3v-.938a.937.937 0 00-.938-.937zM7.5 7.5v.938a.937.937 0 10.938-.938H7.5zM6.375 6.375v-2.25h-2.25v2.25h2.25zM2.062 7.5H3v.938a.937.937 0 11-.938-.938zM7.5 3h.938a.937.937 0 10-.938-.938V3z" fill="#fff"/><path d="M15.09 10.5L18.085 0h-1.097L14 10.5h1.09zm11.297-5.192c-.183-1.445-1.263-2.534-3.05-2.534C21.264 2.774 20 4.247 20 6.61c0 2.41 1.27 3.89 3.344 3.89 1.76 0 2.86-1.034 3.043-2.5H25.02c-.184.808-.792 1.247-1.682 1.247-1.172 0-1.898-.994-1.898-2.637 0-1.61.72-2.583 1.898-2.583.942 0 1.518.555 1.681 1.281h1.368zM28.6 1.041v1.897h-1.133v1.178H28.6v4.281c0 1.432.622 2.007 2.186 2.007.275 0 .537-.034.766-.075V9.158c-.196.02-.32.034-.537.034-.7 0-1.008-.35-1.008-1.15V4.115h1.545V2.938h-1.545V1.041H28.6zm4.607 9.315h1.407V5.911c0-1.048.752-1.767 1.819-1.767.249 0 .667.048.785.082V2.842a3.372 3.372 0 00-.628-.054c-.93 0-1.721.527-1.924 1.26h-.105v-1.13h-1.354v7.438zm5.431 0h1.407V0h-1.407v10.356z" fill="#fff"/></svg></div></span><span class="g-screen-reader-only">K key</span><span aria-hidden="true" class="badge_root___Z7Nt badge_small__GI0Zk badge_filled-neutral-dark-mode__VC3Ba command-bar-activator_keyBadge__xnKpi"><div class="k-icon_root__a_5pR"><svg width="8" height="10" viewBox="0 0 8 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.512 9.84v-3l.986-1.147L5.445 9.84h1.704L3.46 4.745 6.857.84H5.244L1.61 5.094h-.098V.84H.15v9h1.363z" fill="#fff"/></svg></div></span></span></button><div class="navigation-header_authenticationControls__EP1LY"><div class="disclosure_root__rcBaW dropdown-disclosure_root__pzZlN dropdown-disclosure_list-position--right__WP_Kj"><button aria-controls="disclosure-react-aria-28-content" aria-expanded="false" aria-label="User menu" class="disclosure_activator__pORI0 activator_root__pOfAQ dropdown-disclosure_activator__nGgNo navigation-header_userDropdownDisclosureActivator__RayIV g-focus-ring-from-box-shadow-dark activator_hasIcon__5HO6W g-focus-ring-from-box-shadow"><span class="activator_childrenWrapper__kaK0w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path fill-rule="evenodd" d="M12 3a5 5 0 100 10 5 5 0 000-10zM8.5 8a3.5 3.5 0 117 0 3.5 3.5 0 01-7 0z" clip-rule="evenodd"></path><path d="M7.75 14.5A4.75 4.75 0 003 19.25v1a.75.75 0 001.5 0v-1A3.25 3.25 0 017.75 16h8.5a3.25 3.25 0 013.25 3.25v1a.75.75 0 001.5 0v-1a4.75 4.75 0 00-4.75-4.75h-8.5z"></path></g></svg></span><span class="activator_chevronWrapper__4_AVG"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></span></button><div class="disclosure_contentContainer__QQ4kt dropdown-disclosure_content__ZZRPG undefined" id="disclosure-react-aria-28-content"><ul class="dropdown-disclosure_list__urBXU"><li class="list-item_root__ZdUej"><button class="list-item_button__nXy5K g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign in</span></button></li><li class="list-item_root__ZdUej"><a class="list-item_link__l6lDd g-focus-ring-from-box-shadow" href="/hashicorp-terraform/sign-up"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-medium">Sign up</span></a></li><li class="list-item_root__ZdUej"><hr class="list-item_separator__cBVLs"/></li><li class="list-item_root__ZdUej user-dropdown-switcher_listItem__Q_GIj hds-font-weight-medium"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-30">Theme</label></li></ul></div></div></div><button aria-label="Open navigation menu" class="navigation-header_mobileMenuButton__74S4w"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-hidden="true"><g fill="currentColor"><path d="M2 5.75A.75.75 0 012.75 5h18.5a.75.75 0 010 1.5H2.75A.75.75 0 012 5.75zM2 11.75a.75.75 0 01.75-.75h18.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2.75 17a.75.75 0 000 1.5h18.5a.75.75 0 000-1.5H2.75z"></path></g></svg></button></div></header></div><div class="base-layout_contentArea__BMvQn"><div class="sidebar-sidecar-layout_root__h5rD8 sidebar-sidecar-layout_mainWidth-narrow__FhCbs"><div class="mobile-menu-container_root__fPUFu sidebar-sidecar-layout_sidebarContainer__4fcF8"><div class="sidebar-sidecar-layout_sidebarContentWrapper__ftn5q"><div class="sidebar_sidebar___fTlC"><div class="sidebar_backToLinkWrapper__F6iLs"><div class="sidebar-back-to-link_root__z_Hj1"><a class="standalone-link_standaloneLink__ahuej g-focus-ring-from-box-shadow standalone-link_primary__ESNCA" data-heap-track="standalone-link sidebar-back-to-link" href="/hashicorp-terraform/terraform"><div class="standalone-link_standaloneLinkContents__4I2XN standalone-link_medium__J2yVM"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M10.795 3.235a.75.75 0 01-.03 1.06L6.842 8l3.923 3.705a.75.75 0 01-1.03 1.09l-4.5-4.25a.75.75 0 010-1.09l4.5-4.25a.75.75 0 011.06.03z" clip-rule="evenodd"></path></svg><span class="standalone-link_text__7GEyG">Terraform Home</span></div></a></div></div><div class="sidebar_filterInputWrapper__0_l_Y"><div class="filter-input_filterInputContainer__thZt3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="filter-input_filterIcon__UET0p filter-input_sharedIconColorAndPositioning__hXPit"><g fill="currentColor"><path d="M1 3.75A.75.75 0 011.75 3h12.5a.75.75 0 010 1.5H1.75A.75.75 0 011 3.75zM3.5 7.75A.75.75 0 014.25 7h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 01-.75-.75zM6.75 11a.75.75 0 000 1.5h2.5a.75.75 0 000-1.5h-2.5z"></path></g></svg><input class="filter-input_filterInput__hga4N g-focus-ring-from-box-shadow" placeholder="Filter sidebar" autoComplete="off" autoCorrect="off" autoCapitalize="none" spellcheck="false" value=""/></div></div><nav aria-labelledby="sidebar-label" class="sidebar_nav__IworY" id="sidebar-nav"><div class="g-screen-reader-only"><h2 class="sidebar-headings_root__tGfxC" id="sidebar-label">Configuration Language</h2></div><ul class="sidebar_navList__4Rg4g"><li><a class="sidebar-nav-highlight-item_root___pPhp g-focus-ring-from-box-shadow sidebar-nav-highlight-item_theme-terraform__LHqSi" href="/hashicorp-terraform/terraform/language"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="sidebar-nav-highlight-item_icon__G8JxG"><g fill="var(--token-color-terraform-brand)"><path d="M1 0v5.05l4.349 2.527V2.526L1 0zM10.175 5.344l-4.35-2.525v5.05l4.35 2.527V5.344zM10.651 10.396V5.344L15 2.819v5.05l-4.349 2.527zM10.174 16l-4.349-2.526v-5.05l4.349 2.525V16z"></path></g></svg><span class="sidebar-nav-highlight-item_text__VORFJ hds-typography-body-200">Configuration Language</span></a></li><li id="sidebar-nav-item-2"><button aria-controls="sidebar-nav-item-2-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-2-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Files and Directories</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-7"><button aria-controls="sidebar-nav-item-7-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-7-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Syntax</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-12"><button aria-controls="sidebar-nav-item-12-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-12-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Resources</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-30"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/language/data-sources"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Data Sources</span></a></li><li id="sidebar-nav-item-31"><button aria-controls="sidebar-nav-item-31-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-31-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Providers</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-36"><button aria-controls="sidebar-nav-item-36-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-36-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Variables and Outputs</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-41"><button aria-controls="sidebar-nav-item-41-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-41-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Modules</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-57"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/language/checks"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Checks</span></a></li><li id="sidebar-nav-item-58"><button aria-controls="sidebar-nav-item-58-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-58-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Import</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-61"><button aria-controls="sidebar-nav-item-61-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-61-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Expressions</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-75"><button aria-controls="sidebar-nav-item-75-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-75-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Functions</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-209"><button aria-controls="sidebar-nav-item-209-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-209-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Terraform Settings</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-226"><button aria-controls="sidebar-nav-item-226-list" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-226-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">State</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button></li><li id="sidebar-nav-item-236"><button aria-controls="sidebar-nav-item-236-list" aria-expanded="true" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" id="sidebar-nav-item-236-button" data-heap-track="sidebar-nav-submenu-button"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tests</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><path fill="currentColor" fill-rule="evenodd" d="M3.235 5.205a.75.75 0 011.06.03L8 9.158l3.705-3.923a.75.75 0 011.09 1.03l-4.25 4.5a.75.75 0 01-1.09 0l-4.25-4.5a.75.75 0 01.03-1.06z" clip-rule="evenodd"></path></svg></div></button><ul id="sidebar-nav-item-236-list"><li id="sidebar-nav-item-237"><a aria-current="page" class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/language/tests"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Overview</span></a></li><li id="sidebar-nav-item-238"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/language/tests/mocking"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Mocks</span></a></li></ul></li><li id="sidebar-nav-item-239"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/language/upgrade-guides"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Upgrading to Terraform v1.7</span></a></li><li id="sidebar-nav-item-240"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/language/v1-compatibility-promises"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">v1.x Compatibility Promises</span></a></li><li id="sidebar-nav-item-241"><hr class="sidebar-horizontal-rule_root__UY7oh"/></li><li id="sidebar-nav-item-242"><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/terraform/internals"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Terraform Internals</span></a></li></ul><hr class="sidebar-horizontal-rule_root__UY7oh"/><ul class="sidebar_navList__4Rg4g"><li><h3 class="sidebar-headings_root__tGfxC">Resources</h3></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/tutorials/library?product=terraform"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Tutorial Library</span></a></li><li><a class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" href="/hashicorp-terraform/certifications/infrastructure-automation"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Certifications</span></a></li><li><a aria-label="Community Forum. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-42" target="_blank" href="https://discuss.hashicorp.com/c/terraform-core/27"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Community Forum</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-42">(opens in new tab)</span></li><li><a aria-label="Support. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-43" target="_blank" href="https://www.hashicorp.com/customer-success"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Support</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-43">(opens in new tab)</span></li><li><a aria-label="GitHub. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-44" target="_blank" href="https://github.com/hashicorp/terraform"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">GitHub</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-44">(opens in new tab)</span></li><li><a aria-label="Terraform Registry. Opens in a new tab." class="sidebar-nav-menu-item_sidebarNavMenuItem__PiyI8 g-focus-ring-from-box-shadow" data-heap-track="sidebar-nav-link-item" rel="noreferrer noopener" aria-describedby="undefinedopens-in-new-tab-label-react-aria-45" target="_blank" href="https://registry.terraform.io/"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular sidebar-nav-menu-item_navMenuItemLabel__tJHwX">Terraform Registry</span><div class="sidebar-nav-menu-item_rightIconsContainer__hynke"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></div></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-45">(opens in new tab)</span></li></ul></nav></div></div></div><div class="sidebar-sidecar-layout_contentWrapper__Z5BK4"><div class="sidebar-sidecar-layout_paddedAreaWrapper___S_Ff"><div class="sidebar-sidecar-layout_breadcrumbContainer__3uz7P"><div class="sidebar-sidecar-layout_breadcrumbMaxWidth__coOcu"><nav aria-label="Breadcrumb" class="breadcrumb-bar_root__wd_C5"><ol class="breadcrumb-bar_listRoot__8eupO"><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-terraform">Developer</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-terraform/terraform">Terraform</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><a class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" data-heap-track="breadcrumb-bar-item" href="/hashicorp-terraform/terraform/language">Configuration Language</a></li><li class="text_root__r0DFB hds-typography-body-100 hds-font-weight-medium breadcrumb-bar_listItem__2sevd"><span class="breadcrumb-bar_breadcrumbText__JvOrd g-focus-ring-from-box-shadow" aria-current="page" data-heap-track="breadcrumb-bar-item">Tests</span></li></ol></nav></div></div><div class="sidebar-sidecar-layout_mainAndSidecar__UDm3Z"><main id="main" class="sidebar-sidecar-layout_main__0SN51"><div class="docs-page-heading_root__QuBg_ docs-view_docsPageHeading___xkrK"><div class="docs-page-heading_pageHeadingWrapper__LEMQ7"><h1 class="hds-typography-display-600 hds-font-weight-bold docs-plain-page-heading_root__HzRuX g-offset-scroll-margin-top" id="tests">Tests</h1></div></div><div class="dev-dot-content_root__UJDct hds-typography-body-300"><div class="docs-view_mdxContent___uMnx"><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> This testing framework is available in Terraform v1.6.0 and later.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Terraform tests let authors validate that module configuration updates do not introduce breaking changes. Tests run against test-specific, short-lived resources, preventing any risk to your existing infrastructure or state.</p><h2 id="integration-or-unit-testing" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="integration or unit testing permalink" href="/hashicorp-terraform/terraform/language/tests#integration-or-unit-testing"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Integration or Unit testing</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">By default, tests within Terraform create real infrastructure and can run assertions and validations against that infrastructure. This is analogous to integration testing because you are testing Terraform&#x27;s core functionality by executing operations and validating the infrastructure Terraform creates.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You can override the normal testing behavior by updating the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code> attribute within a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#run-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code></a> block (examples below). By default, each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block executes with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = apply</code> instructing Terraform to execute a complete <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">apply</code> operation against your configuration. Replacing the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code> value with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = plan</code> instructs Terraform to <em>not</em> create new infrastructure for this <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block. This allows test authors to validate logical operations and custom conditions within their infrastructure in a process analogous to unit testing.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Terraform v1.7.0 introduced the ability to mock data returned by the providers during a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">terraform test</code> execution. This can be used to write more detailed and complete unit tests.</p><h2 id="syntax" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="syntax permalink" href="/hashicorp-terraform/terraform/language/tests#syntax"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Syntax</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Each Terraform test lives in a test file. Terraform discovers test files are based on their file extension: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">.tftest.hcl</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">.tftest.json</code>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Each test file contains the following root level attributes and blocks:</p><ul class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">One to many <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#run-blocks"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code></a> blocks.</li><li class="mdx-lists_listItem__nkqhg">Zero to one <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#variables"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code></a> block.</li><li class="mdx-lists_listItem__nkqhg">Zero to many <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#providers"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code></a> blocks.</li></ul><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Terraform executes <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks in order, simulating a series of Terraform commands executing directly within the configuration directory. The order of the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code> blocks doesn&#x27;t matter, Terraform processes all the values within these blocks at the beginning of the test operation. We recommend defining your <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code> blocks first, at the beginning of the test file.</p><h3 id="example" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="example permalink" href="/hashicorp-terraform/terraform/language/tests#example"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Example</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following example demonstrates a simple Terraform configuration that creates an AWS S3 bucket, using an input variable to modify the name. We will create an example test file (below) that validates the buckets name is created as expected.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;eu-central-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket_prefix&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">bucket_prefix</span><span class="token punctuation">}</span></span>-bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">output<span class="token type variable"> &quot;bucket_name&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">value</span> <span class="token punctuation">=</span> aws_s3_bucket.bucket.bucket<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following test file runs a single Terraform <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan</code> command which creates the S3 bucket, and then validates the logic for calculating the name is correct by checking the actual name matches the expected name.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># valid_string_concat.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket_prefix</span> <span class="token punctuation">=</span> <span class="token string">&quot;test&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;valid_string_concat&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;S3 bucket name did not match expected&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h2 id="run-blocks" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="run blocks permalink" href="/hashicorp-terraform/terraform/language/tests#run-blocks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Run blocks</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block has the following fields and blocks:</p><div class="mdx-table_root__adKqa"><div class="mdx-table_tableWrapper__81O9J"><table><thead><tr><th>Field or Block Name</th><th>Description</th><th>Default Value</th></tr></thead><tbody><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code></td><td>An optional attribute, which is either <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">apply</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan</code>.</td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">apply</code></td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options.mode</code></td><td>An optional attribute, which is either <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">normal</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">refresh-only</code>.</td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">normal</code></td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options.refresh</code></td><td>An optional boolean attribute.</td><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">true</code></td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options.replace</code></td><td>An optional attribute containing a list of resource addresses referencing resources within the configuration under test.</td><td></td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options.target</code></td><td>An optional attribute containing a list of resource addresses referencing resources within the configuration under test.</td><td></td></tr><tr><td><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#variables"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code></a></td><td>An optional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code> block.</td><td></td></tr><tr><td><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#modules"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code></a></td><td>An optional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code> block.</td><td></td></tr><tr><td><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#providers"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">providers</code></a></td><td>An optional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">providers</code> attribute.</td><td></td></tr><tr><td><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#assertions"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">assert</code></a></td><td>Optional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">assert</code> blocks.</td><td></td></tr><tr><td><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code></td><td>An optional attribute.</td><td></td></tr></tbody></table></div><div class="mdx-table_tableFocusRing__qNrYf"></div><div><div class="mdx-table_leftScrim__mYsmq mdx-table_scrim__VtktE"></div><div class="mdx-table_rightScrim__Ikt63 mdx-table_scrim__VtktE"></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code> attribute and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options</code> block tell Terraform which command and options to execute for each run block. The default operation, if you do not specify a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code> attribute or the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options</code> block, is a normal Terraform apply operation.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code> attribute states whether the operation should be a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/cli/commands/plan"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan</code></a> or an <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/cli/commands/apply"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">apply</code></a> operation.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">plan_options</code> block allows test authors to customize the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/cli/commands/plan#planning-modes">planning mode</a> and <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/cli/commands/plan#planning-options">options</a> they would typically need to edit via command-line flags and options. We cover the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-var</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-var-file</code> options in the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#variables">Variables</a> section.</p><h3 id="assertions" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="assertions permalink" href="/hashicorp-terraform/terraform/language/tests#assertions"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Assertions</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Terraform run block assertions are <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/expressions/custom-conditions">Custom Conditions</a>, consisting of a <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/expressions/custom-conditions#condition-expressions">condition</a> and an <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/expressions/custom-conditions#error-messages">error message</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">At the conclusion of a Terraform test command execution, Terraform presents any failed assertions as part of a tests passed or failed status.</p><h4 id="assertion-references" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="assertion references permalink" href="/hashicorp-terraform/terraform/language/tests#assertion-references"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Assertion References</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Assertions within tests can reference any existing <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/expressions/references">named values</a> that are available to other custom conditions within the main Terraform configuration.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Additionally, test assertions can directly reference outputs from current and previous <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks. Pulling from the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#example">previous example</a>, this is a valid condition: <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">condition = output.bucket_name == &quot;test_bucket&quot;</code>.</p><h2 id="variables" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="variables permalink" href="/hashicorp-terraform/terraform/language/tests#variables"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Variables</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You can provide values for <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/values/variables">Input Variables</a> within your configuration directly from your test files.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The test file syntax supports <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code> blocks at both the root level and within <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks. Terraform passes all variable values from the test file into all <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks within the file. You can override variable values for a particular <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block with values provided directly within that <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Adding to the test file from the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#example">example</a> above:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># variable_precedence.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket_prefix</span> <span class="token punctuation">=</span> <span class="token string">&quot;test&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;uses_root_level_value&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;S3 bucket name did not match expected&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;overrides_root_level_value&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">bucket_prefix</span> <span class="token punctuation">=</span> <span class="token string">&quot;other&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;other-bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;S3 bucket name did not match expected&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">We&#x27;ve added a second <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block that specifies the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">bucket_prefix</code> variable value as <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">other</code>, overriding the value <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">test</code> that is provided by the test file and used during the first <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block.</p><h3 id="specify-variables-with-the-command-line-or-definition-files" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="specify variables with the command line or definition files permalink" href="/hashicorp-terraform/terraform/language/tests#specify-variables-with-the-command-line-or-definition-files"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Specify variables with the Command Line or definition files</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In addition to specifying variable values via test files, the Terraform <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">test</code> command also supports the other typical mechanisms for specifying variable values.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You can specify values for variables across all tests with the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/values/variables#variables-on-the-command-line">Command Line</a> and with <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/values/variables#variable-definitions-tfvars-files">Variable Definition Files</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">As with the main configuration direction, Terraform will automatically load any variables defined in the automatic variable files within a test directory. The automatic variable files are <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">terraform.tfvars</code>, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">terraform.tfvars.json</code>, and any files that end with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">.auto.tfvars</code> or <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">.auto.tfvars.json</code>.</p><div class="alert alert-info g-type-body"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> Variable values loaded from the automatic variable files within a test directory will only apply to tests also defined within the same test directory. Variables defined in all other ways will apply to all tests in a given test run.</p></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is particularly useful for using sensitive variables values and for configuring providers. Otherwise, testing files could directly expose those sensitive values.</p><h3 id="variable-definition-precedence" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="variable definition precedence permalink" href="/hashicorp-terraform/terraform/language/tests#variable-definition-precedence"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Variable definition precedence</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/values/variables#variable-definition-precedence">Variable Definition Precedence</a> remains the same within tests, except for variable values that test files provide. The variables defined in test files take the highest precedence, overriding environment variables, variables files, or command-line input.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">For tests defined in a test directory, any variable values defined in automatic variable files from the test directory will override values defined in automatic variable files from the main configuration directory.</p><h3 id="variable-references" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="variable references permalink" href="/hashicorp-terraform/terraform/language/tests#variable-references"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Variable References</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Variables you define within <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks can refer to outputs from modules executed in earlier <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks and variables defined at higher precedence levels. Variables defined within the file level <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">variables</code> block can only refer to global variables.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">For example, the following code block shows how a variable can refer to higher precedence variables and previous run blocks:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">global_value</span> <span class="token punctuation">=</span> <span class="token string">&quot;some value&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;run_block_one&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">local_value</span> <span class="token punctuation">=</span> var.global_value<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># Some test assertions should go here.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;run_block_two&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">local_value</span> <span class="token punctuation">=</span> run.run_block_one.output_one<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># Some test assertions should go here.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Above, the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">local_value</code> in <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_block_one</code> gets its value from the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">global_value</code> variable. This pattern is useful if you want to assign multiple variables the same value. You can specify a variable value once at the file level and then share it with different variables.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In comparison, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">local_value</code> in <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_block_two</code> takes its value from the output value of <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">output_one</code> from <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run_block_one</code>. This pattern is useful for passing values between <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks, particularly if <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks are executing different modules as detailed in the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#modules">Modules</a> section.</p><h2 id="providers" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="providers permalink" href="/hashicorp-terraform/terraform/language/tests#providers"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Providers</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You can set or override the required providers within the main configuration from your testing files by using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code> and <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">providers</code> blocks and attributes.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">At the root level of a Terraform testing file, you can define <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/providers/configuration"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code> blocks</a> as if Terraform were creating them <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/providers">within the main configuration</a>. Terraform will then pass these provider blocks into its configuration as each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block executes.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">By default, each provider you specify is directly available within each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block. You can customize the availability of providers within a given <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block by using a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">providers</code> attribute. The behavior and syntax for this block match the behavior of <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/meta-arguments/module-providers">providers meta-argument</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If you do not provide provider configuration within a testing file, Terraform attempts to initialize any providers within its configuration using the provider&#x27;s default settings. For example, any environment variables aimed at configuring providers are still available, and Terraform can use them to create default providers.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Below, we expand on our previous <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#example">example</a> to allow tests, instead of the configuration, to specify the region. In this example, we are going to test the following configuration file:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">terraform</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">required_providers</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">aws</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;hashicorp/aws&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket_prefix&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">bucket_prefix</span><span class="token punctuation">}</span></span>-bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">output<span class="token type variable"> &quot;bucket_name&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">value</span> <span class="token punctuation">=</span> aws_s3_bucket.bucket.bucket<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">We can now define our <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code> blocks within the following test file:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># customised_provider.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;eu-central-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket_prefix</span> <span class="token punctuation">=</span> <span class="token string">&quot;test&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;valid_string_concat&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;S3 bucket name did not match expected&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">We can also create a more complex example configuration, that makes use of multiple providers and aliases:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">terraform</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">required_providers</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">aws</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">source</span>                <span class="token punctuation">=</span> <span class="token string">&quot;hashicorp/aws&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">configuration_aliases</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>aws.secondary<span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket_prefix&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">default</span> <span class="token punctuation">=</span> <span class="token string">&quot;test&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span>    <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;primary_bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">bucket_prefix</span><span class="token punctuation">}</span></span>-primary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;secondary_bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">provider</span> <span class="token punctuation">=</span> aws.secondary<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span>   <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">bucket_prefix</span><span class="token punctuation">}</span></span>-secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Within our test file we can specify multiple providers:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># customised_providers.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-east-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">alias</span>  <span class="token punctuation">=</span> <span class="token string">&quot;secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;eu-central-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;providers&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.primary_bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-primary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;invalid value for primary S3 bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.secondary_bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;invalid value for secondary S3 bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">It is also possible to define specific providers you want to use in specific <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">terraform</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">required_providers</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">aws</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">source</span>                <span class="token punctuation">=</span> <span class="token string">&quot;hashicorp/aws&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">      <span class="token property">configuration_aliases</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>aws.secondary<span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">data <span class="token type variable">&quot;aws_region&quot;</span></span> <span class="token string">&quot;primary&quot;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">data <span class="token type variable">&quot;aws_region&quot;</span></span> <span class="token string">&quot;secondary&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">provider</span> <span class="token punctuation">=</span> aws.secondary<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket_prefix&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">default</span> <span class="token punctuation">=</span> <span class="token string">&quot;test&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span>    <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;primary_bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">bucket_prefix</span><span class="token punctuation">}</span></span>-<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">data</span><span class="token punctuation">.</span><span class="token type variable">aws_region</span><span class="token punctuation">.</span>primary<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span>-primary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;secondary_bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">provider</span> <span class="token punctuation">=</span> aws.secondary<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span>   <span class="token punctuation">=</span> <span class="token string">&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">bucket_prefix</span><span class="token punctuation">}</span></span>-<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">data</span><span class="token punctuation">.</span><span class="token type variable">aws_region</span><span class="token punctuation">.</span>secondary<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span>-secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Our test file can pass in specific providers for each different <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block:</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># customised_providers.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-east-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">alias</span>  <span class="token punctuation">=</span> <span class="token string">&quot;secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;eu-central-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">alias</span>  <span class="token punctuation">=</span> <span class="token string">&quot;tertiary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;eu-west-2&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;default_providers&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.primary_bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-us-east-1-primary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;invalid value for primary S3 bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.secondary_bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-eu-central-1-secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;invalid value for secondary S3 bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;customised_providers&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">providers</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">aws</span>           <span class="token punctuation">=</span> aws<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">aws.secondary</span> <span class="token punctuation">=</span> aws.tertiary<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.primary_bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-us-east-1-primary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;invalid value for primary S3 bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span>     <span class="token punctuation">=</span> aws_s3_bucket.secondary_bucket.bucket <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token string">&quot;test-eu-west-2-secondary&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;invalid value for secondary S3 bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><blockquote class="mdx-blockquote_blockquote__h7k9H"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> When running tests with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = apply</code>, switching providers between <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks can result in failed operations and tests because resources created by one provider definition will be unusable when modified by a second.</p></blockquote><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">From Terraform v1.7.0, <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">provider</code> blocks can also reference test file variables and run block outputs. This means the testing framework can retrieve credentials and other setup information from one provider and use this when initializing a second.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In the following example, the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">vault</code> provider is initialized first, and then used within a setup module to extract credentials for the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">aws</code> provider. For more information on setup modules, see <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#modules">Modules</a>.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;vault&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ... vault configuration ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span>     <span class="token punctuation">=</span> <span class="token string">&quot;us-east-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># The `aws` provider can reference the outputs of the &quot;vault_setup&quot; run block.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">access_key</span> <span class="token punctuation">=</span> run.vault_setup.aws_access_key<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">secret_key</span> <span class="token punctuation">=</span> run.vault_setup.aws_secret_key<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;vault_setup&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">module</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># This module should only include reference to the Vault provider. Terraform</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># will automatically work out which providers to supply based on the module</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># configuration. The tests will error if a run block requires access to a</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># provider that references outputs from a run block that has not executed.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;./testing/vault-setup&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;use_aws_provider&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># This run block can then use both the `aws` and `vault` providers, as the</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># previous run block provided all the data required for the `aws` provider.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h2 id="modules" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="modules permalink" href="/hashicorp-terraform/terraform/language/tests#modules"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Modules</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You can modify the module that a given <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block executes.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">By default, Terraform executes the given command against the configuration being tested for each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block. Terraform tests the configuration within the directory you execute the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">terraform test</code> command from (or the directory you point to with the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">-chdir</code> argument). Each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block also allows the user to change the targeted configuration using the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code> block.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Unlike the traditional <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/modules/syntax"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code> block</a>, the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code> block within test files <em>only</em> supports the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/modules/syntax#source"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source</code></a> attribute and the <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/modules/syntax#version"><code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">version</code></a> attribute. The remaining attributes that are typically supplied via the traditional <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code> block should be supplied by the alternate attributes and blocks within the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block.</p><blockquote class="mdx-blockquote_blockquote__h7k9H"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note:</strong> Terraform test files only support <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/modules/sources#local-paths">local</a> and <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/modules/sources#terraform-registry">registry</a> modules within the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">source</code> attribute.</p></blockquote><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">All other blocks and attributes within the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block are supported when executing an alternate module, with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">assert</code> blocks executing against values from the alternate module. This is discussed more in <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#modules-state">Modules State</a>.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Two example use cases for the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">modules</code> block within a testing file are:</p><ol class="mdx-lists_listRoot__iVDx9"><li class="mdx-lists_listItem__nkqhg">A setup module that creates the infrastructure the main configuration requires for testing.</li><li class="mdx-lists_listItem__nkqhg">A loading module to load and validate secondary infrastructure (such as data sources) that are not created directly by the main configuration being tested.</li></ol><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following examples demonstrate both of these use cases.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">First, we have a module that will create and load several files into an already created S3 bucket. This is the configuration we want to test.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;files&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> map(string)<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">data <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> var.bucket<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_object&quot;</span></span> <span class="token string">&quot;object&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">for_each</span> <span class="token punctuation">=</span> var.files<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> data.aws_s3_bucket.bucket.id<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">key</span> <span class="token punctuation">=</span> each.key<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">source</span> <span class="token punctuation">=</span> each.value<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">etag</span> <span class="token punctuation">=</span> filemd5(each.value)<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Second, we have a setup module that will create the S3 bucket, so it is available to the configuration under test.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># testing/setup/main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">resource <span class="token type variable">&quot;aws_s3_bucket&quot;</span></span> <span class="token string">&quot;bucket&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> var.bucket<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Third, we have a loading module, that will load the files in the s3 bucket. This is a fairly contrived example, as it is definitely possible just to validate the files directly when they are created in the module under test. It is, however, good for demonstrating the use case.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># testing/loader/main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;bucket&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> string<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">data <span class="token type variable">&quot;aws_s3_objects&quot;</span></span> <span class="token string">&quot;objects&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> var.bucket<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Finally, we have the test file itself which configures everything and calls out to the various helper modules we have created.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># file_count.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">bucket</span> <span class="token punctuation">=</span> <span class="token string">&quot;my_test_bucket&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">files</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;file-one.txt&quot;</span>: <span class="token string">&quot;data/files/file_one.txt&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">&quot;file-two.txt&quot;</span>: <span class="token string">&quot;data/files/file_two.txt&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">provider<span class="token type variable"> &quot;aws&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">region</span> <span class="token punctuation">=</span> <span class="token string">&quot;us-east-1&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;setup&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># Create the S3 bucket we will use later.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">module</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;./testing/setup&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;execute&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># This is empty, we just run the configuration under test using all the default settings.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;verify&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># Load and count the objects created in the &quot;execute&quot; run block.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">module</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;./testing/loader&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span> <span class="token punctuation">=</span> length(data.aws_s3_objects.objects.keys) <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token number">2</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;created the wrong number of s3 objects&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h3 id="modules-state" class="hds-typography-display-400 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h3__xmS_z"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h3__SkrrS" aria-label="modules state permalink" href="/hashicorp-terraform/terraform/language/tests#modules-state"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Modules state</h3><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">While Terraform executes a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">terraform test</code> command, Terraform maintains at least one, but possibly many, state files within memory for each test file.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">There is always at least one state file that maintains the state of the main configuration under test. This state file is shared by all <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks that do not have a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">module</code> block specifying an alternate module to load.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Additionally, there is one state file per alternate module that Terraform loads. An alternate module state file is shared by all <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks that execute the given module.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The Terraform team is interested in any use cases requiring manual state management or the ability to execute different configurations against the same state within the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">test</code> command. If you have a use case, please file an <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="https://github.com/hashicorp/terraform/issues/new/choose">issue</a> and share it with us.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The following example uses comments to explain where the state files for each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block originate. In the below example Terraform creates and manages a total of three state files. The first state file is for the main configuration under test, the second for the setup module, and the third for the loader module.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;setup&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># This run block references an alternate module and is the first run block</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># to reference this particular alternate module. Therefore, Terraform creates</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># and populates a new empty state file for this run block.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">module</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;./testing/setup&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;init&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># This run block does not reference an alternate module, so it uses the main</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># state file for the configuration under test. As this is the first run block</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># to reference the main configuration, the previously empty state file now</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># contains the resources created by this run block.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">assert</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># In practice we&#x27;d do some interesting checks and tests here but the</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># assertions aren&#x27;t important for this example.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ... more assertions ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;update_setup&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># We&#x27;ve now re-referenced the setup module, so the state file that was created</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># for the first &quot;setup&quot; run block will be reused. It will contain any</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># resources that were created as part of the other run block before this run</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># block executes and will be updated with any changes made by this run block</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># after.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">module</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;./testing/setup&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># In practice, we&#x27;d likely make some changes to the module compared to the</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># first run block here. Otherwise, there would be no point recalling the</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token comment"># module.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;update&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># As with the &quot;init&quot; run block, we are executing against the main configuration</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># again. This means we&#x27;d load the main state file that was initially populated</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># by the &quot;init&quot; run block, and any changes made by this &quot;run&quot; block will be</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># carried forward to any future run blocks that execute against the main</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># configuration.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ... updated variables ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># ... assertions ...</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;loader&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># This run block is now referencing our second alternate module so will create</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># our third and final state file. The other two state files are managing</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># resources from the main configuration and resources from the setup module.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># We are getting a new state file for this run block as the loader module has</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># not previously been referenced by any run blocks.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">module</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">source</span> <span class="token punctuation">=</span> <span class="token string">&quot;./testing/loader&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><h4 id="modules-cleanup" class="hds-typography-display-300 hds-font-weight-semibold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h4__v7716"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow" aria-label="modules cleanup permalink" href="/hashicorp-terraform/terraform/language/tests#modules-cleanup"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Modules Cleanup</h4><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">At the conclusion of a test file, Terraform attempts to destroy every resource it created during the execution of that test file. When Terraform loads alternate modules, the order in which Terraform destroys those objects in is important. For example, in the first <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#modules">Modules</a> example, Terraform could not destroy the resources created in the &quot;setup&quot; <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block before the objects created in the &quot;execute&quot; <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block, because the S3 bucket we created in the &quot;setup&quot; step can not be destroyed while it contains objects.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Terraform destroys resources in reverse <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block order. In the most recent <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/tests#modules-state">example</a>, there are three state files. One for the main state, one for the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">./testing/loader</code> module, and one for the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">./testing/setup</code> module. The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">./testing/loader</code> state file would be destroyed first as it was referenced most recently by the last run block. The main state file would be destroyed second as it was referenced by the &quot;update&quot; <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block. The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">./testing/setup</code> state file would then be destroyed last.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Note, that the first two <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks &quot;setup&quot; and &quot;init&quot;, do nothing during the destroy operations as their state files are used by later run blocks and have already been destroyed.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">If you use a single setup module as an alternate module, and it executes first, or you use no alternate modules, then the order of destruction does not affect you. Anything more complex may require careful consideration to make sure the destruction of resources can complete automatically.</p><h2 id="expecting-failures" class="hds-typography-display-500 hds-font-weight-bold mdx-headings_heading__M6qPe g-offset-scroll-margin-top mdx-headings_h2__9ZcX_"><a class="mdx-heading-permalink_root__2oeix g-focus-ring-from-box-shadow mdx-heading-permalink_h2__CA9g8" aria-label="expecting failures permalink" href="/hashicorp-terraform/terraform/language/tests#expecting-failures"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="mdx-heading-permalink_icon__Sz01O"><g fill="currentColor"><path d="M11.141 1a3.893 3.893 0 00-2.738 1.093L7.314 3.175A.75.75 0 008.372 4.24l1.077-1.07a2.393 2.393 0 013.384 3.382l-1.881 1.88a2.393 2.393 0 01-3.608-.258.75.75 0 00-1.202.899 3.893 3.893 0 005.87.42l1.886-1.886.01-.009A3.893 3.893 0 0011.14 1z"></path><path d="M7.019 5.365a3.893 3.893 0 00-3.032 1.13L2.102 8.382l-.01.01a3.893 3.893 0 005.505 5.504l1.084-1.084a.75.75 0 00-1.06-1.06l-1.07 1.07a2.393 2.393 0 01-3.384-3.384l1.881-1.88a2.393 2.393 0 013.609.258.75.75 0 101.2-.899A3.893 3.893 0 007.02 5.365z"></path></g></svg></a>Expecting failures</h2><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">By default, if any <a class="inline-link_root__iIql6 g-focus-ring-from-box-shadow hds-typography-body-300 hds-font-weight-regular inline-link_primary__kGJLJ" href="/hashicorp-terraform/terraform/language/expressions/custom-conditions">Custom Conditions</a>, including <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">check</code> block assertions, fail during the execution of a Terraform test file then the overall command reports the test as a failure.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">However, it is a common testing paradigm to want to test failure cases. Terraform supports the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> attribute for this use case.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">In each <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> attribute can provide a list of checkable objects (resources, data sources, check blocks, input variables, and outputs) that should fail their custom conditions. The test passes if the checkable objects you specify report an issue, and the test fails overall if they do not.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">You can still write assertions alongside an <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> block, but you should be mindful that all custom conditions, except check block assertions, halt the execution of Terraform. This still applies during test execution, so your assertions should only consider values that you are sure will be computed before the checkable object is due to fail. You can manage this using references, or the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">depends_on</code> meta-argument within your main configuration.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This also means that, with the exception of <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">check</code> blocks, you can only reliably include a single checkable object. We support a list of checkable objects within the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> attribute purely for <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">check</code> blocks.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">A quick example below demonstrates testing the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">validation</code> block on an input variable. The configuration file accepts a single input variable that must be even number.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># main.tf</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variable<span class="token type variable"> &quot;input&quot; </span></span><span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">type</span> <span class="token punctuation">=</span> number<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">validation</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">condition</span> <span class="token punctuation">=</span> var.input % <span class="token number">2</span> <span class="token punctuation">=</span><span class="token punctuation">=</span> <span class="token number">0</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">error_message</span> <span class="token punctuation">=</span> <span class="token string">&quot;must be even number&quot;</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The test file contains two run blocks. One that validates that our custom condition passes on an even number and one that validates our custom condition fails on an odd number.</p><div class="g-code-block style_root__i1k0c language-hcl mdx-code-blocks_codeBlockMargin__xk4yr style_codeMargin__flyZr theme-dark_base__RNsat theme-dark_syntax__QCDzs" data-heap-track="code-block"><div class="style_linesContainer__4N_nq"><pre class="code-lines_pre__t8gY5 language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><code class="code-lines_code__luWmT language-hcl mdx-code-blocks_codeBlockMargin__xk4yr"><span class="code-lines_linesColumn__M9Wn1 code-lines_styledScrollbars__37_Kl"><span class="code-lines_linesScrollableContent__UNs3H"><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token comment"># input_validation.tftest.hcl</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">input</span> <span class="token punctuation">=</span> <span class="token number">0</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;zero&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># The variable defined above is even, so we expect the validation to pass.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">run <span class="token string">&quot;one&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token comment"># This time we set the variable is odd, so we expect the validation to fail.</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">command</span> <span class="token punctuation">=</span> plan<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token keyword">variables</span> <span class="token punctuation">{</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    <span class="token property">input</span> <span class="token punctuation">=</span> <span class="token number">1</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">}</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token property">expect_failures</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">    var.input,<!-- -->
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ">  <span class="token punctuation">]</span>
</span><span class="code-lines_LineOfCode__6Kf_L g-type-code code-lines_padRight__5afwQ"><span class="token punctuation">}</span>
</span></span></span></code></pre><div class="style_copyButtonContainer__yxcuf"><button class="style_button__8j_Rk" data-heap-track="code-block-clipboard-icon" type="button">Copy<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="style_svg__gtvGZ"><g fill="currentColor"><path d="M2.25 0A2.25 2.25 0 000 2.25v7.5A2.25 2.25 0 002.25 12h.25a.75.75 0 000-1.5h-.25a.75.75 0 01-.75-.75v-7.5a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v.25a.75.75 0 001.5 0v-.25A2.25 2.25 0 009.75 0h-7.5z"></path><path fill-rule="evenodd" d="M6.25 4A2.25 2.25 0 004 6.25v7.5A2.25 2.25 0 006.25 16h7.5A2.25 2.25 0 0016 13.75v-7.5A2.25 2.25 0 0013.75 4h-7.5zM5.5 6.25a.75.75 0 01.75-.75h7.5a.75.75 0 01.75.75v7.5a.75.75 0 01-.75.75h-7.5a.75.75 0 01-.75-.75v-7.5z" clip-rule="evenodd"></path></g></svg></button></div></div></div><blockquote class="mdx-blockquote_blockquote__h7k9H"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note</strong>: Terraform only expects failures in the operation specified by the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command</code> attribute of the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block.</p></blockquote><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Be careful when using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> in <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> blocks with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = apply</code>. A <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block with <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = apply</code> that expects a custom condition failure will fail overall if that custom condition fails during the plan.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">This is logically consistent, as the <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">run</code> block is expecting to be able to run an apply operation but can not because the plan failed. It is also potentially confusing, as you will see the failure in the diagnostics as the reason the test failed, even though that failure was marked as being expected.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">There are instances when Terraform does not execute a custom condition during the planning stage, because that condition is relying on computed attributes that are only available after Terraform creates the referenced resource. In these cases, you could use an <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> block alongside a <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = apply</code> attribute and value. However, in most cases we recommend only using <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> alongside <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">command = plan</code> operations.</p><blockquote class="mdx-blockquote_blockquote__h7k9H"><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA"><strong>Note</strong>: Expected failures only apply to user-defined custom conditions.</p></blockquote><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">Other kinds of failure <em>besides</em> the specified expected failures in the checkable object still result in the overall test failing. For example, a variable that expects a boolean value as input fails the surrounding test if Terraform provides the wrong kind of value, even if that variable is included in an <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> attribute.</p><p class="text_root__r0DFB hds-typography-body-300 hds-font-weight-regular mdx-p_p__ZTJEA">The <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> attribute is included to allow authors to test their configuration and any logic defined within. A type mismatch, as in the previous example, is not something Terraform authors should have to worry about testing as Terraform itself will handle enforce type constraints. As such, you can only <code class="mdx-inline-code_inlineCode__p_0sy mdx-inline-code_size-200__YiF_7 hds-typography-code-200">expect_failures</code> in custom conditions.</p></div></div><a href="https://github.com/hashicorp/terraform/blob/main/website/../docs/language/tests/index.mdx" target="_blank" class="edit-on-github-link_editLink__AsG8Z sidebar-sidecar-layout_editOnGithubLink__SDraB" rel="noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true" class="edit-on-github-link_editLinkIcon__wMtY9"><path fill="currentColor" fill-rule="evenodd" d="M8 1C4.133 1 1 4.13 1 7.993c0 3.09 2.006 5.71 4.787 6.635.35.064.478-.152.478-.337 0-.166-.006-.606-.01-1.19-1.947.423-2.357-.937-2.357-.937-.319-.808-.778-1.023-.778-1.023-.635-.434.048-.425.048-.425.703.05 1.073.72 1.073.72.624 1.07 1.638.76 2.037.582.063-.452.244-.76.444-.935-1.554-.176-3.188-.776-3.188-3.456 0-.763.273-1.388.72-1.876-.072-.177-.312-.888.07-1.85 0 0 .586-.189 1.924.716A6.711 6.711 0 018 4.381c.595.003 1.194.08 1.753.236 1.336-.905 1.923-.717 1.923-.717.382.963.142 1.674.07 1.85.448.49.72 1.114.72 1.877 0 2.686-1.638 3.278-3.197 3.45.251.216.475.643.475 1.296 0 .934-.009 1.688-.009 1.918 0 .187.127.404.482.336A6.996 6.996 0 0015 7.993 6.997 6.997 0 008 1z" clip-rule="evenodd"></path></svg>Edit this page on GitHub</a></main><div class="sidebar-sidecar-layout_sidecarPosition__WtTq0"><div class="sidebar-sidecar-layout_sidecarTopSlot__qRAEI"></div><div class="sidecar-scroll-container_root__a8nIj"><div class="sidecar-scroll-container_scrollContainer__Dw9id"><div><nav aria-labelledby="react-aria-88"><p id="react-aria-88" class="outline-nav_navLabel__HrjQb hds-typography-body-100">On this page:</p><ol class="outline-nav_listRoot__Sm1fr"><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-0" href="/hashicorp-terraform/terraform/language/tests#tests">Tests</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-1" href="/hashicorp-terraform/terraform/language/tests#integration-or-unit-testing">Integration or Unit testing</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-2" href="/hashicorp-terraform/terraform/language/tests#syntax">Syntax</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-3" href="/hashicorp-terraform/terraform/language/tests#run-blocks">Run blocks</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-4" href="/hashicorp-terraform/terraform/language/tests#variables">Variables</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-5" href="/hashicorp-terraform/terraform/language/tests#providers">Providers</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-6" href="/hashicorp-terraform/terraform/language/tests#modules">Modules</a></li><li><a class="outline-link_root__S7fQg hds-typography-body-200 g-focus-ring-from-box-shadow" data-heap-track="toc-list-item-index-7" href="/hashicorp-terraform/terraform/language/tests#expecting-failures">Expecting failures</a></li></ol></nav></div></div></div></div></div></div></div></div></div><div class="base-layout_footer__HGqK8 base-layout_showFooterTopBorder__4_CwH"><footer class="footer_root__qJO_k"><span class="footer_logoAndSwitcher__CJkN3"><a href="https://www.hashicorp.com/" aria-label="Go to HashiCorp home page" class="footer_logo__pe9i3 g-focus-ring-from-box-shadow"><div><svg width="317" height="88" viewBox="0 0 317 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M107.692 64.421V47.4h-14.97v17.02h-7.623V24.06h7.622v16.602h14.971V24.06h7.622v40.36h-7.622zm35.567-.001h-6.053l-.548-1.996a16.137 16.137 0 01-8.789 2.607c-5.397 0-7.699-3.697-7.699-8.79 0-5.998 2.607-8.3 8.606-8.3h7.089v-3.095c0-3.27-.907-4.421-5.633-4.421a41.255 41.255 0 00-8.179.877l-.907-5.634a38.496 38.496 0 0110.122-1.395c9.269 0 11.998 3.27 11.998 10.672l-.007 19.476zm-7.394-11.151h-5.45c-2.424 0-3.087.663-3.087 2.912 0 2.058.663 2.973 2.972 2.973a11.629 11.629 0 005.572-1.525l-.007-4.36zm21.701 11.754a34.776 34.776 0 01-10.183-1.7l1.029-5.633a33.038 33.038 0 008.788 1.273c3.271 0 3.758-.762 3.758-2.973 0-1.814-.366-2.729-5.152-3.88-7.211-1.76-8.058-3.575-8.058-9.269 0-5.938 2.607-8.545 11.03-8.545 2.98.003 5.949.348 8.85 1.03l-.762 5.876a51.98 51.98 0 00-8.118-.846c-3.209 0-3.758.763-3.758 2.546 0 2.363.183 2.546 4.185 3.575 8.263 2.188 9.055 3.278 9.055 9.307 0 5.725-1.761 9.239-10.664 9.239zm32.663-.602V43.84c0-1.578-.663-2.363-2.363-2.363-1.814 0-5.031 1.09-7.699 2.485v20.459h-7.394V22.847l7.394-1.029v15.33a26.045 26.045 0 0110.786-2.852c4.909 0 6.662 3.453 6.662 8.728v21.397h-7.386zm12.844-33.692v-8.545h7.394v8.545h-7.394zm0 33.692V34.906h7.394v29.515h-7.394zM215.62 35.15c0-7.394 4.299-11.693 14.361-11.693 3.697 0 7.38.447 10.969 1.334l-.839 6.601a59.517 59.517 0 00-9.909-1.029c-5.275 0-6.967 1.822-6.967 6.098v15.512c0 4.3 1.7 6.098 6.967 6.098a59.506 59.506 0 009.909-1.029l.846 6.609a45.672 45.672 0 01-10.968 1.334c-10.062 0-14.361-4.3-14.361-11.693l-.008-18.142zm40.499 29.873c-10.123 0-12.844-5.572-12.844-11.632v-7.455c0-6.06 2.728-11.632 12.844-11.632 10.115 0 12.844 5.572 12.844 11.632v7.455c-.023 6.06-2.744 11.632-12.844 11.632zm0-24.392c-3.941 0-5.45 1.76-5.45 5.092v7.912c0 3.331 1.524 5.092 5.45 5.092 3.925 0 5.45-1.76 5.45-5.092v-7.943c-.015-3.33-1.532-5.092-5.45-5.092v.03zm32.457.457a57.835 57.835 0 00-7.821 4.3v19.056h-7.394V34.906h6.243l.488 3.27a33.064 33.064 0 017.76-3.88l.724 6.792zm28.035 13.515c0 6.548-2.911 10.42-9.756 10.42a40.76 40.76 0 01-7.882-.853v12.196l-7.394 1.029V34.906h5.877l.762 2.485a15.535 15.535 0 019.33-3.087c5.938 0 9.086 3.514 9.086 10.245l-.023 10.054zm-17.631 3.331c2.152.474 4.346.73 6.548.763 2.668 0 3.697-1.274 3.697-3.941V44.35c0-2.424-.907-3.758-3.636-3.758a10.46 10.46 0 00-6.609 2.668v14.673zM29.134 7L0 23.808v40.361l10.946 6.32V30.127l18.188-10.504V7z" fill="#000"/><path d="M40.758 7v32.144H29.133V27.147l-10.945 6.319V74.65l10.946 6.335V48.932h11.624v11.914l10.946-6.312V13.32L40.758 7z" fill="#000"/><path d="M40.758 81L69.89 64.192V23.831l-10.946-6.32v40.362L40.758 68.377V81z" fill="#000"/></svg></div></a><span class="footer_themeSwitcher__CPJxw hds-font-weight-regular"><label class="theme-switcher_label__7Boh2 hds-typography-body-200" for="react-aria-97">Theme</label></span></span><ul class="footer_links__t81SU"><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="/hashicorp-terraform/certifications"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Certifications</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://status.hashicorp.com"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">System Status</span></a></li><li><button class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Cookie Manager</span></button></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/terms-of-service"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Terms of Use</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/security"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Security</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/privacy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Privacy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trademark-policy"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trademark Policy</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" href="https://www.hashicorp.com/trade-controls"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Trade Controls</span></a></li><li><a class="footer_linkAction__bR3OW g-focus-ring-from-box-shadow" aria-describedby="undefinedopens-in-new-tab-label-react-aria-105" target="_blank" href="https://forms.gle/fnHLuNahLEhjuKvE6"><span class="text_root__r0DFB hds-typography-body-200 hds-font-weight-regular">Give Feedback</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16" aria-hidden="true"><g fill="currentColor"><path d="M9 .75A.75.75 0 019.75 0h4.5c.206 0 .393.083.529.218l.001.002.002.001A.748.748 0 0115 .75v4.5a.75.75 0 01-1.5 0V2.56L7.28 8.78a.75.75 0 01-1.06-1.06l6.22-6.22H9.75A.75.75 0 019 .75z"></path><path d="M3.25 3.5a.75.75 0 00-.75.75v7.5c0 .414.336.75.75.75h7.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0110.75 14h-7.5A2.25 2.25 0 011 11.75v-7.5A2.25 2.25 0 013.25 2h4a.75.75 0 010 1.5h-4z"></path></g></svg></a><span class="g-screen-reader-only" id="opens-in-new-tab-label-react-aria-105">(opens in new tab)</span></li></ul></footer></div></div></div><div class="style_root__owpNH"></div><div style="position:fixed;z-index:99;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none;inset:24px"></div><!--$--><!--/$--></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Terraform","url":"/terraform"},{"title":"Configuration Language","url":"/terraform/language","isCurrentPage":false},{"title":"Tests","url":"/terraform/language/tests","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Terraform Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Terraform","fullPath":"/terraform","theme":"terraform"},{"title":"Install","fullPath":"/terraform/install"},{"title":"Tutorials","fullPath":"/terraform/tutorials"},{"title":"Documentation","isOpen":true,"routes":[{"title":"About the Docs","fullPath":"/terraform/docs"},{"title":"Configuration Language","fullPath":"/terraform/language"},{"title":"Terraform CLI","fullPath":"/terraform/cli"},{"title":"Terraform Cloud","fullPath":"/terraform/cloud-docs"},{"title":"Terraform Enterprise","fullPath":"/terraform/enterprise"},{"title":"CDK for Terraform","fullPath":"/terraform/cdktf"},{"title":"Provider Use","fullPath":"/terraform/language/providers"},{"title":"Plugin Development","fullPath":"/terraform/plugin"},{"title":"Registry Publishing","fullPath":"/terraform/registry"},{"title":"Integration Program","fullPath":"/terraform/docs/partnerships"}]}],"showFilterInput":false,"title":"Terraform","visuallyHideTitle":true},{"backToLinkProps":{"text":"Terraform Home","href":"/terraform"},"levelButtonProps":{"levelUpButtonText":"Terraform Home"},"menuItems":[{"title":"Configuration Language","fullPath":"/terraform/language","theme":"terraform"},{"title":"Files and Directories","routes":[{"title":"Overview","path":"files","filePath":"../docs/language/files/index.mdx","fullPath":"/terraform/language/files","id":"sidebar-nav-item-3"},{"title":"Override Files","path":"files/override","filePath":"../docs/language/files/override.mdx","fullPath":"/terraform/language/files/override","id":"sidebar-nav-item-4"},{"title":"Dependency Lock File","path":"files/dependency-lock","filePath":"../docs/language/files/dependency-lock.mdx","fullPath":"/terraform/language/files/dependency-lock","id":"sidebar-nav-item-5"},{"title":"Test Files","path":"files/tests","filePath":"../docs/language/files/tests.mdx","fullPath":"/terraform/language/files/tests","id":"sidebar-nav-item-6"}],"id":"sidebar-nav-item-2"},{"title":"Syntax","routes":[{"title":"Overview","path":"syntax","filePath":"../docs/language/syntax/index.mdx","fullPath":"/terraform/language/syntax","id":"sidebar-nav-item-8"},{"title":"Configuration Syntax","path":"syntax/configuration","filePath":"../docs/language/syntax/configuration.mdx","fullPath":"/terraform/language/syntax/configuration","id":"sidebar-nav-item-9"},{"title":"JSON Configuration Syntax","path":"syntax/json","filePath":"../docs/language/syntax/json.mdx","fullPath":"/terraform/language/syntax/json","id":"sidebar-nav-item-10"},{"title":"Style Conventions","path":"syntax/style","filePath":"../docs/language/syntax/style.mdx","fullPath":"/terraform/language/syntax/style","id":"sidebar-nav-item-11"}],"id":"sidebar-nav-item-7"},{"title":"Resources","routes":[{"title":"Overview","path":"resources","filePath":"../docs/language/resources/index.mdx","fullPath":"/terraform/language/resources","id":"sidebar-nav-item-13"},{"title":"Resource Blocks","path":"resources/syntax","filePath":"../docs/language/resources/syntax.mdx","fullPath":"/terraform/language/resources/syntax","id":"sidebar-nav-item-14"},{"title":"Resource Behavior","path":"resources/behavior","filePath":"../docs/language/resources/behavior.mdx","fullPath":"/terraform/language/resources/behavior","id":"sidebar-nav-item-15"},{"title":"Meta-Arguments","routes":[{"title":"\u003ccode\u003edepends_on\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/depends_on","id":"sidebar-nav-item-17","path":"/language/meta-arguments/depends_on"},{"title":"\u003ccode\u003ecount\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/count","id":"sidebar-nav-item-18","path":"/language/meta-arguments/count"},{"title":"\u003ccode\u003efor_each\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/for_each","id":"sidebar-nav-item-19","path":"/language/meta-arguments/for_each"},{"title":"\u003ccode\u003eprovider\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/resource-provider","id":"sidebar-nav-item-20","path":"/language/meta-arguments/resource-provider"},{"title":"\u003ccode\u003elifecycle\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/lifecycle","id":"sidebar-nav-item-21","path":"/language/meta-arguments/lifecycle"}],"id":"sidebar-nav-item-16"},{"title":"Provisioners","routes":[{"title":"Declaring Provisioners","path":"resources/provisioners/syntax","filePath":"../docs/language/resources/provisioners/syntax.mdx","fullPath":"/terraform/language/resources/provisioners/syntax","id":"sidebar-nav-item-23"},{"title":"Provisioner Connections","path":"resources/provisioners/connection","filePath":"../docs/language/resources/provisioners/connection.mdx","fullPath":"/terraform/language/resources/provisioners/connection","id":"sidebar-nav-item-24"},{"title":"Provisioners Without a Resource","path":"resources/provisioners/null_resource","filePath":"../docs/language/resources/provisioners/null_resource.mdx","fullPath":"/terraform/language/resources/provisioners/null_resource","id":"sidebar-nav-item-25"},{"title":"file","path":"resources/provisioners/file","filePath":"../docs/language/resources/provisioners/file.mdx","fullPath":"/terraform/language/resources/provisioners/file","id":"sidebar-nav-item-26"},{"title":"local-exec","path":"resources/provisioners/local-exec","filePath":"../docs/language/resources/provisioners/local-exec.mdx","fullPath":"/terraform/language/resources/provisioners/local-exec","id":"sidebar-nav-item-27"},{"title":"remote-exec","path":"resources/provisioners/remote-exec","filePath":"../docs/language/resources/provisioners/remote-exec.mdx","fullPath":"/terraform/language/resources/provisioners/remote-exec","id":"sidebar-nav-item-28"}],"id":"sidebar-nav-item-22"},{"title":"The \u003ccode\u003eterraform_data\u003c/code\u003e Resource Type","path":"resources/terraform-data","filePath":"../docs/language/resources/terraform-data.mdx","fullPath":"/terraform/language/resources/terraform-data","id":"sidebar-nav-item-29"}],"id":"sidebar-nav-item-12"},{"title":"Data Sources","path":"data-sources","filePath":"../docs/language/data-sources/index.mdx","fullPath":"/terraform/language/data-sources","id":"sidebar-nav-item-30"},{"title":"Providers","routes":[{"title":"Overview","path":"providers","filePath":"../docs/language/providers/index.mdx","fullPath":"/terraform/language/providers","id":"sidebar-nav-item-32"},{"title":"Provider Configuration","path":"providers/configuration","filePath":"../docs/language/providers/configuration.mdx","fullPath":"/terraform/language/providers/configuration","id":"sidebar-nav-item-33"},{"title":"Provider Requirements","path":"providers/requirements","filePath":"../docs/language/providers/requirements.mdx","fullPath":"/terraform/language/providers/requirements","id":"sidebar-nav-item-34"},{"title":"Dependency Lock File","href":null,"fullPath":"/terraform/language/files/dependency-lock","id":"sidebar-nav-item-35","path":"/language/files/dependency-lock"}],"id":"sidebar-nav-item-31"},{"title":"Variables and Outputs","routes":[{"title":"Overview","path":"values","filePath":"../docs/language/values/index.mdx","fullPath":"/terraform/language/values","id":"sidebar-nav-item-37"},{"title":"Input Variables","path":"values/variables","filePath":"../docs/language/values/variables.mdx","fullPath":"/terraform/language/values/variables","id":"sidebar-nav-item-38"},{"title":"Output Values","path":"values/outputs","filePath":"../docs/language/values/outputs.mdx","fullPath":"/terraform/language/values/outputs","id":"sidebar-nav-item-39"},{"title":"Local Values","path":"values/locals","filePath":"../docs/language/values/locals.mdx","fullPath":"/terraform/language/values/locals","id":"sidebar-nav-item-40"}],"id":"sidebar-nav-item-36"},{"title":"Modules","routes":[{"title":"Overview","path":"modules","filePath":"../docs/language/modules/index.mdx","fullPath":"/terraform/language/modules","id":"sidebar-nav-item-42"},{"title":"Module Blocks","path":"modules/syntax","filePath":"../docs/language/modules/syntax.mdx","fullPath":"/terraform/language/modules/syntax","id":"sidebar-nav-item-43"},{"title":"Module Sources","path":"modules/sources","filePath":"../docs/language/modules/sources.mdx","fullPath":"/terraform/language/modules/sources","id":"sidebar-nav-item-44"},{"title":"Meta-Arguments","routes":[{"title":"\u003ccode\u003eproviders\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/module-providers","id":"sidebar-nav-item-46","path":"/language/meta-arguments/module-providers"},{"title":"\u003ccode\u003edepends_on\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/depends_on","id":"sidebar-nav-item-47","path":"/language/meta-arguments/depends_on"},{"title":"\u003ccode\u003ecount\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/count","id":"sidebar-nav-item-48","path":"/language/meta-arguments/count"},{"title":"\u003ccode\u003efor_each\u003c/code\u003e","href":null,"fullPath":"/terraform/language/meta-arguments/for_each","id":"sidebar-nav-item-49","path":"/language/meta-arguments/for_each"}],"id":"sidebar-nav-item-45"},{"title":"Module Development","routes":[{"title":"Overview","path":"modules/develop","filePath":"../docs/language/modules/develop/index.mdx","fullPath":"/terraform/language/modules/develop","id":"sidebar-nav-item-51"},{"title":"Standard Module Structure","path":"modules/develop/structure","filePath":"../docs/language/modules/develop/structure.mdx","fullPath":"/terraform/language/modules/develop/structure","id":"sidebar-nav-item-52"},{"title":"Providers Within Modules","path":"modules/develop/providers","filePath":"../docs/language/modules/develop/providers.mdx","fullPath":"/terraform/language/modules/develop/providers","id":"sidebar-nav-item-53"},{"title":"Best Practices: Module Composition","path":"modules/develop/composition","filePath":"../docs/language/modules/develop/composition.mdx","fullPath":"/terraform/language/modules/develop/composition","id":"sidebar-nav-item-54"},{"title":"Publishing Modules","path":"modules/develop/publish","filePath":"../docs/language/modules/develop/publish.mdx","fullPath":"/terraform/language/modules/develop/publish","id":"sidebar-nav-item-55"},{"title":"Refactoring Modules","path":"modules/develop/refactoring","filePath":"../docs/language/modules/develop/refactoring.mdx","fullPath":"/terraform/language/modules/develop/refactoring","id":"sidebar-nav-item-56"}],"id":"sidebar-nav-item-50"}],"id":"sidebar-nav-item-41"},{"title":"Checks","path":"checks","filePath":"../docs/language/checks/index.mdx","fullPath":"/terraform/language/checks","id":"sidebar-nav-item-57"},{"title":"Import","routes":[{"title":"Overview","path":"import","filePath":"../docs/language/import/index.mdx","fullPath":"/terraform/language/import","id":"sidebar-nav-item-59"},{"title":"Generating Configuration","path":"import/generating-configuration","filePath":"../docs/language/import/generating-configuration.mdx","fullPath":"/terraform/language/import/generating-configuration","id":"sidebar-nav-item-60"}],"id":"sidebar-nav-item-58"},{"title":"Expressions","routes":[{"title":"Overview","path":"expressions","filePath":"../docs/language/expressions/index.mdx","fullPath":"/terraform/language/expressions","id":"sidebar-nav-item-62"},{"title":"Types and Values","path":"expressions/types","filePath":"../docs/language/expressions/types.mdx","fullPath":"/terraform/language/expressions/types","id":"sidebar-nav-item-63"},{"title":"Strings and Templates","path":"expressions/strings","filePath":"../docs/language/expressions/strings.mdx","fullPath":"/terraform/language/expressions/strings","id":"sidebar-nav-item-64"},{"title":"References to Values","path":"expressions/references","filePath":"../docs/language/expressions/references.mdx","fullPath":"/terraform/language/expressions/references","id":"sidebar-nav-item-65"},{"title":"Operators","path":"expressions/operators","filePath":"../docs/language/expressions/operators.mdx","fullPath":"/terraform/language/expressions/operators","id":"sidebar-nav-item-66"},{"title":"Function Calls","path":"expressions/function-calls","filePath":"../docs/language/expressions/function-calls.mdx","fullPath":"/terraform/language/expressions/function-calls","id":"sidebar-nav-item-67"},{"title":"Conditional Expressions","path":"expressions/conditionals","filePath":"../docs/language/expressions/conditionals.mdx","fullPath":"/terraform/language/expressions/conditionals","id":"sidebar-nav-item-68"},{"title":"For Expressions","path":"expressions/for","filePath":"../docs/language/expressions/for.mdx","fullPath":"/terraform/language/expressions/for","id":"sidebar-nav-item-69"},{"title":"Splat Expressions","path":"expressions/splat","filePath":"../docs/language/expressions/splat.mdx","fullPath":"/terraform/language/expressions/splat","id":"sidebar-nav-item-70"},{"title":"Dynamic Blocks","path":"expressions/dynamic-blocks","filePath":"../docs/language/expressions/dynamic-blocks.mdx","fullPath":"/terraform/language/expressions/dynamic-blocks","id":"sidebar-nav-item-71"},{"title":"Custom Conditions","path":"expressions/custom-conditions","filePath":"../docs/language/expressions/custom-conditions.mdx","fullPath":"/terraform/language/expressions/custom-conditions","id":"sidebar-nav-item-72"},{"title":"Type Constraints","path":"expressions/type-constraints","filePath":"../docs/language/expressions/type-constraints.mdx","fullPath":"/terraform/language/expressions/type-constraints","id":"sidebar-nav-item-73"},{"title":"Version Constraints","path":"expressions/version-constraints","filePath":"../docs/language/expressions/version-constraints.mdx","fullPath":"/terraform/language/expressions/version-constraints","id":"sidebar-nav-item-74"}],"id":"sidebar-nav-item-61"},{"title":"Functions","routes":[{"title":"Overview","path":"functions","filePath":"../docs/language/functions/index.mdx","fullPath":"/terraform/language/functions","id":"sidebar-nav-item-76"},{"title":"Numeric Functions","routes":[{"title":"\u003ccode\u003eabs\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/abs","id":"sidebar-nav-item-78","path":"/language/functions/abs"},{"title":"\u003ccode\u003eceil\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/ceil","id":"sidebar-nav-item-79","path":"/language/functions/ceil"},{"title":"\u003ccode\u003efloor\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/floor","id":"sidebar-nav-item-80","path":"/language/functions/floor"},{"title":"\u003ccode\u003elog\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/log","id":"sidebar-nav-item-81","path":"/language/functions/log"},{"title":"\u003ccode\u003emax\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/max","id":"sidebar-nav-item-82","path":"/language/functions/max"},{"title":"\u003ccode\u003emin\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/min","id":"sidebar-nav-item-83","path":"/language/functions/min"},{"title":"\u003ccode\u003eparseint\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/parseint","id":"sidebar-nav-item-84","path":"/language/functions/parseint"},{"title":"\u003ccode\u003epow\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/pow","id":"sidebar-nav-item-85","path":"/language/functions/pow"},{"title":"\u003ccode\u003esignum\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/signum","id":"sidebar-nav-item-86","path":"/language/functions/signum"}],"id":"sidebar-nav-item-77"},{"title":"String Functions","routes":[{"title":"\u003ccode\u003echomp\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/chomp","id":"sidebar-nav-item-88","path":"/language/functions/chomp"},{"title":"\u003ccode\u003eendswith\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/endswith","id":"sidebar-nav-item-89","path":"/language/functions/endswith"},{"title":"\u003ccode\u003eformat\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/format","id":"sidebar-nav-item-90","path":"/language/functions/format"},{"title":"\u003ccode\u003eformatlist\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/formatlist","id":"sidebar-nav-item-91","path":"/language/functions/formatlist"},{"title":"\u003ccode\u003eindent\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/indent","id":"sidebar-nav-item-92","path":"/language/functions/indent"},{"title":"\u003ccode\u003ejoin\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/join","id":"sidebar-nav-item-93","path":"/language/functions/join"},{"title":"\u003ccode\u003elower\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/lower","id":"sidebar-nav-item-94","path":"/language/functions/lower"},{"title":"\u003ccode\u003eregex\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/regex","id":"sidebar-nav-item-95","path":"/language/functions/regex"},{"title":"\u003ccode\u003eregexall\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/regexall","id":"sidebar-nav-item-96","path":"/language/functions/regexall"},{"title":"\u003ccode\u003ereplace\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/replace","id":"sidebar-nav-item-97","path":"/language/functions/replace"},{"title":"\u003ccode\u003esplit\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/split","id":"sidebar-nav-item-98","path":"/language/functions/split"},{"title":"\u003ccode\u003estartswith\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/startswith","id":"sidebar-nav-item-99","path":"/language/functions/startswith"},{"title":"\u003ccode\u003estrcontains\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/strcontains","id":"sidebar-nav-item-100","path":"/language/functions/strcontains"},{"title":"\u003ccode\u003estrrev\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/strrev","id":"sidebar-nav-item-101","path":"/language/functions/strrev"},{"title":"\u003ccode\u003esubstr\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/substr","id":"sidebar-nav-item-102","path":"/language/functions/substr"},{"title":"\u003ccode\u003etitle\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/title","id":"sidebar-nav-item-103","path":"/language/functions/title"},{"title":"\u003ccode\u003etrim\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/trim","id":"sidebar-nav-item-104","path":"/language/functions/trim"},{"title":"\u003ccode\u003etrimprefix\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/trimprefix","id":"sidebar-nav-item-105","path":"/language/functions/trimprefix"},{"title":"\u003ccode\u003etrimsuffix\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/trimsuffix","id":"sidebar-nav-item-106","path":"/language/functions/trimsuffix"},{"title":"\u003ccode\u003etrimspace\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/trimspace","id":"sidebar-nav-item-107","path":"/language/functions/trimspace"},{"title":"\u003ccode\u003eupper\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/upper","id":"sidebar-nav-item-108","path":"/language/functions/upper"}],"id":"sidebar-nav-item-87"},{"title":"Collection Functions","routes":[{"title":"\u003ccode\u003ealltrue\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/alltrue","id":"sidebar-nav-item-110","path":"/language/functions/alltrue"},{"title":"\u003ccode\u003eanytrue\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/anytrue","id":"sidebar-nav-item-111","path":"/language/functions/anytrue"},{"title":"\u003ccode\u003echunklist\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/chunklist","id":"sidebar-nav-item-112","path":"/language/functions/chunklist"},{"title":"\u003ccode\u003ecoalesce\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/coalesce","id":"sidebar-nav-item-113","path":"/language/functions/coalesce"},{"title":"\u003ccode\u003ecoalescelist\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/coalescelist","id":"sidebar-nav-item-114","path":"/language/functions/coalescelist"},{"title":"\u003ccode\u003ecompact\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/compact","id":"sidebar-nav-item-115","path":"/language/functions/compact"},{"title":"\u003ccode\u003econcat\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/concat","id":"sidebar-nav-item-116","path":"/language/functions/concat"},{"title":"\u003ccode\u003econtains\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/contains","id":"sidebar-nav-item-117","path":"/language/functions/contains"},{"title":"\u003ccode\u003edistinct\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/distinct","id":"sidebar-nav-item-118","path":"/language/functions/distinct"},{"title":"\u003ccode\u003eelement\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/element","id":"sidebar-nav-item-119","path":"/language/functions/element"},{"title":"\u003ccode\u003eflatten\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/flatten","id":"sidebar-nav-item-120","path":"/language/functions/flatten"},{"title":"\u003ccode\u003eindex\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/index_function","id":"sidebar-nav-item-121","path":"/language/functions/index_function"},{"title":"\u003ccode\u003ekeys\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/keys","id":"sidebar-nav-item-122","path":"/language/functions/keys"},{"title":"\u003ccode\u003elength\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/length","id":"sidebar-nav-item-123","path":"/language/functions/length"},{"title":"\u003ccode\u003elist\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/list","id":"sidebar-nav-item-124","path":"/language/functions/list"},{"title":"\u003ccode\u003elookup\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/lookup","id":"sidebar-nav-item-125","path":"/language/functions/lookup"},{"title":"\u003ccode\u003emap\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/map","id":"sidebar-nav-item-126","path":"/language/functions/map"},{"title":"\u003ccode\u003ematchkeys\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/matchkeys","id":"sidebar-nav-item-127","path":"/language/functions/matchkeys"},{"title":"\u003ccode\u003emerge\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/merge","id":"sidebar-nav-item-128","path":"/language/functions/merge"},{"title":"\u003ccode\u003eone\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/one","id":"sidebar-nav-item-129","path":"/language/functions/one"},{"title":"\u003ccode\u003erange\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/range","id":"sidebar-nav-item-130","path":"/language/functions/range"},{"title":"\u003ccode\u003ereverse\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/reverse","id":"sidebar-nav-item-131","path":"/language/functions/reverse"},{"title":"\u003ccode\u003esetintersection\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/setintersection","id":"sidebar-nav-item-132","path":"/language/functions/setintersection"},{"title":"\u003ccode\u003esetproduct\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/setproduct","id":"sidebar-nav-item-133","path":"/language/functions/setproduct"},{"title":"\u003ccode\u003esetsubtract\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/setsubtract","id":"sidebar-nav-item-134","path":"/language/functions/setsubtract"},{"title":"\u003ccode\u003esetunion\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/setunion","id":"sidebar-nav-item-135","path":"/language/functions/setunion"},{"title":"\u003ccode\u003eslice\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/slice","id":"sidebar-nav-item-136","path":"/language/functions/slice"},{"title":"\u003ccode\u003esort\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/sort","id":"sidebar-nav-item-137","path":"/language/functions/sort"},{"title":"\u003ccode\u003esum\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/sum","id":"sidebar-nav-item-138","path":"/language/functions/sum"},{"title":"\u003ccode\u003etranspose\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/transpose","id":"sidebar-nav-item-139","path":"/language/functions/transpose"},{"title":"\u003ccode\u003evalues\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/values","id":"sidebar-nav-item-140","path":"/language/functions/values"},{"title":"\u003ccode\u003ezipmap\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/zipmap","id":"sidebar-nav-item-141","path":"/language/functions/zipmap"}],"id":"sidebar-nav-item-109"},{"title":"Encoding Functions","routes":[{"title":"\u003ccode\u003ebase64decode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/base64decode","id":"sidebar-nav-item-143","path":"/language/functions/base64decode"},{"title":"\u003ccode\u003ebase64encode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/base64encode","id":"sidebar-nav-item-144","path":"/language/functions/base64encode"},{"title":"\u003ccode\u003ebase64gzip\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/base64gzip","id":"sidebar-nav-item-145","path":"/language/functions/base64gzip"},{"title":"\u003ccode\u003ecsvdecode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/csvdecode","id":"sidebar-nav-item-146","path":"/language/functions/csvdecode"},{"title":"\u003ccode\u003ejsondecode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/jsondecode","id":"sidebar-nav-item-147","path":"/language/functions/jsondecode"},{"title":"\u003ccode\u003ejsonencode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/jsonencode","id":"sidebar-nav-item-148","path":"/language/functions/jsonencode"},{"title":"\u003ccode\u003etextdecodebase64\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/textdecodebase64","id":"sidebar-nav-item-149","path":"/language/functions/textdecodebase64"},{"title":"\u003ccode\u003etextencodebase64\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/textencodebase64","id":"sidebar-nav-item-150","path":"/language/functions/textencodebase64"},{"title":"\u003ccode\u003eurlencode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/urlencode","id":"sidebar-nav-item-151","path":"/language/functions/urlencode"},{"title":"\u003ccode\u003eyamldecode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/yamldecode","id":"sidebar-nav-item-152","path":"/language/functions/yamldecode"},{"title":"\u003ccode\u003eyamlencode\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/yamlencode","id":"sidebar-nav-item-153","path":"/language/functions/yamlencode"}],"id":"sidebar-nav-item-142"},{"title":"Filesystem Functions","routes":[{"title":"\u003ccode\u003eabspath\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/abspath","id":"sidebar-nav-item-155","path":"/language/functions/abspath"},{"title":"\u003ccode\u003edirname\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/dirname","id":"sidebar-nav-item-156","path":"/language/functions/dirname"},{"title":"\u003ccode\u003epathexpand\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/pathexpand","id":"sidebar-nav-item-157","path":"/language/functions/pathexpand"},{"title":"\u003ccode\u003ebasename\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/basename","id":"sidebar-nav-item-158","path":"/language/functions/basename"},{"title":"\u003ccode\u003efile\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/file","id":"sidebar-nav-item-159","path":"/language/functions/file"},{"title":"\u003ccode\u003efileexists\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/fileexists","id":"sidebar-nav-item-160","path":"/language/functions/fileexists"},{"title":"\u003ccode\u003efileset\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/fileset","id":"sidebar-nav-item-161","path":"/language/functions/fileset"},{"title":"\u003ccode\u003efilebase64\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filebase64","id":"sidebar-nav-item-162","path":"/language/functions/filebase64"},{"title":"\u003ccode\u003etemplatefile\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/templatefile","id":"sidebar-nav-item-163","path":"/language/functions/templatefile"}],"id":"sidebar-nav-item-154"},{"title":"Date and Time Functions","routes":[{"title":"\u003ccode\u003eformatdate\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/formatdate","id":"sidebar-nav-item-165","path":"/language/functions/formatdate"},{"title":"\u003ccode\u003eplantimestamp\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/plantimestamp","id":"sidebar-nav-item-166","path":"/language/functions/plantimestamp"},{"title":"\u003ccode\u003etimeadd\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/timeadd","id":"sidebar-nav-item-167","path":"/language/functions/timeadd"},{"title":"\u003ccode\u003etimecmp\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/timecmp","id":"sidebar-nav-item-168","path":"/language/functions/timecmp"},{"title":"\u003ccode\u003etimestamp\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/timestamp","id":"sidebar-nav-item-169","path":"/language/functions/timestamp"}],"id":"sidebar-nav-item-164"},{"title":"Hash and Crypto Functions","routes":[{"title":"\u003ccode\u003ebase64sha256\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/base64sha256","id":"sidebar-nav-item-171","path":"/language/functions/base64sha256"},{"title":"\u003ccode\u003ebase64sha512\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/base64sha512","id":"sidebar-nav-item-172","path":"/language/functions/base64sha512"},{"title":"\u003ccode\u003ebcrypt\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/bcrypt","id":"sidebar-nav-item-173","path":"/language/functions/bcrypt"},{"title":"\u003ccode\u003efilebase64sha256\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filebase64sha256","id":"sidebar-nav-item-174","path":"/language/functions/filebase64sha256"},{"title":"\u003ccode\u003efilebase64sha512\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filebase64sha512","id":"sidebar-nav-item-175","path":"/language/functions/filebase64sha512"},{"title":"\u003ccode\u003efilemd5\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filemd5","id":"sidebar-nav-item-176","path":"/language/functions/filemd5"},{"title":"\u003ccode\u003efilesha1\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filesha1","id":"sidebar-nav-item-177","path":"/language/functions/filesha1"},{"title":"\u003ccode\u003efilesha256\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filesha256","id":"sidebar-nav-item-178","path":"/language/functions/filesha256"},{"title":"\u003ccode\u003efilesha512\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/filesha512","id":"sidebar-nav-item-179","path":"/language/functions/filesha512"},{"title":"\u003ccode\u003emd5\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/md5","id":"sidebar-nav-item-180","path":"/language/functions/md5"},{"title":"\u003ccode\u003ersadecrypt\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/rsadecrypt","id":"sidebar-nav-item-181","path":"/language/functions/rsadecrypt"},{"title":"\u003ccode\u003esha1\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/sha1","id":"sidebar-nav-item-182","path":"/language/functions/sha1"},{"title":"\u003ccode\u003esha256\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/sha256","id":"sidebar-nav-item-183","path":"/language/functions/sha256"},{"title":"\u003ccode\u003esha512\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/sha512","id":"sidebar-nav-item-184","path":"/language/functions/sha512"},{"title":"\u003ccode\u003euuid\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/uuid","id":"sidebar-nav-item-185","path":"/language/functions/uuid"},{"title":"\u003ccode\u003euuidv5\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/uuidv5","id":"sidebar-nav-item-186","path":"/language/functions/uuidv5"}],"id":"sidebar-nav-item-170"},{"title":"IP Network Functions","routes":[{"title":"\u003ccode\u003ecidrhost\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/cidrhost","id":"sidebar-nav-item-188","path":"/language/functions/cidrhost"},{"title":"\u003ccode\u003ecidrnetmask\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/cidrnetmask","id":"sidebar-nav-item-189","path":"/language/functions/cidrnetmask"},{"title":"\u003ccode\u003ecidrsubnet\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/cidrsubnet","id":"sidebar-nav-item-190","path":"/language/functions/cidrsubnet"},{"title":"\u003ccode\u003ecidrsubnets\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/cidrsubnets","id":"sidebar-nav-item-191","path":"/language/functions/cidrsubnets"}],"id":"sidebar-nav-item-187"},{"title":"Type Conversion Functions","routes":[{"title":"\u003ccode\u003ecan\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/can","id":"sidebar-nav-item-193","path":"/language/functions/can"},{"title":"\u003ccode\u003eissensitive\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/issensitive","id":"sidebar-nav-item-194","path":"/language/functions/issensitive"},{"title":"\u003ccode\u003enonsensitive\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/nonsensitive","id":"sidebar-nav-item-195","path":"/language/functions/nonsensitive"},{"title":"\u003ccode\u003esensitive\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/sensitive","id":"sidebar-nav-item-196","path":"/language/functions/sensitive"},{"title":"\u003ccode\u003etobool\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/tobool","id":"sidebar-nav-item-197","path":"/language/functions/tobool"},{"title":"\u003ccode\u003etolist\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/tolist","id":"sidebar-nav-item-198","path":"/language/functions/tolist"},{"title":"\u003ccode\u003etomap\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/tomap","id":"sidebar-nav-item-199","path":"/language/functions/tomap"},{"title":"\u003ccode\u003etonumber\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/tonumber","id":"sidebar-nav-item-200","path":"/language/functions/tonumber"},{"title":"\u003ccode\u003etoset\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/toset","id":"sidebar-nav-item-201","path":"/language/functions/toset"},{"title":"\u003ccode\u003etostring\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/tostring","id":"sidebar-nav-item-202","path":"/language/functions/tostring"},{"title":"\u003ccode\u003etry\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/try","id":"sidebar-nav-item-203","path":"/language/functions/try"},{"title":"\u003ccode\u003etype\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/type","id":"sidebar-nav-item-204","path":"/language/functions/type"}],"id":"sidebar-nav-item-192"},{"title":"Terraform-specific Functions","routes":[{"title":"\u003ccode\u003eprovider::terraform::encode_tfvars\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/terraform-encode_tfvars","id":"sidebar-nav-item-206","path":"/language/functions/terraform-encode_tfvars"},{"title":"\u003ccode\u003eprovider::terraform::decode_tfvars\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/terraform-decode_tfvars","id":"sidebar-nav-item-207","path":"/language/functions/terraform-decode_tfvars"},{"title":"\u003ccode\u003eprovider::terraform::encode_expr\u003c/code\u003e","href":null,"fullPath":"/terraform/language/functions/terraform-encode_expr","id":"sidebar-nav-item-208","path":"/language/functions/terraform-encode_expr"}],"id":"sidebar-nav-item-205"}],"id":"sidebar-nav-item-75"},{"title":"Terraform Settings","routes":[{"title":"Overview","path":"settings","filePath":"../docs/language/settings/index.mdx","fullPath":"/terraform/language/settings","id":"sidebar-nav-item-210"},{"title":"Terraform Cloud","path":"settings/terraform-cloud","filePath":"../docs/language/settings/terraform-cloud.mdx","fullPath":"/terraform/language/settings/terraform-cloud","id":"sidebar-nav-item-211"},{"title":"Backends","routes":[{"title":"Backend Configuration","path":"settings/backends/configuration","filePath":"../docs/language/settings/backends/configuration.mdx","fullPath":"/terraform/language/settings/backends/configuration","id":"sidebar-nav-item-213"},{"title":"Available Backends","routes":[{"title":"local","href":null,"fullPath":"/terraform/language/settings/backends/local","id":"sidebar-nav-item-215","path":"/language/settings/backends/local"},{"title":"remote","href":null,"fullPath":"/terraform/language/settings/backends/remote","id":"sidebar-nav-item-216","path":"/language/settings/backends/remote"},{"title":"azurerm","href":null,"fullPath":"/terraform/language/settings/backends/azurerm","id":"sidebar-nav-item-217","path":"/language/settings/backends/azurerm"},{"title":"consul","href":null,"fullPath":"/terraform/language/settings/backends/consul","id":"sidebar-nav-item-218","path":"/language/settings/backends/consul"},{"title":"cos","href":null,"fullPath":"/terraform/language/settings/backends/cos","id":"sidebar-nav-item-219","path":"/language/settings/backends/cos"},{"title":"gcs","href":null,"fullPath":"/terraform/language/settings/backends/gcs","id":"sidebar-nav-item-220","path":"/language/settings/backends/gcs"},{"title":"http","href":null,"fullPath":"/terraform/language/settings/backends/http","id":"sidebar-nav-item-221","path":"/language/settings/backends/http"},{"title":"Kubernetes","href":null,"fullPath":"/terraform/language/settings/backends/kubernetes","id":"sidebar-nav-item-222","path":"/language/settings/backends/kubernetes"},{"title":"oss","href":null,"fullPath":"/terraform/language/settings/backends/oss","id":"sidebar-nav-item-223","path":"/language/settings/backends/oss"},{"title":"pg","href":null,"fullPath":"/terraform/language/settings/backends/pg","id":"sidebar-nav-item-224","path":"/language/settings/backends/pg"},{"title":"s3","href":null,"fullPath":"/terraform/language/settings/backends/s3","id":"sidebar-nav-item-225","path":"/language/settings/backends/s3"}],"id":"sidebar-nav-item-214"}],"id":"sidebar-nav-item-212"}],"id":"sidebar-nav-item-209"},{"title":"State","routes":[{"title":"Overview","path":"state","filePath":"../docs/language/state/index.mdx","fullPath":"/terraform/language/state","id":"sidebar-nav-item-227"},{"title":"Purpose","path":"state/purpose","filePath":"../docs/language/state/purpose.mdx","fullPath":"/terraform/language/state/purpose","id":"sidebar-nav-item-228"},{"title":"The \u003ccode\u003eterraform_remote_state\u003c/code\u003e Data Source","path":"state/remote-state-data","filePath":"../docs/language/state/remote-state-data.mdx","fullPath":"/terraform/language/state/remote-state-data","id":"sidebar-nav-item-229"},{"title":"Backends: State Storage and Locking","path":"state/backends","filePath":"../docs/language/state/backends.mdx","fullPath":"/terraform/language/state/backends","id":"sidebar-nav-item-230"},{"title":"Import Existing Resources","path":"state/import","filePath":"../docs/language/state/import.mdx","fullPath":"/terraform/language/state/import","id":"sidebar-nav-item-231"},{"title":"Locking","path":"state/locking","filePath":"../docs/language/state/locking.mdx","fullPath":"/terraform/language/state/locking","id":"sidebar-nav-item-232"},{"title":"Workspaces","path":"state/workspaces","filePath":"../docs/language/state/workspaces.mdx","fullPath":"/terraform/language/state/workspaces","id":"sidebar-nav-item-233"},{"title":"Remote State","path":"state/remote","filePath":"../docs/language/state/remote.mdx","fullPath":"/terraform/language/state/remote","id":"sidebar-nav-item-234"},{"title":"Sensitive Data","path":"state/sensitive-data","filePath":"../docs/language/state/sensitive-data.mdx","fullPath":"/terraform/language/state/sensitive-data","id":"sidebar-nav-item-235"}],"id":"sidebar-nav-item-226"},{"title":"Tests","routes":[{"title":"Overview","path":"tests","filePath":"../docs/language/tests/index.mdx","fullPath":"/terraform/language/tests","id":"sidebar-nav-item-237"},{"title":"Mocks","path":"tests/mocking","filePath":"../docs/language/tests/mocking.mdx","fullPath":"/terraform/language/tests/mocking","id":"sidebar-nav-item-238"}],"id":"sidebar-nav-item-236"},{"title":"Upgrading to Terraform v1.7","path":"upgrade-guides","filePath":"../docs/language/upgrade-guides/index.mdx","fullPath":"/terraform/language/upgrade-guides","id":"sidebar-nav-item-239"},{"title":"v1.x Compatibility Promises","path":"v1-compatibility-promises","filePath":"../docs/language/v1-compatibility-promises.mdx","fullPath":"/terraform/language/v1-compatibility-promises","id":"sidebar-nav-item-240"},{"divider":true,"id":"sidebar-nav-item-241"},{"title":"Terraform Internals","href":null,"fullPath":"/terraform/internals","id":"sidebar-nav-item-242","path":"/internals"}],"title":"Configuration Language","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/terraform/blob/main/website/../docs/language/tests/index.mdx"},"metadata":{"title":"Tests - Configuration Language","description":"Write structured test code for validating your configuration.","layout":null},"outlineItems":[{"title":"Tests","url":"#tests","dataHeapTrack":"toc-list-item-index-0"},{"title":"Integration or Unit testing","url":"#integration-or-unit-testing","dataHeapTrack":"toc-list-item-index-1"},{"title":"Syntax","url":"#syntax","dataHeapTrack":"toc-list-item-index-2"},{"title":"Run blocks","url":"#run-blocks","dataHeapTrack":"toc-list-item-index-3"},{"title":"Variables","url":"#variables","dataHeapTrack":"toc-list-item-index-4"},{"title":"Providers","url":"#providers","dataHeapTrack":"toc-list-item-index-5"},{"title":"Modules","url":"#modules","dataHeapTrack":"toc-list-item-index-6"},{"title":"Expecting failures","url":"#expecting-failures","dataHeapTrack":"toc-list-item-index-7"}],"pageHeading":{"id":"tests","title":"Tests"},"mdxSource":{"compiledSource":"var l=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;var c=(a,n,t)=\u003en in a?l(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=\u003e{for(var t in n||(n={}))o.call(n,t)\u0026\u0026c(a,t,n[t]);if(p)for(var t of p(n))r.call(n,t)\u0026\u0026c(a,t,n[t]);return a},i=(a,n)=\u003ed(a,N(n));var m=(a,n)=\u003e{var t={};for(var s in a)o.call(a,s)\u0026\u0026n.indexOf(s)\u003c0\u0026\u0026(t[s]=a[s]);if(a!=null\u0026\u0026p)for(var s of p(a))n.indexOf(s)\u003c0\u0026\u0026r.call(a,s)\u0026\u0026(t[s]=a[s]);return t};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,i(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"\",mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" This testing framework is available in Terraform v1.6.0 and later.\")),mdx(\"p\",null,\"Terraform tests let authors validate that module configuration updates do not introduce breaking changes. Tests run against test-specific, short-lived resources, preventing any risk to your existing infrastructure or state.\"),mdx(\"h2\",e({},{id:\"integration-or-unit-testing\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#integration-or-unit-testing\",\"aria-label\":\"integration or unit testing permalink\"}),\"\\xBB\"),\"Integration or Unit testing\"),mdx(\"p\",null,\"By default, tests within Terraform create real infrastructure and can run assertions and validations against that infrastructure. This is analogous to integration testing because you are testing Terraform's core functionality by executing operations and validating the infrastructure Terraform creates.\"),mdx(\"p\",null,\"You can override the normal testing behavior by updating the \",mdx(\"inlineCode\",{parentName:\"p\"},\"command\"),\" attribute within a \",mdx(\"a\",e({parentName:\"p\"},{href:\"#run-blocks\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"run\")),\" block (examples below). By default, each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block executes with \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = apply\"),\" instructing Terraform to execute a complete \",mdx(\"inlineCode\",{parentName:\"p\"},\"apply\"),\" operation against your configuration. Replacing the \",mdx(\"inlineCode\",{parentName:\"p\"},\"command\"),\" value with \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = plan\"),\" instructs Terraform to \",mdx(\"em\",{parentName:\"p\"},\"not\"),\" create new infrastructure for this \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block. This allows test authors to validate logical operations and custom conditions within their infrastructure in a process analogous to unit testing.\"),mdx(\"p\",null,\"Terraform v1.7.0 introduced the ability to mock data returned by the providers during a \",mdx(\"inlineCode\",{parentName:\"p\"},\"terraform test\"),\" execution. This can be used to write more detailed and complete unit tests.\"),mdx(\"h2\",e({},{id:\"syntax\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#syntax\",\"aria-label\":\"syntax permalink\"}),\"\\xBB\"),\"Syntax\"),mdx(\"p\",null,\"Each Terraform test lives in a test file. Terraform discovers test files are based on their file extension: \",mdx(\"inlineCode\",{parentName:\"p\"},\".tftest.hcl\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\".tftest.json\"),\".\"),mdx(\"p\",null,\"Each test file contains the following root level attributes and blocks:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"One to many \",mdx(\"a\",e({parentName:\"li\"},{href:\"#run-blocks\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"run\")),\" blocks.\"),mdx(\"li\",{parentName:\"ul\"},\"Zero to one \",mdx(\"a\",e({parentName:\"li\"},{href:\"#variables\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"variables\")),\" block.\"),mdx(\"li\",{parentName:\"ul\"},\"Zero to many \",mdx(\"a\",e({parentName:\"li\"},{href:\"#providers\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"provider\")),\" blocks.\")),mdx(\"p\",null,\"Terraform executes \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks in order, simulating a series of Terraform commands executing directly within the configuration directory. The order of the \",mdx(\"inlineCode\",{parentName:\"p\"},\"variables\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"provider\"),\" blocks doesn't matter, Terraform processes all the values within these blocks at the beginning of the test operation. We recommend defining your \",mdx(\"inlineCode\",{parentName:\"p\"},\"variables\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"provider\"),\" blocks first, at the beginning of the test file.\"),mdx(\"h3\",e({},{id:\"example\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#example\",\"aria-label\":\"example permalink\"}),\"\\xBB\"),\"Example\"),mdx(\"p\",null,\"The following example demonstrates a simple Terraform configuration that creates an AWS S3 bucket, using an input variable to modify the name. We will create an example test file (below) that validates the buckets name is created as expected.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"eu-central-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket_prefix\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"bucket_prefix\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'-bucket\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"output\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket_name\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"value\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.bucket.bucket\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"The following test file runs a single Terraform \",mdx(\"inlineCode\",{parentName:\"p\"},\"plan\"),\" command which creates the S3 bucket, and then validates the logic for calculating the name is correct by checking the actual name matches the expected name.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# valid_string_concat.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket_prefix\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"valid_string_concat\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-bucket\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"S3 bucket name did not match expected\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h2\",e({},{id:\"run-blocks\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#run-blocks\",\"aria-label\":\"run blocks permalink\"}),\"\\xBB\"),\"Run blocks\"),mdx(\"p\",null,\"Each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block has the following fields and blocks:\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Field or Block Name\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Description\"),mdx(\"th\",e({parentName:\"tr\"},{align:null}),\"Default Value\"))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"command\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional attribute, which is either \",mdx(\"inlineCode\",{parentName:\"td\"},\"apply\"),\" or \",mdx(\"inlineCode\",{parentName:\"td\"},\"plan\"),\".\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"apply\"))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"plan_options.mode\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional attribute, which is either \",mdx(\"inlineCode\",{parentName:\"td\"},\"normal\"),\" or \",mdx(\"inlineCode\",{parentName:\"td\"},\"refresh-only\"),\".\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"normal\"))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"plan_options.refresh\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional boolean attribute.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"true\"))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"plan_options.replace\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional attribute containing a list of resource addresses referencing resources within the configuration under test.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"plan_options.target\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional attribute containing a list of resource addresses referencing resources within the configuration under test.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"a\",e({parentName:\"td\"},{href:\"#variables\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"variables\"))),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional \",mdx(\"inlineCode\",{parentName:\"td\"},\"variables\"),\" block.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"a\",e({parentName:\"td\"},{href:\"#modules\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"module\"))),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional \",mdx(\"inlineCode\",{parentName:\"td\"},\"module\"),\" block.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"a\",e({parentName:\"td\"},{href:\"#providers\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"providers\"))),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional \",mdx(\"inlineCode\",{parentName:\"td\"},\"providers\"),\" attribute.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"a\",e({parentName:\"td\"},{href:\"#assertions\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"assert\"))),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"Optional \",mdx(\"inlineCode\",{parentName:\"td\"},\"assert\"),\" blocks.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",e({parentName:\"tr\"},{align:null}),mdx(\"inlineCode\",{parentName:\"td\"},\"expect_failures\")),mdx(\"td\",e({parentName:\"tr\"},{align:null}),\"An optional attribute.\"),mdx(\"td\",e({parentName:\"tr\"},{align:null}))))),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"command\"),\" attribute and \",mdx(\"inlineCode\",{parentName:\"p\"},\"plan_options\"),\" block tell Terraform which command and options to execute for each run block. The default operation, if you do not specify a \",mdx(\"inlineCode\",{parentName:\"p\"},\"command\"),\" attribute or the \",mdx(\"inlineCode\",{parentName:\"p\"},\"plan_options\"),\" block, is a normal Terraform apply operation.\"),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"command\"),\" attribute states whether the operation should be a \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/cli/commands/plan\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"plan\")),\" or an \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/cli/commands/apply\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"apply\")),\" operation.\"),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"plan_options\"),\" block allows test authors to customize the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/cli/commands/plan#planning-modes\"}),\"planning mode\"),\" and \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/cli/commands/plan#planning-options\"}),\"options\"),\" they would typically need to edit via command-line flags and options. We cover the \",mdx(\"inlineCode\",{parentName:\"p\"},\"-var\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"-var-file\"),\" options in the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#variables\"}),\"Variables\"),\" section.\"),mdx(\"h3\",e({},{id:\"assertions\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#assertions\",\"aria-label\":\"assertions permalink\"}),\"\\xBB\"),\"Assertions\"),mdx(\"p\",null,\"Terraform run block assertions are \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/expressions/custom-conditions\"}),\"Custom Conditions\"),\", consisting of a \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/expressions/custom-conditions#condition-expressions\"}),\"condition\"),\" and an \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/expressions/custom-conditions#error-messages\"}),\"error message\"),\".\"),mdx(\"p\",null,\"At the conclusion of a Terraform test command execution, Terraform presents any failed assertions as part of a tests passed or failed status.\"),mdx(\"h4\",e({},{id:\"assertion-references\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#assertion-references\",\"aria-label\":\"assertion references permalink\"}),\"\\xBB\"),\"Assertion References\"),mdx(\"p\",null,\"Assertions within tests can reference any existing \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/expressions/references\"}),\"named values\"),\" that are available to other custom conditions within the main Terraform configuration.\"),mdx(\"p\",null,\"Additionally, test assertions can directly reference outputs from current and previous \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks. Pulling from the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#example\"}),\"previous example\"),\", this is a valid condition: \",mdx(\"inlineCode\",{parentName:\"p\"},'condition = output.bucket_name == \"test_bucket\"'),\".\"),mdx(\"h2\",e({},{id:\"variables\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#variables\",\"aria-label\":\"variables permalink\"}),\"\\xBB\"),\"Variables\"),mdx(\"p\",null,\"You can provide values for \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/values/variables\"}),\"Input Variables\"),\" within your configuration directly from your test files.\"),mdx(\"p\",null,\"The test file syntax supports \",mdx(\"inlineCode\",{parentName:\"p\"},\"variables\"),\" blocks at both the root level and within \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks. Terraform passes all variable values from the test file into all \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks within the file. You can override variable values for a particular \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block with values provided directly within that \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block.\"),mdx(\"p\",null,\"Adding to the test file from the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#example\"}),\"example\"),\" above:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# variable_precedence.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket_prefix\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"uses_root_level_value\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-bucket\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"S3 bucket name did not match expected\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"overrides_root_level_value\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket_prefix\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"other\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"other-bucket\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"S3 bucket name did not match expected\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"We've added a second \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block that specifies the \",mdx(\"inlineCode\",{parentName:\"p\"},\"bucket_prefix\"),\" variable value as \",mdx(\"inlineCode\",{parentName:\"p\"},\"other\"),\", overriding the value \",mdx(\"inlineCode\",{parentName:\"p\"},\"test\"),\" that is provided by the test file and used during the first \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block.\"),mdx(\"h3\",e({},{id:\"specify-variables-with-the-command-line-or-definition-files\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#specify-variables-with-the-command-line-or-definition-files\",\"aria-label\":\"specify variables with the command line or definition files permalink\"}),\"\\xBB\"),\"Specify variables with the Command Line or definition files\"),mdx(\"p\",null,\"In addition to specifying variable values via test files, the Terraform \",mdx(\"inlineCode\",{parentName:\"p\"},\"test\"),\" command also supports the other typical mechanisms for specifying variable values.\"),mdx(\"p\",null,\"You can specify values for variables across all tests with the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/values/variables#variables-on-the-command-line\"}),\"Command Line\"),\" and with \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/values/variables#variable-definitions-tfvars-files\"}),\"Variable Definition Files\"),\".\"),mdx(\"p\",null,\"As with the main configuration direction, Terraform will automatically load any variables defined in the automatic variable files within a test directory. The automatic variable files are \",mdx(\"inlineCode\",{parentName:\"p\"},\"terraform.tfvars\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"terraform.tfvars.json\"),\", and any files that end with \",mdx(\"inlineCode\",{parentName:\"p\"},\".auto.tfvars\"),\" or \",mdx(\"inlineCode\",{parentName:\"p\"},\".auto.tfvars.json\"),\".\"),mdx(\"div\",e({},{className:\"alert alert-info g-type-body\"}),mdx(\"p\",{parentName:\"div\"},\"\",mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" Variable values loaded from the automatic variable files within a test directory will only apply to tests also defined within the same test directory. Variables defined in all other ways will apply to all tests in a given test run.\")),mdx(\"p\",null,\"This is particularly useful for using sensitive variables values and for configuring providers. Otherwise, testing files could directly expose those sensitive values.\"),mdx(\"h3\",e({},{id:\"variable-definition-precedence\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#variable-definition-precedence\",\"aria-label\":\"variable definition precedence permalink\"}),\"\\xBB\"),\"Variable definition precedence\"),mdx(\"p\",null,mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/values/variables#variable-definition-precedence\"}),\"Variable Definition Precedence\"),\" remains the same within tests, except for variable values that test files provide. The variables defined in test files take the highest precedence, overriding environment variables, variables files, or command-line input.\"),mdx(\"p\",null,\"For tests defined in a test directory, any variable values defined in automatic variable files from the test directory will override values defined in automatic variable files from the main configuration directory.\"),mdx(\"h3\",e({},{id:\"variable-references\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#variable-references\",\"aria-label\":\"variable references permalink\"}),\"\\xBB\"),\"Variable References\"),mdx(\"p\",null,\"Variables you define within \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks can refer to outputs from modules executed in earlier \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks and variables defined at higher precedence levels. Variables defined within the file level \",mdx(\"inlineCode\",{parentName:\"p\"},\"variables\"),\" block can only refer to global variables.\"),mdx(\"p\",null,\"For example, the following code block shows how a variable can refer to higher precedence variables and previous run blocks:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"global_value\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"some value\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"run_block_one\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"local_value\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.global_value\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ...\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Some test assertions should go here.\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"run_block_two\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"local_value\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" run.run_block_one.output_one\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ...\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Some test assertions should go here.\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"Above, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"local_value\"),\" in \",mdx(\"inlineCode\",{parentName:\"p\"},\"run_block_one\"),\" gets its value from the \",mdx(\"inlineCode\",{parentName:\"p\"},\"global_value\"),\" variable. This pattern is useful if you want to assign multiple variables the same value. You can specify a variable value once at the file level and then share it with different variables.\"),mdx(\"p\",null,\"In comparison, \",mdx(\"inlineCode\",{parentName:\"p\"},\"local_value\"),\" in \",mdx(\"inlineCode\",{parentName:\"p\"},\"run_block_two\"),\" takes its value from the output value of \",mdx(\"inlineCode\",{parentName:\"p\"},\"output_one\"),\" from \",mdx(\"inlineCode\",{parentName:\"p\"},\"run_block_one\"),\". This pattern is useful for passing values between \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks, particularly if \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks are executing different modules as detailed in the \",mdx(\"a\",e({parentName:\"p\"},{href:\"#modules\"}),\"Modules\"),\" section.\"),mdx(\"h2\",e({},{id:\"providers\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#providers\",\"aria-label\":\"providers permalink\"}),\"\\xBB\"),\"Providers\"),mdx(\"p\",null,\"You can set or override the required providers within the main configuration from your testing files by using \",mdx(\"inlineCode\",{parentName:\"p\"},\"provider\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"providers\"),\" blocks and attributes.\"),mdx(\"p\",null,\"At the root level of a Terraform testing file, you can define \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/providers/configuration\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"provider\"),\" blocks\"),\" as if Terraform were creating them \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/providers\"}),\"within the main configuration\"),\". Terraform will then pass these provider blocks into its configuration as each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block executes.\"),mdx(\"p\",null,\"By default, each provider you specify is directly available within each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block. You can customize the availability of providers within a given \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block by using a \",mdx(\"inlineCode\",{parentName:\"p\"},\"providers\"),\" attribute. The behavior and syntax for this block match the behavior of \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/meta-arguments/module-providers\"}),\"providers meta-argument\"),\".\"),mdx(\"p\",null,\"If you do not provide provider configuration within a testing file, Terraform attempts to initialize any providers within its configuration using the provider's default settings. For example, any environment variables aimed at configuring providers are still available, and Terraform can use them to create default providers.\"),mdx(\"p\",null,\"Below, we expand on our previous \",mdx(\"a\",e({parentName:\"p\"},{href:\"#example\"}),\"example\"),\" to allow tests, instead of the configuration, to specify the region. In this example, we are going to test the following configuration file:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"terraform\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"required_providers\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"aws\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"hashicorp/aws\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket_prefix\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"bucket_prefix\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'-bucket\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"output\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket_name\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"value\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.bucket.bucket\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"We can now define our \",mdx(\"inlineCode\",{parentName:\"p\"},\"provider\"),\" blocks within the following test file:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# customised_provider.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"eu-central-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket_prefix\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"valid_string_concat\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-bucket\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"S3 bucket name did not match expected\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"We can also create a more complex example configuration, that makes use of multiple providers and aliases:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"terraform\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"required_providers\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"aws\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\"                \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"hashicorp/aws\"'),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"configuration_aliases\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"aws.secondary\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket_prefix\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"default\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"primary_bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"bucket_prefix\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'-primary\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secondary_bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"provider\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws.secondary\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"bucket_prefix\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'-secondary\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"Within our test file we can specify multiple providers:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# customised_providers.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"us-east-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"alias\"),\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secondary\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"eu-central-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"providers\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.primary_bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-primary\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"invalid value for primary S3 bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.secondary_bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-secondary\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"invalid value for secondary S3 bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"It is also possible to define specific providers you want to use in specific \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"terraform\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"required_providers\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"aws\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\"                \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"hashicorp/aws\"'),`\n`,\"      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"configuration_aliases\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),\"aws.secondary\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"data \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_region\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"primary\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"data \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_region\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secondary\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"provider\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws.secondary\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket_prefix\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"default\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"primary_bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"bucket_prefix\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),\"-\",mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"data\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"aws_region\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"primary\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"name\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'-primary\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secondary_bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"provider\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws.secondary\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\"   \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"var\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"bucket_prefix\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),\"-\",mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"$\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"{\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token keyword\"}),\"data\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),\"aws_region\"),mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"secondary\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"name\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\"}\")),'-secondary\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"Our test file can pass in specific providers for each different \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block:\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# customised_providers.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"us-east-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"alias\"),\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"secondary\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"eu-central-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"alias\"),\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"tertiary\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"eu-west-2\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"default_providers\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.primary_bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-us-east-1-primary\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"invalid value for primary S3 bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.secondary_bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-eu-central-1-secondary\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"invalid value for secondary S3 bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"customised_providers\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"providers\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"aws\"),\"           \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws\",`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"aws.secondary\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws.tertiary\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.primary_bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-us-east-1-primary\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"invalid value for primary S3 bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" aws_s3_bucket.secondary_bucket.bucket \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"test-eu-west-2-secondary\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"invalid value for secondary S3 bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" When running tests with \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = apply\"),\", switching providers between \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks can result in failed operations and tests because resources created by one provider definition will be unusable when modified by a second.\")),mdx(\"p\",null,\"From Terraform v1.7.0, \",mdx(\"inlineCode\",{parentName:\"p\"},\"provider\"),\" blocks can also reference test file variables and run block outputs. This means the testing framework can retrieve credentials and other setup information from one provider and use this when initializing a second.\"),mdx(\"p\",null,\"In the following example, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"vault\"),\" provider is initialized first, and then used within a setup module to extract credentials for the \",mdx(\"inlineCode\",{parentName:\"p\"},\"aws\"),\" provider. For more information on setup modules, see \",mdx(\"a\",e({parentName:\"p\"},{href:\"#modules\"}),\"Modules\"),\".\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"vault\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ... vault configuration ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\"     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"us-east-1\"'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# The `aws` provider can reference the outputs of the \"vault_setup\" run block.'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"access_key\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" run.vault_setup.aws_access_key\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"secret_key\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" run.vault_setup.aws_secret_key\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"vault_setup\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This module should only include reference to the Vault provider. Terraform\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# will automatically work out which providers to supply based on the module\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# configuration. The tests will error if a run block requires access to a\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# provider that references outputs from a run block that has not executed.\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"./testing/vault-setup\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"use_aws_provider\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This run block can then use both the `aws` and `vault` providers, as the\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# previous run block provided all the data required for the `aws` provider.\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h2\",e({},{id:\"modules\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#modules\",\"aria-label\":\"modules permalink\"}),\"\\xBB\"),\"Modules\"),mdx(\"p\",null,\"You can modify the module that a given \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block executes.\"),mdx(\"p\",null,\"By default, Terraform executes the given command against the configuration being tested for each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block. Terraform tests the configuration within the directory you execute the \",mdx(\"inlineCode\",{parentName:\"p\"},\"terraform test\"),\" command from (or the directory you point to with the \",mdx(\"inlineCode\",{parentName:\"p\"},\"-chdir\"),\" argument). Each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block also allows the user to change the targeted configuration using the \",mdx(\"inlineCode\",{parentName:\"p\"},\"module\"),\" block.\"),mdx(\"p\",null,\"Unlike the traditional \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/modules/syntax\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"module\"),\" block\"),\", the \",mdx(\"inlineCode\",{parentName:\"p\"},\"module\"),\" block within test files \",mdx(\"em\",{parentName:\"p\"},\"only\"),\" supports the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/modules/syntax#source\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"source\")),\" attribute and the \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/modules/syntax#version\"}),mdx(\"inlineCode\",{parentName:\"a\"},\"version\")),\" attribute. The remaining attributes that are typically supplied via the traditional \",mdx(\"inlineCode\",{parentName:\"p\"},\"module\"),\" block should be supplied by the alternate attributes and blocks within the \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},\"Note:\"),\" Terraform test files only support \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/modules/sources#local-paths\"}),\"local\"),\" and \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/modules/sources#terraform-registry\"}),\"registry\"),\" modules within the \",mdx(\"inlineCode\",{parentName:\"p\"},\"source\"),\" attribute.\")),mdx(\"p\",null,\"All other blocks and attributes within the \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block are supported when executing an alternate module, with \",mdx(\"inlineCode\",{parentName:\"p\"},\"assert\"),\" blocks executing against values from the alternate module. This is discussed more in \",mdx(\"a\",e({parentName:\"p\"},{href:\"#modules-state\"}),\"Modules State\"),\".\"),mdx(\"p\",null,\"Two example use cases for the \",mdx(\"inlineCode\",{parentName:\"p\"},\"modules\"),\" block within a testing file are:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"A setup module that creates the infrastructure the main configuration requires for testing.\"),mdx(\"li\",{parentName:\"ol\"},\"A loading module to load and validate secondary infrastructure (such as data sources) that are not created directly by the main configuration being tested.\")),mdx(\"p\",null,\"The following examples demonstrate both of these use cases.\"),mdx(\"p\",null,\"First, we have a module that will create and load several files into an already created S3 bucket. This is the configuration we want to test.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"files\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" map(string)\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"data \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.bucket\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_object\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"object\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"for_each\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.files\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" data.aws_s3_bucket.bucket.id\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"key\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" each.key\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" each.value\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"etag\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" filemd5(each.value)\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"Second, we have a setup module that will create the S3 bucket, so it is available to the configuration under test.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# testing/setup/main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"resource \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_bucket\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"bucket\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.bucket\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"Third, we have a loading module, that will load the files in the s3 bucket. This is a fairly contrived example, as it is definitely possible just to validate the files directly when they are created in the module under test. It is, however, good for demonstrating the use case.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# testing/loader/main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"bucket\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" string\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"data \",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),'\"aws_s3_objects\"')),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"objects\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.bucket\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"Finally, we have the test file itself which configures everything and calls out to the various helper modules we have created.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# file_count.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"bucket\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"my_test_bucket\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"files\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"file-one.txt\"'),\": \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"data/files/file_one.txt\"'),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),'\"file-two.txt\"'),\": \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"data/files/file_two.txt\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"provider\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"aws\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"region\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"us-east-1\"'),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"setup\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# Create the S3 bucket we will use later.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"./testing/setup\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"execute\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This is empty, we just run the configuration under test using all the default settings.\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"verify\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# Load and count the objects created in the \"execute\" run block.'),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"./testing/loader\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" length(data.aws_s3_objects.objects.keys) \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"created the wrong number of s3 objects\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"h3\",e({},{id:\"modules-state\"}),mdx(\"a\",e({parentName:\"h3\"},{className:\"__permalink-h\",href:\"#modules-state\",\"aria-label\":\"modules state permalink\"}),\"\\xBB\"),\"Modules state\"),mdx(\"p\",null,\"While Terraform executes a \",mdx(\"inlineCode\",{parentName:\"p\"},\"terraform test\"),\" command, Terraform maintains at least one, but possibly many, state files within memory for each test file.\"),mdx(\"p\",null,\"There is always at least one state file that maintains the state of the main configuration under test. This state file is shared by all \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks that do not have a \",mdx(\"inlineCode\",{parentName:\"p\"},\"module\"),\" block specifying an alternate module to load.\"),mdx(\"p\",null,\"Additionally, there is one state file per alternate module that Terraform loads. An alternate module state file is shared by all \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks that execute the given module.\"),mdx(\"p\",null,\"The Terraform team is interested in any use cases requiring manual state management or the ability to execute different configurations against the same state within the \",mdx(\"inlineCode\",{parentName:\"p\"},\"test\"),\" command. If you have a use case, please file an \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/hashicorp/terraform/issues/new/choose\"}),\"issue\"),\" and share it with us.\"),mdx(\"p\",null,\"The following example uses comments to explain where the state files for each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block originate. In the below example Terraform creates and manages a total of three state files. The first state file is for the main configuration under test, the second for the setup module, and the third for the loader module.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"setup\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This run block references an alternate module and is the first run block\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# to reference this particular alternate module. Therefore, Terraform creates\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# and populates a new empty state file for this run block.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"./testing/setup\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"init\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This run block does not reference an alternate module, so it uses the main\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# state file for the configuration under test. As this is the first run block\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# to reference the main configuration, the previously empty state file now\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# contains the resources created by this run block.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"assert\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# In practice we'd do some interesting checks and tests here but the\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# assertions aren't important for this example.\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ... more assertions ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"update_setup\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# We've now re-referenced the setup module, so the state file that was created\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# for the first \"setup\" run block will be reused. It will contain any'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# resources that were created as part of the other run block before this run\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# block executes and will be updated with any changes made by this run block\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# after.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"./testing/setup\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# In practice, we'd likely make some changes to the module compared to the\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# first run block here. Otherwise, there would be no point recalling the\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# module.\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"update\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# As with the \"init\" run block, we are executing against the main configuration'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# again. This means we'd load the main state file that was initially populated\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),'# by the \"init\" run block, and any changes made by this \"run\" block will be'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# carried forward to any future run blocks that execute against the main\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# configuration.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ... updated variables ...\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# ... assertions ...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"loader\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This run block is now referencing our second alternate module so will create\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# our third and final state file. The other two state files are managing\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# resources from the main configuration and resources from the setup module.\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# We are getting a new state file for this run block as the loader module has\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# not previously been referenced by any run blocks.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"module\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"source\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"./testing/loader\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`)),mdx(\"h4\",e({},{id:\"modules-cleanup\"}),mdx(\"a\",e({parentName:\"h4\"},{className:\"__permalink-h\",href:\"#modules-cleanup\",\"aria-label\":\"modules cleanup permalink\"}),\"\\xBB\"),\"Modules Cleanup\"),mdx(\"p\",null,\"At the conclusion of a test file, Terraform attempts to destroy every resource it created during the execution of that test file. When Terraform loads alternate modules, the order in which Terraform destroys those objects in is important. For example, in the first \",mdx(\"a\",e({parentName:\"p\"},{href:\"#modules\"}),\"Modules\"),' example, Terraform could not destroy the resources created in the \"setup\" ',mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),' block before the objects created in the \"execute\" ',mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),' block, because the S3 bucket we created in the \"setup\" step can not be destroyed while it contains objects.'),mdx(\"p\",null,\"Terraform destroys resources in reverse \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block order. In the most recent \",mdx(\"a\",e({parentName:\"p\"},{href:\"#modules-state\"}),\"example\"),\", there are three state files. One for the main state, one for the \",mdx(\"inlineCode\",{parentName:\"p\"},\"./testing/loader\"),\" module, and one for the \",mdx(\"inlineCode\",{parentName:\"p\"},\"./testing/setup\"),\" module. The \",mdx(\"inlineCode\",{parentName:\"p\"},\"./testing/loader\"),' state file would be destroyed first as it was referenced most recently by the last run block. The main state file would be destroyed second as it was referenced by the \"update\" ',mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block. The \",mdx(\"inlineCode\",{parentName:\"p\"},\"./testing/setup\"),\" state file would then be destroyed last.\"),mdx(\"p\",null,\"Note, that the first two \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),' blocks \"setup\" and \"init\", do nothing during the destroy operations as their state files are used by later run blocks and have already been destroyed.'),mdx(\"p\",null,\"If you use a single setup module as an alternate module, and it executes first, or you use no alternate modules, then the order of destruction does not affect you. Anything more complex may require careful consideration to make sure the destruction of resources can complete automatically.\"),mdx(\"h2\",e({},{id:\"expecting-failures\"}),mdx(\"a\",e({parentName:\"h2\"},{className:\"__permalink-h\",href:\"#expecting-failures\",\"aria-label\":\"expecting failures permalink\"}),\"\\xBB\"),\"Expecting failures\"),mdx(\"p\",null,\"By default, if any \",mdx(\"a\",e({parentName:\"p\"},{href:\"/terraform/language/expressions/custom-conditions\"}),\"Custom Conditions\"),\", including \",mdx(\"inlineCode\",{parentName:\"p\"},\"check\"),\" block assertions, fail during the execution of a Terraform test file then the overall command reports the test as a failure.\"),mdx(\"p\",null,\"However, it is a common testing paradigm to want to test failure cases. Terraform supports the \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" attribute for this use case.\"),mdx(\"p\",null,\"In each \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block the \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" attribute can provide a list of checkable objects (resources, data sources, check blocks, input variables, and outputs) that should fail their custom conditions. The test passes if the checkable objects you specify report an issue, and the test fails overall if they do not.\"),mdx(\"p\",null,\"You can still write assertions alongside an \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" block, but you should be mindful that all custom conditions, except check block assertions, halt the execution of Terraform. This still applies during test execution, so your assertions should only consider values that you are sure will be computed before the checkable object is due to fail. You can manage this using references, or the \",mdx(\"inlineCode\",{parentName:\"p\"},\"depends_on\"),\" meta-argument within your main configuration.\"),mdx(\"p\",null,\"This also means that, with the exception of \",mdx(\"inlineCode\",{parentName:\"p\"},\"check\"),\" blocks, you can only reliably include a single checkable object. We support a list of checkable objects within the \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" attribute purely for \",mdx(\"inlineCode\",{parentName:\"p\"},\"check\"),\" blocks.\"),mdx(\"p\",null,\"A quick example below demonstrates testing the \",mdx(\"inlineCode\",{parentName:\"p\"},\"validation\"),\" block on an input variable. The configuration file accepts a single input variable that must be even number.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# main.tf\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variable\",mdx(\"span\",e({parentName:\"span\"},{className:\"token type variable\"}),' \"input\" ')),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"type\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" number\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"validation\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"condition\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" var.input % \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"2\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"0\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"error_message\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"must be even number\"'),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"p\",null,\"The test file contains two run blocks. One that validates that our custom condition passes on an even number and one that validates our custom condition fails on an odd number.\"),mdx(\"pre\",e({},{className:\"language-hcl\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-hcl\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# input_validation.tftest.hcl\"),`\n`,`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"input\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"0\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"zero\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# The variable defined above is even, so we expect the validation to pass.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"run \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"one\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"# This time we set the variable is odd, so we expect the validation to fail.\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"command\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" plan\",`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"variables\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),`\n`,\"    \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"input\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"1\"),`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`,`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token property\"}),\"expect_failures\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n`,\"    var.input,\",`\n`,\"  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n`)),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},\"Note\"),\": Terraform only expects failures in the operation specified by the \",mdx(\"inlineCode\",{parentName:\"p\"},\"command\"),\" attribute of the \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block.\")),mdx(\"p\",null,\"Be careful when using \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" in \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" blocks with \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = apply\"),\". A \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block with \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = apply\"),\" that expects a custom condition failure will fail overall if that custom condition fails during the plan.\"),mdx(\"p\",null,\"This is logically consistent, as the \",mdx(\"inlineCode\",{parentName:\"p\"},\"run\"),\" block is expecting to be able to run an apply operation but can not because the plan failed. It is also potentially confusing, as you will see the failure in the diagnostics as the reason the test failed, even though that failure was marked as being expected.\"),mdx(\"p\",null,\"There are instances when Terraform does not execute a custom condition during the planning stage, because that condition is relying on computed attributes that are only available after Terraform creates the referenced resource. In these cases, you could use an \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" block alongside a \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = apply\"),\" attribute and value. However, in most cases we recommend only using \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" alongside \",mdx(\"inlineCode\",{parentName:\"p\"},\"command = plan\"),\" operations.\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},mdx(\"strong\",{parentName:\"p\"},\"Note\"),\": Expected failures only apply to user-defined custom conditions.\")),mdx(\"p\",null,\"Other kinds of failure \",mdx(\"em\",{parentName:\"p\"},\"besides\"),\" the specified expected failures in the checkable object still result in the overall test failing. For example, a variable that expects a boolean value as input fails the surrounding test if Terraform provides the wrong kind of value, even if that variable is included in an \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" attribute.\"),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" attribute is included to allow authors to test their configuration and any logic defined within. A type mismatch, as in the previous example, is not something Terraform authors should have to worry about testing as Terraform itself will handle enforce type constraints. As such, you can only \",mdx(\"inlineCode\",{parentName:\"p\"},\"expect_failures\"),\" in custom conditions.\"))}MDXContent.isMDXComponent=!0;\n","scope":{"version":"latest"}},"product":{"slug":"terraform","name":"Terraform","algoliaConfig":{"indexName":"product_TERRAFORM"},"basePaths":["cdktf","cli","cloud-docs","cloud-docs/agents","docs","enterprise","internals","intro","language","plugin","plugin/framework","plugin/log","plugin/mux","plugin/sdkv2","plugin/testing","registry","downloads"],"docsNavItems":["docs","language","cli","cloud-docs","enterprise","cdktf",{"icon":"provider","label":"Provider Use","fullPath":"/terraform/language/providers"},"plugin","registry",{"icon":"handshake","label":"Integration Program","fullPath":"/terraform/docs/partnerships"}],"rootDocsPaths":[{"iconName":"code","name":"CDK for Terraform","path":"cdktf","productSlugForLoader":"terraform-cdk"},{"iconName":"terminal-screen","name":"Terraform CLI","path":"cli"},{"iconName":"cloud","name":"Terraform Cloud","path":"cloud-docs","productSlugForLoader":"terraform-docs-common"},{"iconName":"cloud","name":"Cloud Docs Agents","navDataPrefix":"cloud-docs-agents","path":"cloud-docs/agents","productSlugForLoader":"terraform-docs-agents"},{"iconName":"docs","name":"About the Docs","path":"docs","productSlugForLoader":"terraform-docs-common"},{"iconName":"org","name":"Terraform Enterprise","path":"enterprise","productSlugForLoader":"ptfe-releases"},{"iconName":"docs","name":"Internals","path":"internals"},{"iconName":"docs","name":"Intro","path":"intro"},{"iconName":"file-source","name":"Configuration Language","path":"language"},{"iconName":"wrench","name":"Plugin Development","path":"plugin","productSlugForLoader":"terraform-docs-common"},{"iconName":"plug","name":"Framework","navDataPrefix":"plugin-framework","path":"plugin/framework","productSlugForLoader":"terraform-plugin-framework"},{"iconName":"plug","name":"Logging","navDataPrefix":"plugin-log","path":"plugin/log","productSlugForLoader":"terraform-plugin-log"},{"iconName":"plug","name":"Combining and Translating","navDataPrefix":"plugin-mux","path":"plugin/mux","productSlugForLoader":"terraform-plugin-mux"},{"iconName":"plug","name":"SDKv2","path":"plugin/sdkv2","productSlugForLoader":"terraform-plugin-sdk","navDataPrefix":"plugin-sdkv2"},{"iconName":"plug","name":"Testing","path":"plugin/testing","productSlugForLoader":"terraform-plugin-testing","navDataPrefix":"plugin-testing"},{"iconName":"plus-circle","name":"Registry Publishing","path":"registry","productSlugForLoader":"terraform-docs-common"}],"currentRootDocsPath":{"iconName":"file-source","name":"Configuration Language","path":"language"}},"projectName":null,"versions":null},"__N_SSG":true},"page":"/terraform/language/[[...page]]","query":{"page":["tests"]},"buildId":"EKhU1E0BkpF0JXZAOB7ND","assetPrefix":"/hashicorp-terraform","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script nomodule="">window.MSInputMethodContext && document.documentMode && document.write('<script src="/ie-warning.js"><\x2fscript>');</script></body></html>