{"pageProps":{"layoutProps":{"breadcrumbLinks":[{"title":"Developer","url":"/"},{"title":"Terraform","url":"/terraform"},{"title":"Internals","url":"/terraform/internals","isCurrentPage":false},{"title":"Remote Service Discovery","url":"/terraform/internals/remote-service-discovery","isCurrentPage":true}],"sidebarNavDataLevels":[{"levelButtonProps":{"levelDownButtonText":"Terraform Home"},"menuItems":[{"leadingIconName":"home","title":"HashiCorp Developer","href":"/"},{"leadingIconName":"guide","title":"Tutorials","href":"/tutorials"},{"divider":true},{"heading":"Products"},{"leadingIconName":"hcp","title":"HashiCorp Cloud Platform","href":"/hcp"},{"leadingIconName":"terraform","title":"Terraform","href":"/terraform"},{"leadingIconName":"packer","title":"Packer","href":"/packer"},{"leadingIconName":"consul","title":"Consul","href":"/consul"},{"leadingIconName":"vault","title":"Vault","href":"/vault"},{"leadingIconName":"boundary","title":"Boundary","href":"/boundary"},{"leadingIconName":"nomad","title":"Nomad","href":"/nomad"},{"leadingIconName":"waypoint","title":"Waypoint","href":"/waypoint"},{"leadingIconName":"vagrant","title":"Vagrant","href":"/vagrant"}],"showFilterInput":false,"title":"Main Menu"},{"levelButtonProps":{"levelUpButtonText":"Main Menu","levelDownButtonText":"Previous"},"menuItems":[{"title":"Terraform","fullPath":"/terraform","theme":"terraform"},{"title":"Install","fullPath":"/terraform/install"},{"title":"Intro to Terraform","fullPath":"/terraform/intro"},{"title":"Tutorials","fullPath":"/terraform/tutorials"},{"title":"Documentation","isOpen":true,"routes":[{"title":"Documentation","fullPath":"/terraform/docs"},{"title":"Configuration Language","fullPath":"/terraform/language"},{"title":"Terraform CLI","fullPath":"/terraform/cli"},{"title":"HCP Terraform","fullPath":"/terraform/cloud-docs"},{"title":"Terraform Enterprise","fullPath":"/terraform/enterprise"},{"title":"CDK for Terraform","fullPath":"/terraform/cdktf"},{"title":"Provider Use","fullPath":"/terraform/language/providers"},{"title":"Plugin Development","fullPath":"/terraform/plugin"},{"title":"Registry Publishing","fullPath":"/terraform/registry"},{"title":"Integration Program","fullPath":"/terraform/docs/partnerships"}]}],"showFilterInput":false,"title":"Terraform","visuallyHideTitle":true},{"backToLinkProps":{"text":"Terraform Home","href":"/terraform"},"levelButtonProps":{"levelUpButtonText":"Terraform Home"},"menuItems":[{"title":"Internals","fullPath":"/terraform/internals","theme":"terraform"},{"title":"Credentials Helpers","path":"credentials-helpers","filePath":"../docs/internals/credentials-helpers.mdx","fullPath":"/terraform/internals/credentials-helpers","id":"sidebar-nav-item-2"},{"title":"Debugging Terraform","path":"debugging","filePath":"../docs/internals/debugging.mdx","fullPath":"/terraform/internals/debugging","id":"sidebar-nav-item-3"},{"title":"Module Registry Protocol","path":"module-registry-protocol","filePath":"../docs/internals/module-registry-protocol.mdx","fullPath":"/terraform/internals/module-registry-protocol","id":"sidebar-nav-item-4"},{"title":"Provider Network Mirror Protocol","path":"provider-network-mirror-protocol","filePath":"../docs/internals/provider-network-mirror-protocol.mdx","fullPath":"/terraform/internals/provider-network-mirror-protocol","id":"sidebar-nav-item-5"},{"title":"Provider Registry Protocol","path":"provider-registry-protocol","filePath":"../docs/internals/provider-registry-protocol.mdx","fullPath":"/terraform/internals/provider-registry-protocol","id":"sidebar-nav-item-6"},{"title":"Dependency Graph","path":"graph","filePath":"../docs/internals/graph.mdx","fullPath":"/terraform/internals/graph","id":"sidebar-nav-item-7"},{"title":"Login Protocol","path":"login-protocol","filePath":"../docs/internals/login-protocol.mdx","fullPath":"/terraform/internals/login-protocol","id":"sidebar-nav-item-8"},{"title":"JSON Output Format","path":"json-format","filePath":"../docs/internals/json-format.mdx","fullPath":"/terraform/internals/json-format","id":"sidebar-nav-item-9"},{"title":"Remote Service Discovery","path":"remote-service-discovery","filePath":"../docs/internals/remote-service-discovery.mdx","fullPath":"/terraform/internals/remote-service-discovery","id":"sidebar-nav-item-10"},{"title":"Provider Metadata","path":"provider-meta","filePath":"../docs/internals/provider-meta.mdx","fullPath":"/terraform/internals/provider-meta","id":"sidebar-nav-item-11"},{"title":"Functions Metadata","path":"functions-meta","filePath":"../docs/internals/functions-meta.mdx","fullPath":"/terraform/internals/functions-meta","id":"sidebar-nav-item-12"},{"title":"Machine Readable UI","path":"machine-readable-ui","filePath":"../docs/internals/machine-readable-ui.mdx","fullPath":"/terraform/internals/machine-readable-ui","id":"sidebar-nav-item-13"},{"divider":true,"id":"sidebar-nav-item-14"},{"title":"Terraform CLI","href":null,"fullPath":"/terraform/cli","id":"sidebar-nav-item-15","path":"/cli"},{"divider":true,"id":"sidebar-nav-item-16"},{"title":"Configuration Language","href":null,"fullPath":"/terraform/language","id":"sidebar-nav-item-17","path":"/language"}],"title":"Internals","visuallyHideTitle":true}],"mainWidth":"narrow","githubFileUrl":"https://github.com/hashicorp/terraform/blob/main/website/../docs/internals/remote-service-discovery.mdx"},"metadata":{"title":"Remote service discovery protocol reference","description":"The remote service discovery protocol presents Terraform-native services at a human-readable hostname. Learn about the remote service discovery protocol.","layout":null},"outlineItems":[{"title":"Remote Service Discovery Protocol Reference","url":"#remote-service-discovery-protocol-reference"},{"title":"Introduction","url":"#introduction"},{"title":"User-facing Hostname","url":"#user-facing-hostname"},{"title":"Discovery Process","url":"#discovery-process"},{"title":"Supported Services","url":"#supported-services"},{"title":"Authentication","url":"#authentication"},{"title":"Non-standard Ports in User-facing Hostnames","url":"#non-standard-ports-in-user-facing-hostnames"}],"pageHeading":{"id":"remote-service-discovery-protocol-reference","title":"Remote Service Discovery Protocol Reference"},"mdxSource":{"compiledSource":"const layoutProps={};const MDXLayout=\"wrapper\";function MDXContent({components,...props}){return mdx(MDXLayout,{...layoutProps,...props,components:components,mdxType:\"MDXLayout\"},mdx(\"p\",null,`⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️`),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},`[!IMPORTANT]`,mdx(\"br\",{parentName:\"p\"}),`\n`,mdx(\"strong\",{parentName:\"p\"},`Documentation Update:`),` Product documentation previously located in `,mdx(\"inlineCode\",{parentName:\"p\"},`/website`),` has moved to the `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://github.com/hashicorp/web-unified-docs\"},mdx(\"inlineCode\",{parentName:\"a\"},`hashicorp/web-unified-docs`)),` repository, where all product documentation is now centralized. Please make contributions directly to `,mdx(\"inlineCode\",{parentName:\"p\"},`web-unified-docs`),`, since changes to `,mdx(\"inlineCode\",{parentName:\"p\"},`/website`),` in this repository will not appear on developer.hashicorp.com.\n⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️⚠️`)),mdx(\"p\",null,`This topic provides reference information about the remote service discovery protocol in Terraform.`),mdx(\"h2\",{\"id\":\"introduction\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#introduction\",\"aria-label\":\"introduction permalink\"},`\\xbb`),`Introduction`),mdx(\"p\",null,`Terraform implements much of its functionality as remote services.\nSome of these are native services that Terraform\ninteracts with through the remote service discovery protocol.`),mdx(\"h2\",{\"id\":\"user-facing-hostname\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#user-facing-hostname\",\"aria-label\":\"user facing hostname permalink\"},`\\xbb`),`User-facing Hostname`),mdx(\"p\",null,`Terraform provides native services at a\nhuman-readable hostname. The hostname is the key for configuration and\nfor any authentication credentials required.`),mdx(\"p\",null,`The discovery protocol's purpose is to map from a user-provided hostname to\nthe base URL of a particular service. Each host can provide different\ncombinations of services -- or no services at all! -- and so the discovery\nprotocol has a secondary purpose of allowing Terraform to identify `,mdx(\"em\",{parentName:\"p\"},`which`),`\nservices are valid for a given hostname.`),mdx(\"p\",null,`For example, module source strings can include a module registry hostname\nas their first segment, like `,mdx(\"inlineCode\",{parentName:\"p\"},`example.com/namespace/name/provider`),`, and\nTerraform uses service discovery to determine whether `,mdx(\"inlineCode\",{parentName:\"p\"},`example.com`),` `,mdx(\"em\",{parentName:\"p\"},`has`),`\na module registry, and if so where its API is available.`),mdx(\"p\",null,`A user-facing hostname is a fully-specified\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Internationalized_domain_name\"},`internationalized domain name`),`\nexpressed in its Unicode form (the corresponding \"punycode\" form is not allowed)\nwhich must be resolvable in DNS to an address that has an HTTPS server running\non port 443.`),mdx(\"p\",null,`User-facing hostnames are normalized for internal comparison using the\nstandard Unicode `,mdx(\"a\",{parentName:\"p\",\"href\":\"https://en.wikipedia.org/wiki/Nameprep\"},`Nameprep`),` algorithm,\nwhich includes converting all letters to lowercase, normalizing combining\ndiacritics to precomposed form where possible, and various other normalization\nsteps.`),mdx(\"h2\",{\"id\":\"discovery-process\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#discovery-process\",\"aria-label\":\"discovery process permalink\"},`\\xbb`),`Discovery Process`),mdx(\"p\",null,`Given a hostname, discovery begins by forming an initial discovery URL\nusing that hostname with the `,mdx(\"inlineCode\",{parentName:\"p\"},`https:`),` scheme and the fixed path\n`,mdx(\"inlineCode\",{parentName:\"p\"},`/.well-known/terraform.json`),`.`),mdx(\"p\",null,`For example, given the hostname `,mdx(\"inlineCode\",{parentName:\"p\"},`example.com`),` the initial discovery URL\nwould be `,mdx(\"inlineCode\",{parentName:\"p\"},`https://example.com/.well-known/terraform.json`),`.`),mdx(\"p\",null,`Terraform then sends a `,mdx(\"inlineCode\",{parentName:\"p\"},`GET`),` request to this discovery URL and expects a\nJSON response. If the response does not have status 200, does not have a media\ntype of `,mdx(\"inlineCode\",{parentName:\"p\"},`application/json`),` or, if the body cannot be parsed as a JSON object,\nthen discovery fails and Terraform considers the host to not support `,mdx(\"em\",{parentName:\"p\"},`any`),`\nTerraform-native services.`),mdx(\"p\",null,`If the response is an HTTP redirect then Terraform repeats this step with the\nnew location as its discovery URL. Terraform is guaranteed to follow at least\none redirect, but nested redirects are not guaranteed nor recommended.`),mdx(\"p\",null,`If the response is a valid JSON object then its keys are Terraform native\nservice identifiers, consisting of a service type name and a version string\nseparated by a period. For example, the service identifier for version 1 of\nthe module registry protocol is `,mdx(\"inlineCode\",{parentName:\"p\"},`modules.v1`),`.`),mdx(\"p\",null,`The value of each object element is the base URL for the service in question.\nThis URL may be either absolute or relative, and if relative it is resolved\nagainst the final discovery URL (`,mdx(\"em\",{parentName:\"p\"},`after`),` following redirects).`),mdx(\"p\",null,`The following is an example discovery document declaring support for\nversion 1 of the module registry protocol:`),mdx(\"pre\",{\"style\":{\"backgroundColor\":\"var(--hds-code-block-color-surface-primary)\",\"color\":\"var(--hds-code-block-color-token)\"},\"tabindex\":\"0\",\"language\":\"json\",\"className\":\"language-json\"},mdx(\"code\",{parentName:\"pre\",\"className\":\"language-json\"},mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`{`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-keyword)\"}},`  \"modules.v1\"`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-punctuation)\"}},`:`),mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-string)\"}},` \"https://modules.example.com/v1/\"`)),`\n`,mdx(\"span\",{parentName:\"code\",\"className\":\"line\"},mdx(\"span\",{parentName:\"span\",\"style\":{\"color\":\"var(--hds-code-block-color-token)\"}},`}`)),`\n`)),mdx(\"h2\",{\"id\":\"supported-services\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#supported-services\",\"aria-label\":\"supported services permalink\"},`\\xbb`),`Supported Services`),mdx(\"p\",null,`At present, the following service identifiers are in use:`),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"login-v1\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#login-v1\",\"aria-label\":\"login v1 permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`login.v1`)),`: `,mdx(\"a\",{parentName:\"li\",\"href\":\"/terraform/cli/commands/login\"},`login protocol version 1`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"modules-v1\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#modules-v1\",\"aria-label\":\"modules v1 permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`modules.v1`)),`: `,mdx(\"a\",{parentName:\"li\",\"href\":\"/terraform/internals/module-registry-protocol\"},`module registry API version 1`)),mdx(\"li\",{parentName:\"ul\"},mdx(\"a\",{parentName:\"li\",\"id\":\"providers-v1\",\"className\":\"__target-lic\",\"aria-hidden\":\"true\"}),mdx(\"a\",{parentName:\"li\",\"href\":\"#providers-v1\",\"aria-label\":\"providers v1 permalink\",\"className\":\"__permalink-lic\"},mdx(\"inlineCode\",{parentName:\"a\"},`providers.v1`)),`: `,mdx(\"a\",{parentName:\"li\",\"href\":\"/terraform/internals/provider-registry-protocol\"},`provider registry API version 1`))),mdx(\"h2\",{\"id\":\"authentication\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#authentication\",\"aria-label\":\"authentication permalink\"},`\\xbb`),`Authentication`),mdx(\"p\",null,`If credentials for the given hostname are available in\n`,mdx(\"a\",{parentName:\"p\",\"href\":\"/terraform/cli/config/config-file#Credentials\"},`the CLI config`),` through a `,mdx(\"inlineCode\",{parentName:\"p\"},`credentials_helper`),` or a host-specific environment variable, then they will be included in the request for the discovery document.`),mdx(\"p\",null,`The credentials may also be provided to endpoints declared in the discovery\ndocument, depending on the requirements of the service in question.`),mdx(\"h2\",{\"id\":\"non-standard-ports-in-user-facing-hostnames\"},mdx(\"a\",{parentName:\"h2\",\"className\":\"__permalink-h\",\"href\":\"#non-standard-ports-in-user-facing-hostnames\",\"aria-label\":\"non standard ports in user facing hostnames permalink\"},`\\xbb`),`Non-standard Ports in User-facing Hostnames`),mdx(\"p\",null,`It is strongly recommended to provide the discovery document for a hostname\non the standard HTTPS port 443. However, in development environments this is\nnot always possible or convenient, so Terraform allows a hostname to end\nwith a port specification consisting of a colon followed by one or more\ndecimal digits.`),mdx(\"p\",null,`When a custom port number is present, the service on that port is expected to\nimplement HTTPS and respond to the same fixed discovery path.`),mdx(\"p\",null,`For day-to-day use it is strongly recommended `,mdx(\"em\",{parentName:\"p\"},`not`),` to rely on this mechanism\nand to instead provide the discovery document on the standard port, since this\nallows use of the most user-friendly hostname form.`))};MDXContent.isMDXComponent=true;","scope":{"product":"terraform","version":"latest"}},"product":{"slug":"terraform","name":"Terraform","algoliaConfig":{"indexName":"product_TERRAFORM"},"alertBannerActive":true,"alertBanner":{"tag":"New","url":"https://www.hashicorp.com/blog/introducing-the-infrastructure-cloud","text":"Terraform Cloud is now HCP Terraform","linkText":"Read more →","expirationDate":"2024-04-29T00:00:00-08:00"},"basePaths":["cdktf","cli","cloud-docs","cloud-docs/agents","docs","enterprise","internals","intro","language","plugin","plugin/framework","plugin/log","plugin/mux","plugin/sdkv2","plugin/testing","registry","downloads"],"docsNavItems":["docs","intro","language","cli","cloud-docs","enterprise","cdktf",{"icon":"provider","label":"Provider Use","fullPath":"/terraform/language/providers"},"plugin","registry",{"icon":"handshake","label":"Integration Program","fullPath":"/terraform/docs/partnerships"}],"rootDocsPaths":[{"iconName":"code","name":"CDK for Terraform","path":"cdktf","productSlugForLoader":"terraform-cdk"},{"iconName":"terminal-screen","name":"Terraform CLI","path":"cli"},{"iconName":"cloud","name":"HCP Terraform","path":"cloud-docs","productSlugForLoader":"terraform-docs-common"},{"iconName":"cloud","name":"HCP Terraform Agents","navDataPrefix":"cloud-docs-agents","path":"cloud-docs/agents","productSlugForLoader":"terraform-docs-agents"},{"iconName":"docs","name":"Documentation","path":"docs","productSlugForLoader":"terraform-docs-common"},{"iconName":"org","name":"Terraform Enterprise","path":"enterprise","productSlugForLoader":"terraform-enterprise"},{"iconName":"docs","name":"Internals","path":"internals"},{"iconName":"docs","name":"Intro to Terraform","path":"intro"},{"iconName":"file-source","name":"Configuration Language","path":"language"},{"iconName":"wrench","name":"Plugin Development","path":"plugin","productSlugForLoader":"terraform-docs-common"},{"iconName":"plug","name":"Framework","navDataPrefix":"plugin-framework","path":"plugin/framework","productSlugForLoader":"terraform-plugin-framework"},{"iconName":"plug","name":"Logging","navDataPrefix":"plugin-log","path":"plugin/log","productSlugForLoader":"terraform-plugin-log"},{"iconName":"plug","name":"Combining and Translating","navDataPrefix":"plugin-mux","path":"plugin/mux","productSlugForLoader":"terraform-plugin-mux"},{"iconName":"plug","name":"SDKv2","path":"plugin/sdkv2","productSlugForLoader":"terraform-plugin-sdk","navDataPrefix":"plugin-sdkv2"},{"iconName":"plug","name":"Testing","path":"plugin/testing","productSlugForLoader":"terraform-plugin-testing","navDataPrefix":"plugin-testing"},{"iconName":"plus-circle","name":"Registry Publishing","path":"registry","productSlugForLoader":"terraform-docs-common"}],"currentRootDocsPath":{"iconName":"docs","name":"Internals","path":"internals"}},"projectName":null,"versions":null},"__N_SSG":true}